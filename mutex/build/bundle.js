var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(r)}function a(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function c(e,t,n){e.$$.on_destroy.push(u(t,n))}function l(e,t,n,r){if(e){const i=h(e,t,n,r);return e[0](i)}}function h(e,t,r,i){return e[1]&&i?n(r.ctx.slice(),e[1](i(t))):r.ctx}function f(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if("object"==typeof t.dirty){const e=[],n=Math.max(t.dirty.length,i.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|i[r];return e}return t.dirty|i}return t.dirty}const p="undefined"!=typeof window;let d=p?()=>window.performance.now():()=>Date.now(),m=p?e=>requestAnimationFrame(e):e;const g=new Set;function y(e){g.forEach(t=>{t.c(e)||(g.delete(t),t.f())}),0!==g.size&&m(y)}function v(e){let t;return 0===g.size&&m(y),{promise:new Promise(n=>{g.add(t={c:e,f:n})}),abort(){g.delete(t)}}}function b(e,t){e.appendChild(t)}function w(e,t,n){e.insertBefore(t,n||null)}function T(e){e.parentNode.removeChild(e)}function E(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function S(e){return document.createElement(e)}function I(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function C(e){return document.createTextNode(e)}function A(){return C(" ")}function D(){return C("")}function N(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function k(e){return function(t){return t.preventDefault(),e.call(this,t)}}function _(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function x(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function R(e,t){t=""+t,e.data!==t&&(e.data=t)}function M(e,t){(null!=t||e.value)&&(e.value=t)}function O(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function P(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function L(e,t,n){e.classList[n?"add":"remove"](t)}function F(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}let B,q,V=0,$={};function U(e,t,n,r,i,o,a,s=0){const u=16.666/r;let c="{\n";for(let e=0;e<=1;e+=u){const r=t+(n-t)*o(e);c+=100*e+`%{${a(r,1-r)}}\n`}const l=c+`100% {${a(n,1-n)}}\n}`,h=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(l)}_${s}`;if(!$[h]){if(!B){const e=S("style");document.head.appendChild(e),B=e.sheet}$[h]=!0,B.insertRule(`@keyframes ${h} ${l}`,B.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${h} ${r}ms linear ${i}ms 1 both`,V+=1,h}function j(e,t){e.style.animation=(e.style.animation||"").split(", ").filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")).join(", "),t&&!--V&&m(()=>{if(V)return;let e=B.cssRules.length;for(;e--;)B.deleteRule(e);$={}})}function W(e){q=e}function z(){if(!q)throw new Error("Function called outside component initialization");return q}function K(e){z().$$.on_mount.push(e)}function G(e){z().$$.on_destroy.push(e)}function Q(){const e=z();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const i=F(t,n);r.slice().forEach(t=>{t.call(e,i)})}}}function H(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const Y=[],X=[],J=[],Z=[],ee=Promise.resolve();let te=!1;function ne(e){J.push(e)}function re(e){Z.push(e)}const ie=new Set;function oe(){do{for(;Y.length;){const e=Y.shift();W(e),ae(e.$$)}for(;X.length;)X.pop()();for(let e=0;e<J.length;e+=1){const t=J[e];ie.has(t)||(ie.add(t),t())}J.length=0}while(Y.length);for(;Z.length;)Z.pop()();te=!1,ie.clear()}function ae(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let se;function ue(){return se||(se=Promise.resolve(),se.then(()=>{se=null})),se}function ce(e,t,n){e.dispatchEvent(F(`${t?"intro":"outro"}${n}`))}const le=new Set;let he;function fe(){he={r:0,c:[],p:he}}function pe(){he.r||o(he.c),he=he.p}function de(e,t){e&&e.i&&(le.delete(e),e.i(t))}function me(e,t,n,r){if(e&&e.o){if(le.has(e))return;le.add(e),he.c.push(()=>{le.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const ge={duration:0};function ye(n,r,i,s){let u=r(n,i),c=s?0:1,l=null,h=null,f=null;function p(){f&&j(n,f)}function m(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(r){const{delay:i=0,duration:a=300,easing:s=t,tick:g=e,css:y}=u||ge,b={start:d()+i,b:r};r||(b.group=he,he.r+=1),l?h=b:(y&&(p(),f=U(n,c,r,a,i,s,y)),r&&g(0,1),l=m(b,a),ne(()=>ce(n,r,"start")),v(e=>{if(h&&e>h.start&&(l=m(h,a),h=null,ce(n,l.b,"start"),y&&(p(),f=U(n,c,l.b,l.duration,0,s,u.css))),l)if(e>=l.end)g(c=l.b,1-c),ce(n,l.b,"end"),h||(l.b?p():--l.group.r||o(l.group.c)),l=null;else if(e>=l.start){const t=e-l.start;c=l.a+l.d*s(t/l.duration),g(c,1-c)}return!(!l&&!h)}))}return{run(e){a(u)?ue().then(()=>{u=u(),g(e)}):g(e)},end(){p(),l=h=null}}}const ve="undefined"!=typeof window?window:global;function be(e,t){e.d(1),t.delete(e.key)}function we(e,t){me(e,1,1,()=>{t.delete(e.key)})}function Te(e,t,n,r,i,o,a,s,u,c,l,h){let f=e.length,p=o.length,d=f;const m={};for(;d--;)m[e[d].key]=d;const g=[],y=new Map,v=new Map;for(d=p;d--;){const e=h(i,o,d),s=n(e);let u=a.get(s);u?r&&u.p(e,t):(u=c(s,e),u.c()),y.set(s,g[d]=u),s in m&&v.set(s,Math.abs(d-m[s]))}const b=new Set,w=new Set;function T(e){de(e,1),e.m(s,l),a.set(e.key,e),l=e.first,p--}for(;f&&p;){const t=g[p-1],n=e[f-1],r=t.key,i=n.key;t===n?(l=t.first,f--,p--):y.has(i)?!a.has(r)||b.has(r)?T(t):w.has(i)?f--:v.get(r)>v.get(i)?(w.add(r),T(t)):(b.add(i),f--):(u(n,a),f--)}for(;f--;){const t=e[f];y.has(t.key)||u(t,a)}for(;p;)T(g[p-1]);return g}function Ee(e,t){const n={},r={},i={$$scope:1};let o=e.length;for(;o--;){const a=e[o],s=t[o];if(s){for(const e in a)e in s||(r[e]=1);for(const e in s)i[e]||(n[e]=s[e],i[e]=1);e[o]=s}else for(const e in a)i[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function Se(e){return"object"==typeof e&&null!==e?e:{}}function Ie(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function Ce(e){e&&e.c()}function Ae(e,t,n){const{fragment:i,on_mount:s,on_destroy:u,after_update:c}=e.$$;i&&i.m(t,n),ne(()=>{const t=s.map(r).filter(a);u?u.push(...t):o(t),e.$$.on_mount=[]}),c.forEach(ne)}function De(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ne(e,t){-1===e.$$.dirty[0]&&(Y.push(e),te||(te=!0,ee.then(oe)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ke(t,n,r,a,s,u,c=[-1]){const l=q;W(t);const h=n.props||{},f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:s,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:i(),dirty:c};let p=!1;f.ctx=r?r(t,h,(e,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=i)&&(f.bound[e]&&f.bound[e](i),p&&Ne(t,e)),n}):[],f.update(),p=!0,o(f.before_update),f.fragment=!!a&&a(f.ctx),n.target&&(n.hydrate?f.fragment&&f.fragment.l(function(e){return Array.from(e.childNodes)}(n.target)):f.fragment&&f.fragment.c(),n.intro&&de(t.$$.fragment),Ae(t,n.target,n.anchor),oe()),W(l)}class _e{$destroy(){De(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function xe(t){let n;return{c(){n=S("div"),n.innerHTML='<div id="header-logo" class=" svelte-1sdj23w"><a href="#"><img src="images/MUTEX%20White.png" alt="" class="svelte-1sdj23w"></a></div>',x(n,"id","brand"),x(n,"class","svelte-1sdj23w")},m(e,t){w(e,n,t)},p:e,i:e,o:e,d(e){e&&T(n)}}}class Re extends _e{constructor(e){super(),ke(this,e,null,xe,s,{})}}function Me(e){let t,n,r,i,a,s,u,c;const p=e[5].default,d=l(p,e,e[4],null);return{c(){t=S("div"),n=S("ul"),d&&d.c(),r=A(),i=S("button"),i.innerHTML='<span aria-hidden="true" class="svelte-hgrfde"></span>',a=A(),s=S("div"),x(n,"class","show-menu svelte-hgrfde"),x(i,"class","nav-tgl svelte-hgrfde"),x(i,"type","button"),x(i,"aria-label","toggle menu"),x(s,"id","circle"),x(s,"class","svelte-hgrfde"),x(t,"class","menu svelte-hgrfde"),L(t,"active",e[1])},m(o,l){w(o,t,l),b(t,n),d&&d.m(n,null),b(t,r),b(t,i),b(t,a),b(t,s),e[6](t),u=!0,c=[N(n,"click",e[2]),N(i,"click",e[3]),N(s,"click",e[2])]},p(e,[n]){d&&d.p&&16&n&&d.p(h(p,e,e[4],null),f(p,e[4],n,null)),2&n&&L(t,"active",e[1])},i(e){u||(de(d,e),u=!0)},o(e){me(d,e),u=!1},d(n){n&&T(t),d&&d.d(n),e[6](null),o(c)}}}function Oe(e,t,n){let r,i=!1,o=()=>{n(1,i=!1)},{$$slots:a={},$$scope:s}=t;return e.$set=e=>{"$$scope"in e&&n(4,s=e.$$scope)},[r,i,o,function(){-1===r.className.indexOf("active")?n(1,i=!0):o()},s,a,function(e){X[e?"unshift":"push"](()=>{n(0,r=e)})}]}class Pe extends _e{constructor(e){super(),ke(this,e,Oe,Me,s,{})}}const Le=[];function Fe(e,t){return{subscribe:Be(e,t).subscribe}}function Be(t,n=e){let r;const i=[];function o(e){if(s(t,e)&&(t=e,r)){const e=!Le.length;for(let e=0;e<i.length;e+=1){const n=i[e];n[1](),Le.push(n,t)}if(e){for(let e=0;e<Le.length;e+=2)Le[e][0](Le[e+1]);Le.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(a,s=e){const u=[a,s];return i.push(u),1===i.length&&(r=n(o)||e),a(t),()=>{const e=i.indexOf(u);-1!==e&&i.splice(e,1),0===i.length&&(r(),r=null)}}}}function qe(t,n,r){const i=!Array.isArray(t),s=i?[t]:t,c=n.length<2;return Fe(r,t=>{let r=!1;const l=[];let h=0,f=e;const p=()=>{if(h)return;f();const r=n(i?l[0]:l,t);c?t(r):f=a(r)?r:e},d=s.map((e,t)=>u(e,e=>{l[t]=e,h&=~(1<<t),r&&p()},()=>{h|=1<<t}));return r=!0,p(),function(){o(d),f()}})}function Ve(e){let t,n;var r=e[0];function i(e){return{props:{params:e[1]}}}if(r)var o=new r(i(e));return{c(){o&&Ce(o.$$.fragment),t=D()},m(e,r){o&&Ae(o,e,r),w(e,t,r),n=!0},p(e,[n]){const a={};if(2&n&&(a.params=e[1]),r!==(r=e[0])){if(o){fe();const e=o;me(e.$$.fragment,1,0,()=>{De(e,1)}),pe()}r?(Ce((o=new r(i(e))).$$.fragment),de(o.$$.fragment,1),Ae(o,t.parentNode,t)):o=null}else r&&o.$set(a)},i(e){n||(o&&de(o.$$.fragment,e),n=!0)},o(e){o&&me(o.$$.fragment,e),n=!1},d(e){e&&T(t),o&&De(o,e)}}}function $e(){const e=window.location.href.indexOf("#/");let t=e>-1?window.location.href.substr(e+1):"/";const n=t.indexOf("?");let r="";return n>-1&&(r=t.substr(n+1),t=t.substr(0,n)),{location:t,querystring:r}}const Ue=Fe($e(),(function(e){const t=()=>{e($e())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}})),je=qe(Ue,e=>e.location);qe(Ue,e=>e.querystring);function We(e){if(!e||e.length<1||"/"!=e.charAt(0)&&0!==e.indexOf("#/"))throw Error("Invalid parameter location");setTimeout(()=>{window.location.hash=("#"==e.charAt(0)?"":"#")+e},0)}function ze(t,n,r){let i,o=e;c(t,Ue,e=>r(4,i=e)),t.$$.on_destroy.push(()=>o());let{routes:a={}}=n,{prefix:s=""}=n;class u{constructor(e,t){if(!t||"function"!=typeof t&&("object"!=typeof t||!0!==t._sveltesparouter))throw Error("Invalid component object");if(!e||"string"==typeof e&&(e.length<1||"/"!=e.charAt(0)&&"*"!=e.charAt(0))||"object"==typeof e&&!(e instanceof RegExp))throw Error('Invalid value for "path" argument');const{pattern:n,keys:r}=function(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,i,o,a=[],s="",u=e.split("/");for(u[0]||u.shift();i=u.shift();)"*"===(n=i[0])?(a.push("wild"),s+="/(.*)"):":"===n?(r=i.indexOf("?",1),o=i.indexOf(".",1),a.push(i.substring(1,~r?r:~o?o:i.length)),s+=~r&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(s+=(~r?"?":"")+"\\"+i.substring(o))):s+="/"+i;return{keys:a,pattern:new RegExp("^"+s+(t?"(?=$|/)":"/?$"),"i")}}(e);this.path=e,"object"==typeof t&&!0===t._sveltesparouter?(this.component=t.route,this.conditions=t.conditions||[],this.userData=t.userData):(this.component=t,this.conditions=[],this.userData=void 0),this._pattern=n,this._keys=r}match(e){s&&e.startsWith(s)&&(e=e.substr(s.length)||"/");const t=this._pattern.exec(e);if(null===t)return null;if(!1===this._keys)return t;const n={};let r=0;for(;r<this._keys.length;)n[this._keys[r]]=t[++r]||null;return n}checkConditions(e){for(let t=0;t<this.conditions.length;t++)if(!this.conditions[t](e))return!1;return!0}}const l=a instanceof Map?a:Object.entries(a),h=[];for(const[e,t]of l)h.push(new u(e,t));let f=null,p={};const d=Q(),m=(e,t)=>{setTimeout(()=>{d(e,t)},0)};return t.$set=e=>{"routes"in e&&r(2,a=e.routes),"prefix"in e&&r(3,s=e.prefix)},t.$$.update=()=>{if(17&t.$$.dirty){r(0,f=null);let e=0;for(;!f&&e<h.length;){const t=h[e].match(i.location);if(t){const n={component:h[e].component,name:h[e].component.name,location:i.location,querystring:i.querystring,userData:h[e].userData};if(!h[e].checkConditions(n)){m("conditionsFailed",n);break}r(0,f=h[e].component),r(1,p=t),m("routeLoaded",n)}e++}}},[f,p,a,s]}class Ke extends _e{constructor(e){super(),ke(this,e,ze,Ve,s,{routes:2,prefix:3})}}function Ge(t){let n,r,i,o,a,s,u,c,l;return{c(){n=S("li"),r=S("a"),i=S("div"),o=I("svg"),a=I("rect"),s=A(),u=S("div"),c=C(t[2]),x(a,"class","shape svelte-v4fejv"),x(a,"height",t[0]),x(a,"width",t[1]),x(a,"rx","15"),x(o,"height",t[0]),x(o,"width",t[1]),x(o,"xmlns","http://www.w3.org/2000/svg"),x(o,"class","svelte-v4fejv"),x(u,"class","animatedLinkText svelte-v4fejv"),x(i,"class","svg-wrapper svelte-v4fejv"),x(r,"class","animatedLinkTag svelte-v4fejv"),x(r,"href",t[3])},m(e,h){w(e,n,h),b(n,r),b(r,i),b(i,o),b(o,a),b(i,s),b(i,u),b(u,c),t[9](r),l=N(r,"click",t[5])},p(e,[t]){1&t&&x(a,"height",e[0]),2&t&&x(a,"width",e[1]),1&t&&x(o,"height",e[0]),2&t&&x(o,"width",e[1]),4&t&&R(c,e[2]),8&t&&x(r,"href",e[3])},i:e,o:e,d(e){e&&T(n),t[9](null),l()}}}function Qe(e,t,n){let r;c(e,je,e=>n(7,r=e));let i,{height:o}=t,{width:a}=t,{text:s}=t,{location:u}=t,{type:l="scroll"}=t,h=function(e){e.preventDefault();const t=i.getAttribute("href"),n=document.querySelector(t);if(!n)return;const r=(o=n,Math.floor(o.getBoundingClientRect().top));var o;window.scrollBy({top:r-50,left:0,behavior:"smooth"})};return e.$set=e=>{"height"in e&&n(0,o=e.height),"width"in e&&n(1,a=e.width),"text"in e&&n(2,s=e.text),"location"in e&&n(3,u=e.location),"type"in e&&n(6,l=e.type)},[o,a,s,u,i,e=>{"/"===r?"scroll"!==l?"disapled"===l&&e.preventDefault():h(e):We("/")},l,r,h,function(e){X[e?"unshift":"push"](()=>{n(4,i=e)})}]}class He extends _e{constructor(e){super(),ke(this,e,Qe,Ge,s,{height:0,width:1,text:2,location:3,type:6})}}function Ye(t){let n,r,i,o;return{c(){n=S("li"),r=S("div"),i=C(t[0]),x(r,"class","btn svelte-gb1tgu"),L(r,"arrow",t[1]),x(n,"class","svelte-gb1tgu")},m(e,a){w(e,n,a),b(n,r),b(r,i),o=N(r,"click",t[2])},p(e,[t]){1&t&&R(i,e[0]),2&t&&L(r,"arrow",e[1])},i:e,o:e,d(e){e&&T(n),o()}}}function Xe(e,t,n){let{text:r}=t,{arrow:i}=t;return e.$set=e=>{"text"in e&&n(0,r=e.text),"arrow"in e&&n(1,i=e.arrow)},[r,i,function(t){H(e,t)}]}class Je extends _e{constructor(e){super(),ke(this,e,Xe,Ye,s,{text:0,arrow:1})}}function Ze(t){let n,r,i;return{c(){n=S("button"),r=C(t[0]),x(n,"class","btn primary svelte-1u94sfg"),L(n,"secondary",t[1])},m(e,o){w(e,n,o),b(n,r),i=N(n,"click",t[2])},p(e,[t]){1&t&&R(r,e[0]),2&t&&L(n,"secondary",e[1])},i:e,o:e,d(e){e&&T(n),i()}}}function et(e,t,n){let{text:r}=t,{secondary:i}=t;return e.$set=e=>{"text"in e&&n(0,r=e.text),"secondary"in e&&n(1,i=e.secondary)},[r,i,function(t){H(e,t)}]}class tt extends _e{constructor(e){super(),ke(this,e,et,Ze,s,{text:0,secondary:1})}}function nt(t){let n,r,i,a,s,u,c;return{c(){n=S("div"),r=S("div"),r.innerHTML='<p class="svelte-6plpko">Register for Event(Soon)</p>',i=A(),a=S("div"),a.innerHTML='<p class="svelte-6plpko">Register for Competition</p>',s=A(),u=S("div"),u.innerHTML='<p class="svelte-6plpko">Register for Workshops(Soon)</p>',x(r,"class","top closed  svelte-6plpko"),x(a,"class","mid open svelte-6plpko"),x(u,"class","bot closed svelte-6plpko"),x(n,"class","container svelte-6plpko")},m(e,o){w(e,n,o),b(n,r),b(n,i),b(n,a),b(n,s),b(n,u),c=[N(r,"click",_(t[0])),N(a,"click",_(t[1])),N(u,"click",_(t[2]))]},p:e,i:e,o:e,d(e){e&&T(n),o(c)}}}function rt(e){const t=Q();return[()=>t("clickLeft"),()=>t("clickMid"),()=>t("clickRight")]}class it extends _e{constructor(e){super(),ke(this,e,rt,nt,s,{})}}function ot(e){const t=e-1;return t*t*t+1}function at(e,{delay:n=0,duration:r=400,easing:i=t}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:i,css:e=>`opacity: ${e*o}`}}function st(e,{delay:t=0,duration:n=400,easing:r=ot,x:i=0,y:o=0,opacity:a=0}){const s=getComputedStyle(e),u=+s.opacity,c="none"===s.transform?"":s.transform,l=u*(1-a);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*i}px, ${(1-e)*o}px);\n\t\t\topacity: ${u-l*t}`}}function ut(e){let t,n,r,i,a,s,u;const c=e[6].default,p=l(c,e,e[5],null);return{c(){t=S("div"),r=A(),i=S("div"),p&&p.c(),x(t,"class","modal-background svelte-1ew5ihw"),x(i,"class","modal svelte-1ew5ihw"),x(i,"role","dialog"),x(i,"aria-modal","true")},m(n,o){w(n,t,o),w(n,r,o),w(n,i,o),p&&p.m(i,null),e[7](i),s=!0,u=[N(window,"keydown",e[2]),N(t,"click",e[1])]},p(e,[t]){p&&p.p&&32&t&&p.p(h(c,e,e[5],null),f(c,e[5],t,null))},i(e){s||(ne(()=>{n||(n=ye(t,at,{},!0)),n.run(1)}),de(p,e),ne(()=>{a||(a=ye(i,st,{y:300},!0)),a.run(1)}),s=!0)},o(e){n||(n=ye(t,at,{},!1)),n.run(0),me(p,e),a||(a=ye(i,st,{y:300},!1)),a.run(0),s=!1},d(s){s&&T(t),s&&n&&n.end(),s&&T(r),s&&T(i),p&&p.d(s),e[7](null),s&&a&&a.end(),o(u)}}}function ct(e,t,n){const r=Q(),i=()=>r("close");let o;const a="undefined"!=typeof document&&document.activeElement;a&&G(()=>{a.focus()});let{$$slots:s={},$$scope:u}=t;return e.$set=e=>{"$$scope"in e&&n(5,u=e.$$scope)},[o,i,e=>{if("Escape"!==e.key){if("Tab"===e.key){const t=o.querySelectorAll("*"),n=Array.from(t).filter(e=>e.tabIndex>=0);let r=n.indexOf(document.activeElement);-1===r&&e.shiftKey&&(r=0),r+=n.length+(e.shiftKey?-1:1),r%=n.length,n[r].focus(),e.preventDefault()}}else i()},r,a,u,s,function(e){X[e?"unshift":"push"](()=>{n(0,o=e)})}]}class lt extends _e{constructor(e){super(),ke(this,e,ct,ut,s,{})}}const{window:ht}=ve;function ft(t){let n,r,i,o,a,s;const u=new He({props:{location:"#aboutSection",width:75,height:30,text:"ABOUT"}}),c=new He({props:{location:"#speakers",width:100,height:30,text:"SPEAKERS"}}),l=new He({props:{location:"#sponsors",width:100,height:30,text:"PARTNERS"}}),h=new He({props:{location:"#",width:85,height:30,text:"EXHIBIT",type:"disapled"}}),f=new He({props:{location:"#",width:85,height:30,text:"AGENDA",type:"disapled"}}),p=new Je({props:{arrow:!0,text:"REGISTER"}});return p.$on("click",t[3]),{c(){Ce(u.$$.fragment),n=A(),Ce(c.$$.fragment),r=A(),Ce(l.$$.fragment),i=A(),Ce(h.$$.fragment),o=A(),Ce(f.$$.fragment),a=A(),Ce(p.$$.fragment)},m(e,t){Ae(u,e,t),w(e,n,t),Ae(c,e,t),w(e,r,t),Ae(l,e,t),w(e,i,t),Ae(h,e,t),w(e,o,t),Ae(f,e,t),w(e,a,t),Ae(p,e,t),s=!0},p:e,i(e){s||(de(u.$$.fragment,e),de(c.$$.fragment,e),de(l.$$.fragment,e),de(h.$$.fragment,e),de(f.$$.fragment,e),de(p.$$.fragment,e),s=!0)},o(e){me(u.$$.fragment,e),me(c.$$.fragment,e),me(l.$$.fragment,e),me(h.$$.fragment,e),me(f.$$.fragment,e),me(p.$$.fragment,e),s=!1},d(e){De(u,e),e&&T(n),De(c,e),e&&T(r),De(l,e),e&&T(i),De(h,e),e&&T(o),De(f,e),e&&T(a),De(p,e)}}}function pt(e){let t;const n=new lt({props:{$$slots:{default:[gt],controls:[mt],header:[dt]},$$scope:{ctx:e}}});return n.$on("close",e[3]),{c(){Ce(n.$$.fragment)},m(e,r){Ae(n,e,r),t=!0},p(e,t){const r={};256&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){t||(de(n.$$.fragment,e),t=!0)},o(e){me(n.$$.fragment,e),t=!1},d(e){De(n,e)}}}function dt(e){let t;return{c(){t=S("h2"),t.textContent="Register as ?",x(t,"slot","header")},m(e,n){w(e,t,n)},d(e){e&&T(t)}}}function mt(t){let n,r;const i=new tt({props:{text:"Choose"}});return{c(){n=S("span"),Ce(i.$$.fragment),x(n,"slot","controls")},m(e,t){w(e,n,t),Ae(i,n,null),r=!0},p:e,i(e){r||(de(i.$$.fragment,e),r=!0)},o(e){me(i.$$.fragment,e),r=!1},d(e){e&&T(n),De(i)}}}function gt(t){let n,r,i;const o=new it({});return o.$on("clickMid",t[4]),{c(){n=A(),r=A(),Ce(o.$$.fragment)},m(e,t){w(e,n,t),w(e,r,t),Ae(o,e,t),i=!0},p:e,i(e){i||(de(o.$$.fragment,e),i=!0)},o(e){me(o.$$.fragment,e),i=!1},d(e){e&&T(n),e&&T(r),De(o,e)}}}function yt(e){let t,n,r,i,o,a,s;const u=new Re({}),c=new Pe({props:{$$slots:{default:[ft]},$$scope:{ctx:e}}});let l=e[1]&&pt(e);return{c(){t=S("header"),n=S("nav"),Ce(u.$$.fragment),r=A(),Ce(c.$$.fragment),i=A(),l&&l.c(),o=D(),x(n,"class","svelte-bprszc"),L(n,"navBackgroundColor",e[0]),x(t,"class","svelte-bprszc")},m(h,f){w(h,t,f),b(t,n),Ae(u,n,null),b(n,r),Ae(c,n,null),w(h,i,f),l&&l.m(h,f),w(h,o,f),a=!0,s=N(ht,"scroll",e[2])},p(e,[t]){const r={};256&t&&(r.$$scope={dirty:t,ctx:e}),c.$set(r),1&t&&L(n,"navBackgroundColor",e[0]),e[1]?l?(l.p(e,t),de(l,1)):(l=pt(e),l.c(),de(l,1),l.m(o.parentNode,o)):l&&(fe(),me(l,1,1,()=>{l=null}),pe())},i(e){a||(de(u.$$.fragment,e),de(c.$$.fragment,e),de(l),a=!0)},o(e){me(u.$$.fragment,e),me(c.$$.fragment,e),me(l),a=!1},d(e){e&&T(t),De(u),De(c),e&&T(i),l&&l.d(e),e&&T(o),s()}}}function vt(e,t,n){let r;c(e,je,e=>n(6,r=e));let i=!1,o=!0,a=!1,s=()=>{n(1,a=!a),document.body.style.overflowY=a?"hidden":"unset"};return e.$$.update=()=>{64&e.$$.dirty&&n(0,i="/competition-registration"===r),64&e.$$.dirty&&(o="/competition-registration"!==r)},[i,a,e=>{if(!o)return;const t=window.pageYOffset;n(0,i=t>100)},s,()=>{s(),We("/competition-registration")}]}class bt extends _e{constructor(e){super(),ke(this,e,vt,yt,s,{})}}var wt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Tt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Et(e,t){return e(t={exports:{}},t.exports),t.exports}var St=Et((function(e,t){"undefined"!=typeof self&&self,e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){var n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=e.mergeSettings(t),this.selector="string"==typeof this.config.selector?document.querySelector(this.config.selector):this.config.selector,null===this.selector)throw new Error("Something wrong with your selector 😭");this.resolveSlidesNumber(),this.selectorWidth=this.selector.offsetWidth,this.innerElements=[].slice.call(this.selector.children),this.currentSlide=this.config.loop?this.config.startIndex%this.innerElements.length:Math.max(0,Math.min(this.config.startIndex,this.innerElements.length-this.perPage)),this.transformProperty=e.webkitOrNot(),["resizeHandler","touchstartHandler","touchendHandler","touchmoveHandler","mousedownHandler","mouseupHandler","mouseleaveHandler","mousemoveHandler","clickHandler"].forEach((function(e){n[e]=n[e].bind(n)})),this.init()}return i(e,[{key:"attachEvents",value:function(){window.addEventListener("resize",this.resizeHandler),this.config.draggable&&(this.pointerDown=!1,this.drag={startX:0,endX:0,startY:0,letItGo:null,preventClick:!1},this.selector.addEventListener("touchstart",this.touchstartHandler),this.selector.addEventListener("touchend",this.touchendHandler),this.selector.addEventListener("touchmove",this.touchmoveHandler),this.selector.addEventListener("mousedown",this.mousedownHandler),this.selector.addEventListener("mouseup",this.mouseupHandler),this.selector.addEventListener("mouseleave",this.mouseleaveHandler),this.selector.addEventListener("mousemove",this.mousemoveHandler),this.selector.addEventListener("click",this.clickHandler))}},{key:"detachEvents",value:function(){window.removeEventListener("resize",this.resizeHandler),this.selector.removeEventListener("touchstart",this.touchstartHandler),this.selector.removeEventListener("touchend",this.touchendHandler),this.selector.removeEventListener("touchmove",this.touchmoveHandler),this.selector.removeEventListener("mousedown",this.mousedownHandler),this.selector.removeEventListener("mouseup",this.mouseupHandler),this.selector.removeEventListener("mouseleave",this.mouseleaveHandler),this.selector.removeEventListener("mousemove",this.mousemoveHandler),this.selector.removeEventListener("click",this.clickHandler)}},{key:"init",value:function(){this.attachEvents(),this.selector.style.overflow="hidden",this.selector.style.direction=this.config.rtl?"rtl":"ltr",this.buildSliderFrame(),this.config.onInit.call(this)}},{key:"buildSliderFrame",value:function(){var e=this.selectorWidth/this.perPage,t=this.config.loop?this.innerElements.length+2*this.perPage:this.innerElements.length;this.sliderFrame=document.createElement("div"),this.sliderFrame.style.width=e*t+"px",this.enableTransition(),this.config.draggable&&(this.selector.style.cursor="-webkit-grab");var n=document.createDocumentFragment();if(this.config.loop)for(var r=this.innerElements.length-this.perPage;r<this.innerElements.length;r++){var i=this.buildSliderFrameItem(this.innerElements[r].cloneNode(!0));n.appendChild(i)}for(var o=0;o<this.innerElements.length;o++){var a=this.buildSliderFrameItem(this.innerElements[o]);n.appendChild(a)}if(this.config.loop)for(var s=0;s<this.perPage;s++){var u=this.buildSliderFrameItem(this.innerElements[s].cloneNode(!0));n.appendChild(u)}this.sliderFrame.appendChild(n),this.selector.innerHTML="",this.selector.appendChild(this.sliderFrame),this.slideToCurrent()}},{key:"buildSliderFrameItem",value:function(e){var t=document.createElement("div");return t.style.cssFloat=this.config.rtl?"right":"left",t.style.float=this.config.rtl?"right":"left",t.style.width=(this.config.loop?100/(this.innerElements.length+2*this.perPage):100/this.innerElements.length)+"%",t.appendChild(e),t}},{key:"resolveSlidesNumber",value:function(){if("number"==typeof this.config.perPage)this.perPage=this.config.perPage;else if("object"===r(this.config.perPage))for(var e in this.perPage=1,this.config.perPage)window.innerWidth>=e&&(this.perPage=this.config.perPage[e])}},{key:"prev",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments[1];if(!(this.innerElements.length<=this.perPage)){var n=this.currentSlide;if(this.config.loop)if(this.currentSlide-e<0){this.disableTransition();var r=this.currentSlide+this.innerElements.length,i=this.perPage,o=r+i,a=(this.config.rtl?1:-1)*o*(this.selectorWidth/this.perPage),s=this.config.draggable?this.drag.endX-this.drag.startX:0;this.sliderFrame.style[this.transformProperty]="translate3d("+(a+s)+"px, 0, 0)",this.currentSlide=r-e}else this.currentSlide=this.currentSlide-e;else this.currentSlide=Math.max(this.currentSlide-e,0);n!==this.currentSlide&&(this.slideToCurrent(this.config.loop),this.config.onChange.call(this),t&&t.call(this))}}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments[1];if(!(this.innerElements.length<=this.perPage)){var n=this.currentSlide;if(this.config.loop)if(this.currentSlide+e>this.innerElements.length-this.perPage){this.disableTransition();var r=this.currentSlide-this.innerElements.length,i=this.perPage,o=r+i,a=(this.config.rtl?1:-1)*o*(this.selectorWidth/this.perPage),s=this.config.draggable?this.drag.endX-this.drag.startX:0;this.sliderFrame.style[this.transformProperty]="translate3d("+(a+s)+"px, 0, 0)",this.currentSlide=r+e}else this.currentSlide=this.currentSlide+e;else this.currentSlide=Math.min(this.currentSlide+e,this.innerElements.length-this.perPage);n!==this.currentSlide&&(this.slideToCurrent(this.config.loop),this.config.onChange.call(this),t&&t.call(this))}}},{key:"disableTransition",value:function(){this.sliderFrame.style.webkitTransition="all 0ms "+this.config.easing,this.sliderFrame.style.transition="all 0ms "+this.config.easing}},{key:"enableTransition",value:function(){this.sliderFrame.style.webkitTransition="all "+this.config.duration+"ms "+this.config.easing,this.sliderFrame.style.transition="all "+this.config.duration+"ms "+this.config.easing}},{key:"goTo",value:function(e,t){if(!(this.innerElements.length<=this.perPage)){var n=this.currentSlide;this.currentSlide=this.config.loop?e%this.innerElements.length:Math.min(Math.max(e,0),this.innerElements.length-this.perPage),n!==this.currentSlide&&(this.slideToCurrent(),this.config.onChange.call(this),t&&t.call(this))}}},{key:"slideToCurrent",value:function(e){var t=this,n=this.config.loop?this.currentSlide+this.perPage:this.currentSlide,r=(this.config.rtl?1:-1)*n*(this.selectorWidth/this.perPage);e?requestAnimationFrame((function(){requestAnimationFrame((function(){t.enableTransition(),t.sliderFrame.style[t.transformProperty]="translate3d("+r+"px, 0, 0)"}))})):this.sliderFrame.style[this.transformProperty]="translate3d("+r+"px, 0, 0)"}},{key:"updateAfterDrag",value:function(){var e=(this.config.rtl?-1:1)*(this.drag.endX-this.drag.startX),t=Math.abs(e),n=this.config.multipleDrag?Math.ceil(t/(this.selectorWidth/this.perPage)):1,r=e>0&&this.currentSlide-n<0,i=e<0&&this.currentSlide+n>this.innerElements.length-this.perPage;e>0&&t>this.config.threshold&&this.innerElements.length>this.perPage?this.prev(n):e<0&&t>this.config.threshold&&this.innerElements.length>this.perPage&&this.next(n),this.slideToCurrent(r||i)}},{key:"resizeHandler",value:function(){this.resolveSlidesNumber(),this.currentSlide+this.perPage>this.innerElements.length&&(this.currentSlide=this.innerElements.length<=this.perPage?0:this.innerElements.length-this.perPage),this.selectorWidth=this.selector.offsetWidth,this.buildSliderFrame()}},{key:"clearDrag",value:function(){this.drag={startX:0,endX:0,startY:0,letItGo:null,preventClick:this.drag.preventClick}}},{key:"touchstartHandler",value:function(e){-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.target.nodeName)||(e.stopPropagation(),this.pointerDown=!0,this.drag.startX=e.touches[0].pageX,this.drag.startY=e.touches[0].pageY)}},{key:"touchendHandler",value:function(e){e.stopPropagation(),this.pointerDown=!1,this.enableTransition(),this.drag.endX&&this.updateAfterDrag(),this.clearDrag()}},{key:"touchmoveHandler",value:function(e){if(e.stopPropagation(),null===this.drag.letItGo&&(this.drag.letItGo=Math.abs(this.drag.startY-e.touches[0].pageY)<Math.abs(this.drag.startX-e.touches[0].pageX)),this.pointerDown&&this.drag.letItGo){e.preventDefault(),this.drag.endX=e.touches[0].pageX,this.sliderFrame.style.webkitTransition="all 0ms "+this.config.easing,this.sliderFrame.style.transition="all 0ms "+this.config.easing;var t=(this.config.loop?this.currentSlide+this.perPage:this.currentSlide)*(this.selectorWidth/this.perPage),n=this.drag.endX-this.drag.startX,r=this.config.rtl?t+n:t-n;this.sliderFrame.style[this.transformProperty]="translate3d("+(this.config.rtl?1:-1)*r+"px, 0, 0)"}}},{key:"mousedownHandler",value:function(e){-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.target.nodeName)||(e.preventDefault(),e.stopPropagation(),this.pointerDown=!0,this.drag.startX=e.pageX)}},{key:"mouseupHandler",value:function(e){e.stopPropagation(),this.pointerDown=!1,this.selector.style.cursor="-webkit-grab",this.enableTransition(),this.drag.endX&&this.updateAfterDrag(),this.clearDrag()}},{key:"mousemoveHandler",value:function(e){if(e.preventDefault(),this.pointerDown){"A"===e.target.nodeName&&(this.drag.preventClick=!0),this.drag.endX=e.pageX,this.selector.style.cursor="-webkit-grabbing",this.sliderFrame.style.webkitTransition="all 0ms "+this.config.easing,this.sliderFrame.style.transition="all 0ms "+this.config.easing;var t=(this.config.loop?this.currentSlide+this.perPage:this.currentSlide)*(this.selectorWidth/this.perPage),n=this.drag.endX-this.drag.startX,r=this.config.rtl?t+n:t-n;this.sliderFrame.style[this.transformProperty]="translate3d("+(this.config.rtl?1:-1)*r+"px, 0, 0)"}}},{key:"mouseleaveHandler",value:function(e){this.pointerDown&&(this.pointerDown=!1,this.selector.style.cursor="-webkit-grab",this.drag.endX=e.pageX,this.drag.preventClick=!1,this.enableTransition(),this.updateAfterDrag(),this.clearDrag())}},{key:"clickHandler",value:function(e){this.drag.preventClick&&e.preventDefault(),this.drag.preventClick=!1}},{key:"remove",value:function(e,t){if(e<0||e>=this.innerElements.length)throw new Error("Item to remove doesn't exist 😭");var n=e<this.currentSlide,r=this.currentSlide+this.perPage-1===e;(n||r)&&this.currentSlide--,this.innerElements.splice(e,1),this.buildSliderFrame(),t&&t.call(this)}},{key:"insert",value:function(e,t,n){if(t<0||t>this.innerElements.length+1)throw new Error("Unable to inset it at this index 😭");if(-1!==this.innerElements.indexOf(e))throw new Error("The same item in a carousel? Really? Nope 😭");var r=t<=this.currentSlide>0&&this.innerElements.length;this.currentSlide=r?this.currentSlide+1:this.currentSlide,this.innerElements.splice(t,0,e),this.buildSliderFrame(),n&&n.call(this)}},{key:"prepend",value:function(e,t){this.insert(e,0),t&&t.call(this)}},{key:"append",value:function(e,t){this.insert(e,this.innerElements.length+1),t&&t.call(this)}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];if(this.detachEvents(),this.selector.style.cursor="auto",e){for(var n=document.createDocumentFragment(),r=0;r<this.innerElements.length;r++)n.appendChild(this.innerElements[r]);this.selector.innerHTML="",this.selector.appendChild(n),this.selector.removeAttribute("style")}t&&t.call(this)}}],[{key:"mergeSettings",value:function(e){var t={selector:".siema",duration:200,easing:"ease-out",perPage:1,startIndex:0,draggable:!0,multipleDrag:!0,threshold:20,loop:!1,rtl:!1,onInit:function(){},onChange:function(){}},n=e;for(var r in n)t[r]=n[r];return t}},{key:"webkitOrNot",value:function(){return"string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform"}}]),e}();t.default=o,e.exports=t.default}])})),It=Tt(St);St.Siema;const Ct=e=>({}),At=e=>({});function Dt(e,t,n){const r=e.slice();return r[14]=t[n],r[16]=n,r}const Nt=e=>({}),kt=e=>({});function _t(e){let t,n;function r(...t){return e[13](e[16],...t)}return{c(){t=S("li"),x(t,"class","svelte-6pleld")},m(e,i){w(e,t,i),n=N(t,"click",r)},p(t,n){e=t},d(e){e&&T(t),n()}}}function xt(e){let t,n,r,i,a,s,u,c,p,d;const m=e[11]["left-control"],g=l(m,e,e[10],kt),y=e[11].default,v=l(y,e,e[10],null);let I=e[1],C=[];for(let t=0;t<I.length;t+=1)C[t]=_t(Dt(e,I,t));const D=e[11]["right-control"],k=l(D,e,e[10],At);return{c(){t=S("div"),n=S("button"),g&&g.c(),r=A(),i=S("div"),v&&v.c(),a=A(),s=S("ul");for(let e=0;e<C.length;e+=1)C[e].c();u=A(),c=S("button"),k&&k.c(),x(n,"class","left svelte-6pleld"),x(i,"class","slides"),x(s,"class","svelte-6pleld"),x(c,"class","right svelte-6pleld"),x(t,"class","carousel svelte-6pleld")},m(o,l){w(o,t,l),b(t,n),g&&g.m(n,null),b(t,r),b(t,i),v&&v.m(i,null),e[12](i),b(t,a),b(t,s);for(let e=0;e<C.length;e+=1)C[e].m(s,null);b(t,u),b(t,c),k&&k.m(c,null),p=!0,d=[N(n,"click",e[2]),N(c,"click",e[3])]},p(e,[t]){if(g&&g.p&&1024&t&&g.p(h(m,e,e[10],kt),f(m,e[10],t,Nt)),v&&v.p&&1024&t&&v.p(h(y,e,e[10],null),f(y,e[10],t,null)),18&t){let n;for(I=e[1],n=0;n<I.length;n+=1){const r=Dt(e,I,n);C[n]?C[n].p(r,t):(C[n]=_t(r),C[n].c(),C[n].m(s,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=I.length}k&&k.p&&1024&t&&k.p(h(D,e,e[10],At),f(D,e[10],t,Ct))},i(e){p||(de(g,e),de(v,e),de(k,e),p=!0)},o(e){me(g,e),me(v,e),me(k,e),p=!1},d(n){n&&T(t),g&&g.d(n),v&&v.d(n),e[12](null),E(C,n),k&&k.d(n),o(d)}}}function Rt(e,t,n){let r,i,{perPage:o=3}=t,{loop:a=!0}=t,{autoplay:s=0}=t;function u(){i.next()}function c(e){i.goTo(e)}K(()=>(n(8,i=new It({selector:r,perPage:o,loop:a})),s&&setInterval(u,s),()=>{s&&clearTimeout(void 0),i.destroy()}));let{$$slots:l={},$$scope:h}=t;let f;return e.$set=e=>{"perPage"in e&&n(5,o=e.perPage),"loop"in e&&n(6,a=e.loop),"autoplay"in e&&n(7,s=e.autoplay),"$$scope"in e&&n(10,h=e.$$scope)},e.$$.update=()=>{256&e.$$.dirty&&n(1,f=i?i.innerElements:[])},[r,f,function(){i.prev()},u,c,o,a,s,i,void 0,h,l,function(e){X[e?"unshift":"push"](()=>{n(0,r=e)})},e=>c(e)]}class Mt extends _e{constructor(e){super(),ke(this,e,Rt,xt,s,{perPage:5,loop:6,autoplay:7})}}function Ot(e){let t,n,r,i,o;return{c(){t=S("div"),t.innerHTML='<p class="carousel-description svelte-1f4fb9o">MUTEX 2017</p>',n=A(),r=S("div"),r.innerHTML='<p class="carousel-description svelte-1f4fb9o">MUTEX 2018</p>',i=A(),o=S("div"),o.innerHTML='<p class="carousel-description svelte-1f4fb9o">MUTEX 2019</p>',x(t,"class","slide-content carousel-item carousel-item1 svelte-1f4fb9o"),x(r,"class","slide-content carousel-item carousel-item2 svelte-1f4fb9o"),x(o,"class","slide-content carousel-item carousel-item3 svelte-1f4fb9o")},m(e,a){w(e,t,a),w(e,n,a),w(e,r,a),w(e,i,a),w(e,o,a)},d(e){e&&T(t),e&&T(n),e&&T(r),e&&T(i),e&&T(o)}}}function Pt(e){let t;const n=new Mt({props:{perPage:1,autoplay:1700,loop:!0,$$slots:{default:[Ot]},$$scope:{ctx:e}}});return{c(){Ce(n.$$.fragment)},m(e,r){Ae(n,e,r),t=!0},p(e,[t]){const r={};1&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){t||(de(n.$$.fragment,e),t=!0)},o(e){me(n.$$.fragment,e),t=!1},d(e){De(n,e)}}}class Lt extends _e{constructor(e){super(),ke(this,e,null,Pt,s,{})}}function Ft(t){let n,r,i,o,a,s=t[2].header+"",u=t[2].description+"";return{c(){n=S("div"),r=S("h3"),i=C(s),o=A(),a=S("p"),x(r,"class","svelte-rntcex"),x(a,"class","svelte-rntcex"),O(n,"width",t[0]+"px "),O(n,"height",t[1]+"px "),O(n,"background-image",t[3]),x(n,"class","svelte-rntcex")},m(e,t){w(e,n,t),b(n,r),b(r,i),b(n,o),b(n,a),a.innerHTML=u},p(e,[t]){4&t&&s!==(s=e[2].header+"")&&R(i,s),4&t&&u!==(u=e[2].description+"")&&(a.innerHTML=u),1&t&&O(n,"width",e[0]+"px "),2&t&&O(n,"height",e[1]+"px "),8&t&&O(n,"background-image",e[3])},i:e,o:e,d(e){e&&T(n)}}}function Bt(e,t,n){let{width:r}=t,{height:i}=t,{textContent:o}=t,{backgroundImage:a}=t;return e.$set=e=>{"width"in e&&n(0,r=e.width),"height"in e&&n(1,i=e.height),"textContent"in e&&n(2,o=e.textContent),"backgroundImage"in e&&n(3,a=e.backgroundImage)},[r,i,o,a]}class qt extends _e{constructor(e){super(),ke(this,e,Bt,Ft,s,{width:0,height:1,textContent:2,backgroundImage:3})}}function Vt(e){let t,n,r=e[0].description+"";return{c(){t=S("p"),n=C(r),x(t,"class","svelte-1gog9u7")},m(e,r){w(e,t,r),b(t,n)},p(e,t){1&t&&r!==(r=e[0].description+"")&&R(n,r)},d(e){e&&T(t)}}}function $t(t){let n,r,i,o,a=t[0].header+"",s=t[0].description&&Vt(t);return{c(){n=S("div"),r=S("h2"),i=C(a),o=A(),s&&s.c(),x(r,"class","svelte-1gog9u7"),x(n,"class","underline-heading svelte-1gog9u7")},m(e,t){w(e,n,t),b(n,r),b(r,i),b(n,o),s&&s.m(n,null)},p(e,[t]){1&t&&a!==(a=e[0].header+"")&&R(i,a),e[0].description?s?s.p(e,t):(s=Vt(e),s.c(),s.m(n,null)):s&&(s.d(1),s=null)},i:e,o:e,d(e){e&&T(n),s&&s.d()}}}function Ut(e,t,n){let{textContent:r}=t;return e.$set=e=>{"textContent"in e&&n(0,r=e.textContent)},[r]}class jt extends _e{constructor(e){super(),ke(this,e,Ut,$t,s,{textContent:0})}}function Wt(t){let n,r,i,o,a,s;const u=new jt({props:{textContent:{header:"About MUTEX",description:" MUTEX is the biggest technological annual event hosted by IEEE Zagazig SB.The event mainly focuses on introducing the latest technologies incomputer science fields to the audience and setting a clear path for themto follow."}}}),c=new qt({props:{width:300,height:400,textContent:{header:"Vision",description:"Banishing the gap between the latest technology trends and the current community awareness."},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/Vision.jpg)"}}),l=new qt({props:{width:300,height:400,textContent:{header:"Mission",description:"Establishing a link between the leading companies/organizations in the latest technologies or the  ones that support the tech ecosystem and our community’s CS students, Engineers, Startups, and Techies through sets of talks, training, and workshops."},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/mission.jpg)"}}),h=new qt({props:{width:300,height:400,textContent:{header:"Goals",description:"<p>Spread technological awareness among university students, startups, and investors of Al-Delta region.</p><p>Give the students the work experience in the latest technologies through workshops.</p><p>Connect Al-Delta tech ecosystem with resources and opportunities.</p>"},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/Goals.jpg)"}});return{c(){n=S("section"),Ce(u.$$.fragment),r=A(),i=S("div"),Ce(c.$$.fragment),o=A(),Ce(l.$$.fragment),a=A(),Ce(h.$$.fragment),x(i,"id","container"),x(i,"class","svelte-1poviqi"),x(n,"id","aboutSection"),x(n,"class","svelte-1poviqi")},m(e,t){w(e,n,t),Ae(u,n,null),b(n,r),b(n,i),Ae(c,i,null),b(i,o),Ae(l,i,null),b(i,a),Ae(h,i,null),s=!0},p:e,i(e){s||(de(u.$$.fragment,e),de(c.$$.fragment,e),de(l.$$.fragment,e),de(h.$$.fragment,e),s=!0)},o(e){me(u.$$.fragment,e),me(c.$$.fragment,e),me(l.$$.fragment,e),me(h.$$.fragment,e),s=!1},d(e){e&&T(n),De(u),De(c),De(l),De(h)}}}class zt extends _e{constructor(e){super(),ke(this,e,null,Wt,s,{})}}function Kt(t){let n,r,i,o,a,s,u;const c=new jt({props:{textContent:{header:"What to Expect at MUTEX"}}}),l=new qt({props:{width:250,height:350,textContent:{header:"Learning",description:"Learn from the leading multinational companies and well established organizations about technology trends and tech-related entrepreneurship topics through many talks and panel discussions."},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/Learning.png)"}}),h=new qt({props:{width:250,height:350,textContent:{header:"Practising",description:"Practice in hands-on/interactive workshops to gain practical experience"},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/Practicing.png)"}}),f=new qt({props:{width:250,height:350,textContent:{header:"Networking",description:"Meet Enterprise, Startups, Investors, and Techies who will all gather in one inspiring space for two days and connect with the Tech ecosystem."},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/Networking.png)"}}),p=new qt({props:{width:250,height:350,textContent:{header:"Pitching",description:"Are you a Tech or Tech-enabled startup? This is an opportunity to fund your business and connect with investors, gain coverage in media publications, and extend to potential customers in Al-Delta region. And also an opportunity to apply in our pitching competitions."},backgroundImage:"linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ),url(../images/Pitching.png)"}});return{c(){n=S("section"),Ce(c.$$.fragment),r=A(),i=S("div"),Ce(l.$$.fragment),o=A(),Ce(h.$$.fragment),a=A(),Ce(f.$$.fragment),s=A(),Ce(p.$$.fragment),x(i,"id","container"),x(i,"class","svelte-hhqc3a"),x(n,"id","lpnp")},m(e,t){w(e,n,t),Ae(c,n,null),b(n,r),b(n,i),Ae(l,i,null),b(i,o),Ae(h,i,null),b(i,a),Ae(f,i,null),b(i,s),Ae(p,i,null),u=!0},p:e,i(e){u||(de(c.$$.fragment,e),de(l.$$.fragment,e),de(h.$$.fragment,e),de(f.$$.fragment,e),de(p.$$.fragment,e),u=!0)},o(e){me(c.$$.fragment,e),me(l.$$.fragment,e),me(h.$$.fragment,e),me(f.$$.fragment,e),me(p.$$.fragment,e),u=!1},d(e){e&&T(n),De(c),De(l),De(h),De(f),De(p)}}}class Gt extends _e{constructor(e){super(),ke(this,e,null,Kt,s,{})}}function Qt(t){let n,r,i,o;const a=new jt({props:{textContent:{header:"STATISTICS"}}});return{c(){n=S("section"),Ce(a.$$.fragment),r=A(),i=S("div"),i.innerHTML='<div id="item" class="svelte-fb13td"><img src="../images/talks.jpg" alt="" class="svelte-fb13td"> \n      <div class="vl svelte-fb13td"></div> \n      <div class="two-level-text svelte-fb13td"><h3 class="svelte-fb13td">18</h3> \n        <h3 class="svelte-fb13td">Talks</h3></div></div> \n    <div id="item" class="svelte-fb13td"><img src="../images/workshops2.png" alt="" class="svelte-fb13td"> \n      <div class="vl svelte-fb13td"></div> \n      <div class="two-level-text svelte-fb13td"><h3 class="svelte-fb13td">15</h3> \n        <h3 class="svelte-fb13td">Workshops</h3></div></div> \n    <div id="item" class="svelte-fb13td"><img src="../images/tracks.png" alt="" class="svelte-fb13td"> \n      <div class="vl svelte-fb13td"></div> \n      <div class="two-level-text svelte-fb13td"><h3 class="svelte-fb13td">9</h3> \n        <h3 class="svelte-fb13td">Tracks</h3></div></div> \n    <div id="item" class="svelte-fb13td"><img src="../images/users.png" alt="" class="svelte-fb13td"> \n      <div class="vl svelte-fb13td"></div> \n      <div class="two-level-text svelte-fb13td"><h3 class="svelte-fb13td">1580+</h3> \n        <h3 class="svelte-fb13td">Attendees</h3></div></div>',x(i,"id","container"),x(i,"class","svelte-fb13td"),x(n,"id","STATISTICS"),x(n,"class","svelte-fb13td")},m(e,t){w(e,n,t),Ae(a,n,null),b(n,r),b(n,i),o=!0},p:e,i(e){o||(de(a.$$.fragment,e),o=!0)},o(e){me(a.$$.fragment,e),o=!1},d(e){e&&T(n),De(a)}}}class Ht extends _e{constructor(e){super(),ke(this,e,null,Qt,s,{})}}function Yt(t){let n,r,i,o,a,s,u;return{c(){n=S("div"),r=S("div"),i=S("p"),o=C(t[1]),a=A(),s=S("p"),u=C(t[2]),x(i,"class","text-top svelte-3an1cx"),x(s,"class","svelte-3an1cx"),x(r,"class","svelte-3an1cx"),x(n,"id","container"),O(n,"background-image","url('"+t[0]+"')"),x(n,"class","svelte-3an1cx")},m(e,t){w(e,n,t),b(n,r),b(r,i),b(i,o),b(r,a),b(r,s),b(s,u)},p(e,[t]){2&t&&R(o,e[1]),4&t&&R(u,e[2]),1&t&&O(n,"background-image","url('"+e[0]+"')")},i:e,o:e,d(e){e&&T(n)}}}function Xt(e,t,n){let{speakerImage:r}=t,{speakerName:i}=t,{speakerJob:o}=t;return e.$set=e=>{"speakerImage"in e&&n(0,r=e.speakerImage),"speakerName"in e&&n(1,i=e.speakerName),"speakerJob"in e&&n(2,o=e.speakerJob)},[r,i,o]}class Jt extends _e{constructor(e){super(),ke(this,e,Xt,Yt,s,{speakerImage:0,speakerName:1,speakerJob:2})}}function Zt(e,t,n){const r=e.slice();return r[1]=t[n],r}function en(e){let t;const r=[e[1]];let i={};for(let e=0;e<r.length;e+=1)i=n(i,r[e]);const o=new Jt({props:i});return{c(){Ce(o.$$.fragment)},m(e,n){Ae(o,e,n),t=!0},p(e,t){const n=1&t?Ee(r,[Se(e[1])]):{};o.$set(n)},i(e){t||(de(o.$$.fragment,e),t=!0)},o(e){me(o.$$.fragment,e),t=!1},d(e){De(o,e)}}}function tn(e){let t,n,r,i;const o=new jt({props:{textContent:{header:"Previous Speakers"}}});let a=e[0],s=[];for(let t=0;t<a.length;t+=1)s[t]=en(Zt(e,a,t));const u=e=>me(s[e],1,1,()=>{s[e]=null});return{c(){t=S("section"),Ce(o.$$.fragment),n=A(),r=S("div");for(let e=0;e<s.length;e+=1)s[e].c();x(r,"class","container svelte-srw0ap"),x(t,"id","speakers"),x(t,"class","svelte-srw0ap")},m(e,a){w(e,t,a),Ae(o,t,null),b(t,n),b(t,r);for(let e=0;e<s.length;e+=1)s[e].m(r,null);i=!0},p(e,[t]){if(1&t){let n;for(a=e[0],n=0;n<a.length;n+=1){const i=Zt(e,a,n);s[n]?(s[n].p(i,t),de(s[n],1)):(s[n]=en(i),s[n].c(),de(s[n],1),s[n].m(r,null))}for(fe(),n=a.length;n<s.length;n+=1)u(n);pe()}},i(e){if(!i){de(o.$$.fragment,e);for(let e=0;e<a.length;e+=1)de(s[e]);i=!0}},o(e){me(o.$$.fragment,e),s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)me(s[e]);i=!1},d(e){e&&T(t),De(o),E(s,e)}}}function nn(e){return[[{speakerImage:"../images/speakers/Amr Abulnaga.jpg",speakerName:"Amr Abulnaga",speakerJob:"The Regional Technical Consultant at Oracle"},{speakerImage:"../images/speakers/Ghada Bahig.jpg",speakerName:"Ghada Bahig",speakerJob:"Engineering Manager at Mentor Graphics"},{speakerImage:"../images/speakers/Amr Ali.jpg",speakerName:"Amr Ali",speakerJob:"Big data and Analytics Technical Consultant at Oracle"},{speakerImage:"../images/speakers/Omar Amer.jpg",speakerName:"Omar Amer",speakerJob:"Machine Learning Engineer at IBM"},{speakerImage:"../images/speakers/Ahmed Abd-Elfattah.jpg",speakerName:"Ahmed Abd-Elfattah",speakerJob:"Knowledge Management Manager at Valeo"},{speakerImage:"../images/speakers/Ahmed Said.jpg",speakerName:"Ahmed Said",speakerJob:"IBM"},{speakerImage:"../images/speakers/Ayman Ragab.jpg",speakerName:"Ayman Ragab",speakerJob:"Consultant in The R_D Department at NTRA"},{speakerImage:"../images/speakers/Mohamed Abd-Elmonem.jpg",speakerName:"Mohamed Abd-Elmonem",speakerJob:"Radio Optimization Senior Engineer at Vodafone"},{speakerImage:"../images/speakers/Mostafa Helmy.jpg",speakerName:"Mostafa Helmy",speakerJob:"Identity _ Access Management Advisor at RSA Security"},{speakerImage:"../images/speakers/Nahel Mohamed.jpg",speakerName:"Nahel Mohamed",speakerJob:"Innovation Support Manager at TIEC"},{speakerImage:"../images/speakers/Oriette M. Nayel.jpg",speakerName:"Oriette M. Nayel",speakerJob:"University Relations Leader at IBM"},{speakerImage:"../images/speakers/Peter George.jpg",speakerName:"Peter George",speakerJob:"Senior Analyst at RSA Security"},{speakerImage:"../images/speakers/Abdalla Amr.jpg",speakerName:"Abdalla Amr",speakerJob:"TIEC Ambassador"},{speakerImage:"../images/speakers/Ahmed Samir.jpg",speakerName:"Ahmed Samir",speakerJob:"Enterprise Technical Services Advisor@Dell EMC"},{speakerImage:"../images/speakers/Amir Elsenousy.jpg",speakerName:"Amir Elsenousy",speakerJob:"Research projects manager @ NTRA"},{speakerImage:"../images/speakers/Bassem Ibrahim.jpg",speakerName:"Bassem Ibrahim",speakerJob:"Network solutions architect @ Ericsson"},{speakerImage:"../images/speakers/Ebeid Atef.jpg",speakerName:"Ebeid Atef",speakerJob:"Microsoft Education Technical"},{speakerImage:"../images/speakers/Hesham Elzoghby.jpg",speakerName:"Hesham Elzoghby",speakerJob:"Cyber Talents"},{speakerImage:"../images/speakers/Hesham Eraqi.jpg",speakerName:"Hesham Eraqi",speakerJob:"Deep learning Secnior expert @Valeo"},{speakerImage:"../images/speakers/Mohamed Elgharably.jpg",speakerName:"Mohamed Elgharably",speakerJob:"Networks chief technology officer@Ericsson"}]]}class rn extends _e{constructor(e){super(),ke(this,e,nn,tn,s,{})}}function on(t){let n,r,i,o,a,s;return{c(){n=S("div"),r=S("img"),o=A(),a=S("p"),s=C(t[1]),r.src!==(i=t[0])&&x(r,"src",i),x(r,"alt",""),x(r,"class","svelte-agg6a"),x(n,"class","svelte-agg6a")},m(e,t){w(e,n,t),b(n,r),b(n,o),b(n,a),b(a,s)},p(e,[t]){1&t&&r.src!==(i=e[0])&&x(r,"src",i),2&t&&R(s,e[1])},i:e,o:e,d(e){e&&T(n)}}}function an(e,t,n){let{sponsorImage:r}=t,{sponsorRole:i}=t;return e.$set=e=>{"sponsorImage"in e&&n(0,r=e.sponsorImage),"sponsorRole"in e&&n(1,i=e.sponsorRole)},[r,i]}class sn extends _e{constructor(e){super(),ke(this,e,an,on,s,{sponsorImage:0,sponsorRole:1})}}function un(e,t,n){const r=e.slice();return r[9]=t[n],r}function cn(e,t,n){const r=e.slice();return r[5]=t[n][0],r[6]=t[n][1],r}function ln(e,t,n){const r=e.slice();return r[1]=t[n][0],r[2]=t[n][1],r}function hn(e){let t;const r=[e[9]];let i={};for(let e=0;e<r.length;e+=1)i=n(i,r[e]);const o=new sn({props:i});return{c(){Ce(o.$$.fragment)},m(e,n){Ae(o,e,n),t=!0},p(e,t){const n=1&t?Ee(r,[Se(e[9])]):{};o.$set(n)},i(e){t||(de(o.$$.fragment,e),t=!0)},o(e){me(o.$$.fragment,e),t=!1},d(e){De(o,e)}}}function fn(e){let t,n,r,i=e[6],o=[];for(let t=0;t<i.length;t+=1)o[t]=hn(un(e,i,t));const a=e=>me(o[e],1,1,()=>{o[e]=null});return{c(){t=S("div");for(let e=0;e<o.length;e+=1)o[e].c();n=A(),x(t,"class","sponsor-category svelte-jpshmx")},m(e,i){w(e,t,i);for(let e=0;e<o.length;e+=1)o[e].m(t,null);b(t,n),r=!0},p(e,r){if(1&r){let s;for(i=e[6],s=0;s<i.length;s+=1){const a=un(e,i,s);o[s]?(o[s].p(a,r),de(o[s],1)):(o[s]=hn(a),o[s].c(),de(o[s],1),o[s].m(t,n))}for(fe(),s=i.length;s<o.length;s+=1)a(s);pe()}},i(e){if(!r){for(let e=0;e<i.length;e+=1)de(o[e]);r=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)me(o[e]);r=!1},d(e){e&&T(t),E(o,e)}}}function pn(e){let t,n,r;const i=new jt({props:{textContent:{header:e[1]+" PARTNERS"}}});let o=Object.entries(e[2]),a=[];for(let t=0;t<o.length;t+=1)a[t]=fn(cn(e,o,t));const s=e=>me(a[e],1,1,()=>{a[e]=null});return{c(){Ce(i.$$.fragment),t=A();for(let e=0;e<a.length;e+=1)a[e].c();n=D()},m(e,o){Ae(i,e,o),w(e,t,o);for(let t=0;t<a.length;t+=1)a[t].m(e,o);w(e,n,o),r=!0},p(e,t){if(1&t){let r;for(o=Object.entries(e[2]),r=0;r<o.length;r+=1){const i=cn(e,o,r);a[r]?(a[r].p(i,t),de(a[r],1)):(a[r]=fn(i),a[r].c(),de(a[r],1),a[r].m(n.parentNode,n))}for(fe(),r=o.length;r<a.length;r+=1)s(r);pe()}},i(e){if(!r){de(i.$$.fragment,e);for(let e=0;e<o.length;e+=1)de(a[e]);r=!0}},o(e){me(i.$$.fragment,e),a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)me(a[e]);r=!1},d(e){De(i,e),e&&T(t),E(a,e),e&&T(n)}}}function dn(e){let t,n,r=Object.entries(e[0]).sort(mn),i=[];for(let t=0;t<r.length;t+=1)i[t]=pn(ln(e,r,t));const o=e=>me(i[e],1,1,()=>{i[e]=null});return{c(){t=S("section");for(let e=0;e<i.length;e+=1)i[e].c();x(t,"id","sponsors"),x(t,"class","svelte-jpshmx")},m(e,r){w(e,t,r);for(let e=0;e<i.length;e+=1)i[e].m(t,null);n=!0},p(e,[n]){if(1&n){let a;for(r=Object.entries(e[0]).sort(mn),a=0;a<r.length;a+=1){const o=ln(e,r,a);i[a]?(i[a].p(o,n),de(i[a],1)):(i[a]=pn(o),i[a].c(),de(i[a],1),i[a].m(t,null))}for(fe(),a=r.length;a<i.length;a+=1)o(a);pe()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)de(i[e]);n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)me(i[e]);n=!1},d(e){e&&T(t),E(i,e)}}}const mn=(e,t)=>e>t?-1:e<t?1:0;function gn(e){return[{2019:{1:[{sponsorImage:"../images/sponsors/19/Official%20Partner.png",sponsorRole:"Official Partner"}],2:[{sponsorImage:"../images/sponsors/19/Hosting%20Partner.png",sponsorRole:"Hosting Partner"},{sponsorImage:"../images/sponsors/19/Strategic%20Partner.png",sponsorRole:"Strategic Partner"},{sponsorImage:"../images/sponsors/19/Catering%20Sponsor.png",sponsorRole:"Catering Sponsor"},{sponsorImage:"../images/sponsors/19/Transportation%20Partner.png",sponsorRole:"Transportation Partner"}],3:[{sponsorImage:"../images/sponsors/19/Content%20Partner.png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/19/Content%20Partner(2).png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/19/Content%20Partner(1).png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/19/Content%20Partner(3).png",sponsorRole:"Content Partner"}],4:[{sponsorImage:"../images/sponsors/19/Startup%20Partner.png",sponsorRole:"Startup Partner"},{sponsorImage:"../images/sponsors/19/Startup%20Partner(1).png",sponsorRole:"Startup Partner"}]},2018:{1:[{sponsorImage:"../images/sponsors/19/Official%20Partner.png",sponsorRole:"Official Partner"}],2:[{sponsorImage:"../images/sponsors/18/Gold%20Sponsor.png",sponsorRole:"Gold Sponsor"},{sponsorImage:"../images/sponsors/18/Community%20Partner.png",sponsorRole:"Community Partner"},{sponsorImage:"../images/sponsors/18/Strategic%20Partner.png",sponsorRole:"Strategic Sponsor"},{sponsorImage:"../images/sponsors/18/Gold%20Sponsor(1).png",sponsorRole:"Gold Partner"}],3:[{sponsorImage:"../images/sponsors/18/Content%20Partner(2).png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/18/Content%20Partner.png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/18/Content%20Partner(3).png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/18/Content%20Partner(1).png",sponsorRole:"Content Partner"}]},2017:{1:[{sponsorImage:"../images/sponsors/17/Main%20Sponsor.png",sponsorRole:"Main Partner"}],2:[{sponsorImage:"../images/sponsors/17/Content%20Partner(2).png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/17/Content%20Partner(3).png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/17/Content%20Partner.png",sponsorRole:"Content Partner"},{sponsorImage:"../images/sponsors/17/Content%20Partner(1).png",sponsorRole:"Content Partner"}]}}]}class yn extends _e{constructor(e){super(),ke(this,e,gn,dn,s,{})}}function vn(t){let n;return{c(){n=S("section"),n.innerHTML='<div class="svelte-yuxxwn"><img src="../images/MUTEX%20White.png" alt="" style="width: 170px;height: auto" class="svelte-yuxxwn"> \n    <p class="svelte-yuxxwn">Website crafted by IEEE Zagazig CS.</p></div> \n  <div class="svelte-yuxxwn"><div class="svelte-yuxxwn"><span class="svelte-yuxxwn"><a class="facebook svelte-yuxxwn" href="https://www.facebook.com/MUTEX.Summit/"><span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="svelte-yuxxwn"><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06\n              52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08\n              44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg></a></span> \n      <span class="svelte-yuxxwn"><a class="twitter svelte-yuxxwn" href="https://twitter.com/MutexSummit"><span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svelte-yuxxwn"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0\n              138.72-105.583 298.558-298.558 298.558-59.452\n              0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299\n              49.055 0 94.213-16.568\n              130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974\n              12.995 1.624 19.818 1.624 9.421 0 18.843-1.3\n              27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969\n              7.797 30.214 12.67 47.431\n              13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492\n              5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365\n              109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828\n              46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137\n              23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366\n              44.833-46.132 57.827 21.117-2.273 41.584-8.122\n              60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></span> \n      <span class="svelte-yuxxwn"><a class="instagram svelte-yuxxwn" href="https://www.instagram.com/mutex.summit/"><span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svelte-yuxxwn"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9\n              114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1\n              0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6\n              74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9\n              0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1\n              27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9\n              0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9\n              0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9\n              2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58\n              36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9\n              34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7\n              2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7\n              9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9\n              132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9\n              99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a></span> \n      <span class="svelte-yuxxwn"><a class="linked-in svelte-yuxxwn" href="https://www.linkedin.com/company/mutexsummit/"><span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <span class="svelte-yuxxwn"></span> \n          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="svelte-yuxxwn"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762\n              0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11\n              19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764\n              1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5\n              12.268h-3v-5.604c0-3.368-4-3.113-4\n              0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a></span></div></div>',x(n,"id","footer"),x(n,"class","svelte-yuxxwn")},m(e,t){w(e,n,t)},p:e,i:e,o:e,d(e){e&&T(n)}}}class bn extends _e{constructor(e){super(),ke(this,e,null,vn,s,{})}}function wn(n){let r,i,s,u,c,l,h,f,p,m;const g=new Lt({}),y=new zt({}),E=new Gt({}),I=new Ht({}),C=new rn({}),D=new yn({}),N=new bn({});return{c(){r=S("div"),Ce(g.$$.fragment),i=A(),Ce(y.$$.fragment),s=A(),Ce(E.$$.fragment),u=A(),Ce(I.$$.fragment),c=A(),Ce(C.$$.fragment),l=A(),Ce(D.$$.fragment),h=A(),Ce(N.$$.fragment)},m(e,t){w(e,r,t),Ae(g,r,null),b(r,i),Ae(y,r,null),b(r,s),Ae(E,r,null),b(r,u),Ae(I,r,null),b(r,c),Ae(C,r,null),b(r,l),Ae(D,r,null),b(r,h),Ae(N,r,null),m=!0},p:e,i(n){m||(de(g.$$.fragment,n),de(y.$$.fragment,n),de(E.$$.fragment,n),de(I.$$.fragment,n),de(C.$$.fragment,n),de(D.$$.fragment,n),de(N.$$.fragment,n),ne(()=>{p&&p.end(1),f||(f=function(n,r,i){let o,s,u=r(n,i),c=!1,l=0;function h(){o&&j(n,o)}function f(){const{delay:r=0,duration:i=300,easing:a=t,tick:f=e,css:p}=u||ge;p&&(o=U(n,0,1,i,r,a,p,l++)),f(0,1);const m=d()+r,g=m+i;s&&s.abort(),c=!0,ne(()=>ce(n,!0,"start")),s=v(e=>{if(c){if(e>=g)return f(1,0),ce(n,!0,"end"),h(),c=!1;if(e>=m){const t=a((e-m)/i);f(t,1-t)}}return c})}let p=!1;return{start(){p||(j(n),a(u)?(u=u(),ue().then(f)):f())},invalidate(){p=!1},end(){c&&(h(),c=!1)}}}(r,at,{duration:500})),f.start()}),m=!0)},o(n){me(g.$$.fragment,n),me(y.$$.fragment,n),me(E.$$.fragment,n),me(I.$$.fragment,n),me(C.$$.fragment,n),me(D.$$.fragment,n),me(N.$$.fragment,n),f&&f.invalidate(),p=function(n,r,i){let s,u=r(n,i),c=!0;const l=he;function h(){const{delay:r=0,duration:i=300,easing:a=t,tick:h=e,css:f}=u||ge;f&&(s=U(n,1,0,i,r,a,f));const p=d()+r,m=p+i;ne(()=>ce(n,!1,"start")),v(e=>{if(c){if(e>=m)return h(0,1),ce(n,!1,"end"),--l.r||o(l.c),!1;if(e>=p){const t=a((e-p)/i);h(1-t,t)}}return c})}return l.r+=1,a(u)?ue().then(()=>{u=u(),h()}):h(),{end(e){e&&u.tick&&u.tick(1,0),c&&(s&&j(n,s),c=!1)}}}(r,at,{duration:200}),m=!1},d(e){e&&T(r),De(g),De(y),De(E),De(I),De(C),De(D),De(N),e&&p&&p.end()}}}class Tn extends _e{constructor(e){super(),ke(this,e,null,wn,s,{})}}
/*!
    Waypoints - 4.0.1
    Copyright © 2011-2016 Caleb Troughton
    Licensed under the MIT license.
    https://github.com/imakewebthings/waypoints/blob/master/licenses.txt
    */!function(){function e(r){if(!r)throw new Error("No options passed to Waypoint constructor");if(!r.element)throw new Error("No element option passed to Waypoint constructor");if(!r.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+t,this.options=e.Adapter.extend({},e.defaults,r),this.element=this.options.element,this.adapter=new e.Adapter(this.element),this.callback=r.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=e.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=e.Context.findOrCreateByElement(this.options.context),e.offsetAliases[this.options.offset]&&(this.options.offset=e.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),n[this.key]=this,t+=1}var t=0,n={};e.prototype.queueTrigger=function(e){this.group.queueTrigger(this,e)},e.prototype.trigger=function(e){this.enabled&&this.callback&&this.callback.apply(this,e)},e.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete n[this.key]},e.prototype.disable=function(){return this.enabled=!1,this},e.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},e.prototype.next=function(){return this.group.next(this)},e.prototype.previous=function(){return this.group.previous(this)},e.invokeAll=function(e){var t=[];for(var r in n)t.push(n[r]);for(var i=0,o=t.length;o>i;i++)t[i][e]()},e.destroyAll=function(){e.invokeAll("destroy")},e.disableAll=function(){e.invokeAll("disable")},e.enableAll=function(){for(var t in e.Context.refreshAll(),n)n[t].enabled=!0;return this},e.refreshAll=function(){e.Context.refreshAll()},e.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},e.viewportWidth=function(){return document.documentElement.clientWidth},e.adapters=[],e.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},e.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=e}(),function(){function e(e){window.setTimeout(e,1e3/60)}function t(e){this.element=e,this.Adapter=i.Adapter,this.adapter=new this.Adapter(e),this.key="waypoint-context-"+n,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},e.waypointContextKey=this.key,r[e.waypointContextKey]=this,n+=1,i.windowContext||(i.windowContext=!0,i.windowContext=new t(window)),this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var n=0,r={},i=window.Waypoint,o=window.onload;t.prototype.add=function(e){var t=e.options.horizontal?"horizontal":"vertical";this.waypoints[t][e.key]=e,this.refresh()},t.prototype.checkEmpty=function(){var e=this.Adapter.isEmptyObject(this.waypoints.horizontal),t=this.Adapter.isEmptyObject(this.waypoints.vertical),n=this.element==this.element.window;e&&t&&!n&&(this.adapter.off(".waypoints"),delete r[this.key])},t.prototype.createThrottledResizeHandler=function(){function e(){t.handleResize(),t.didResize=!1}var t=this;this.adapter.on("resize.waypoints",(function(){t.didResize||(t.didResize=!0,i.requestAnimationFrame(e))}))},t.prototype.createThrottledScrollHandler=function(){function e(){t.handleScroll(),t.didScroll=!1}var t=this;this.adapter.on("scroll.waypoints",(function(){(!t.didScroll||i.isTouch)&&(t.didScroll=!0,i.requestAnimationFrame(e))}))},t.prototype.handleResize=function(){i.Context.refreshAll()},t.prototype.handleScroll=function(){var e={},t={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var n in t){var r=t[n],i=r.newScroll>r.oldScroll?r.forward:r.backward;for(var o in this.waypoints[n]){var a=this.waypoints[n][o];if(null!==a.triggerPoint){var s=r.oldScroll<a.triggerPoint,u=r.newScroll>=a.triggerPoint;(s&&u||!s&&!u)&&(a.queueTrigger(i),e[a.group.id]=a.group)}}}for(var c in e)e[c].flushTriggers();this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}},t.prototype.innerHeight=function(){return this.element==this.element.window?i.viewportHeight():this.adapter.innerHeight()},t.prototype.remove=function(e){delete this.waypoints[e.axis][e.key],this.checkEmpty()},t.prototype.innerWidth=function(){return this.element==this.element.window?i.viewportWidth():this.adapter.innerWidth()},t.prototype.destroy=function(){var e=[];for(var t in this.waypoints)for(var n in this.waypoints[t])e.push(this.waypoints[t][n]);for(var r=0,i=e.length;i>r;r++)e[r].destroy()},t.prototype.refresh=function(){var e,t=this.element==this.element.window,n=t?void 0:this.adapter.offset(),r={};for(var o in this.handleScroll(),e={horizontal:{contextOffset:t?0:n.left,contextScroll:t?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:t?0:n.top,contextScroll:t?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}}){var a=e[o];for(var s in this.waypoints[o]){var u,c,l,h,f=this.waypoints[o][s],p=f.options.offset,d=f.triggerPoint,m=0,g=null==d;f.element!==f.element.window&&(m=f.adapter.offset()[a.offsetProp]),"function"==typeof p?p=p.apply(f):"string"==typeof p&&(p=parseFloat(p),f.options.offset.indexOf("%")>-1&&(p=Math.ceil(a.contextDimension*p/100))),u=a.contextScroll-a.contextOffset,f.triggerPoint=Math.floor(m+u-p),c=d<a.oldScroll,l=f.triggerPoint>=a.oldScroll,h=!c&&!l,!g&&(c&&l)?(f.queueTrigger(a.backward),r[f.group.id]=f.group):!g&&h?(f.queueTrigger(a.forward),r[f.group.id]=f.group):g&&a.oldScroll>=f.triggerPoint&&(f.queueTrigger(a.forward),r[f.group.id]=f.group)}}return i.requestAnimationFrame((function(){for(var e in r)r[e].flushTriggers()})),this},t.findOrCreateByElement=function(e){return t.findByElement(e)||new t(e)},t.refreshAll=function(){for(var e in r)r[e].refresh()},t.findByElement=function(e){return r[e.waypointContextKey]},window.onload=function(){o&&o(),t.refreshAll()},i.requestAnimationFrame=function(t){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||e).call(window,t)},i.Context=t}(),function(){function e(e,t){return e.triggerPoint-t.triggerPoint}function t(e,t){return t.triggerPoint-e.triggerPoint}function n(e){this.name=e.name,this.axis=e.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),r[this.axis][this.name]=this}var r={vertical:{},horizontal:{}},i=window.Waypoint;n.prototype.add=function(e){this.waypoints.push(e)},n.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},n.prototype.flushTriggers=function(){for(var n in this.triggerQueues){var r=this.triggerQueues[n],i="up"===n||"left"===n;r.sort(i?t:e);for(var o=0,a=r.length;a>o;o+=1){var s=r[o];(s.options.continuous||o===r.length-1)&&s.trigger([n])}}this.clearTriggerQueues()},n.prototype.next=function(t){this.waypoints.sort(e);var n=i.Adapter.inArray(t,this.waypoints);return n===this.waypoints.length-1?null:this.waypoints[n+1]},n.prototype.previous=function(t){this.waypoints.sort(e);var n=i.Adapter.inArray(t,this.waypoints);return n?this.waypoints[n-1]:null},n.prototype.queueTrigger=function(e,t){this.triggerQueues[t].push(e)},n.prototype.remove=function(e){var t=i.Adapter.inArray(e,this.waypoints);t>-1&&this.waypoints.splice(t,1)},n.prototype.first=function(){return this.waypoints[0]},n.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},n.findOrCreate=function(e){return r[e.axis][e.name]||new n(e)},i.Group=n}(),function(){function e(e){return e===e.window}function t(t){return e(t)?t:t.defaultView}function n(e){this.element=e,this.handlers={}}var r=window.Waypoint;n.prototype.innerHeight=function(){return e(this.element)?this.element.innerHeight:this.element.clientHeight},n.prototype.innerWidth=function(){return e(this.element)?this.element.innerWidth:this.element.clientWidth},n.prototype.off=function(e,t){function n(e,t,n){for(var r=0,i=t.length-1;i>r;r++){var o=t[r];n&&n!==o||e.removeEventListener(o)}}var r=e.split("."),i=r[0],o=r[1],a=this.element;if(o&&this.handlers[o]&&i)n(a,this.handlers[o][i],t),this.handlers[o][i]=[];else if(i)for(var s in this.handlers)n(a,this.handlers[s][i]||[],t),this.handlers[s][i]=[];else if(o&&this.handlers[o]){for(var u in this.handlers[o])n(a,this.handlers[o][u],t);this.handlers[o]={}}},n.prototype.offset=function(){if(!this.element.ownerDocument)return null;var e=this.element.ownerDocument.documentElement,n=t(this.element.ownerDocument),r={top:0,left:0};return this.element.getBoundingClientRect&&(r=this.element.getBoundingClientRect()),{top:r.top+n.pageYOffset-e.clientTop,left:r.left+n.pageXOffset-e.clientLeft}},n.prototype.on=function(e,t){var n=e.split("."),r=n[0],i=n[1]||"__default",o=this.handlers[i]=this.handlers[i]||{};(o[r]=o[r]||[]).push(t),this.element.addEventListener(r,t)},n.prototype.outerHeight=function(t){var n,r=this.innerHeight();return t&&!e(this.element)&&(n=window.getComputedStyle(this.element),r+=parseInt(n.marginTop,10),r+=parseInt(n.marginBottom,10)),r},n.prototype.outerWidth=function(t){var n,r=this.innerWidth();return t&&!e(this.element)&&(n=window.getComputedStyle(this.element),r+=parseInt(n.marginLeft,10),r+=parseInt(n.marginRight,10)),r},n.prototype.scrollLeft=function(){var e=t(this.element);return e?e.pageXOffset:this.element.scrollLeft},n.prototype.scrollTop=function(){var e=t(this.element);return e?e.pageYOffset:this.element.scrollTop},n.extend=function(){function e(e,t){if("object"==typeof e&&"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}for(var t=Array.prototype.slice.call(arguments),n=1,r=t.length;r>n;n++)e(t[0],t[n]);return t[0]},n.inArray=function(e,t,n){return null==t?-1:t.indexOf(e,n)},n.isEmptyObject=function(e){for(var t in e)return!1;return!0},r.adapters.push({name:"noframework",Adapter:n}),r.Adapter=n}();const En=function(e){e.length>0&&e.forEach((function(e,t){setTimeout((function(){e.classList.add("fadeInUp")}),200*t,"easeInOutExpo")}))},Sn=function(e){let t=e.items;t.length>0&&t.forEach((n,r)=>{n.classList.add("animated");new Waypoint({element:n,handler:r=>{"down"===r&&n.classList.contains("animated")&&setTimeout(En,200,"single"===e.type?[n]:t)},offset:"95%"})})};function In(e){let t;return{c(){t=S("h2"),t.textContent="General",x(t,"class","heading svelte-zka2ua")},m(e,n){w(e,t,n)},d(e){e&&T(t)}}}function Cn(e){let t,n,r,i=e[0]&&In();const o=e[2].default,a=l(o,e,e[1],null);return{c(){t=S("div"),i&&i.c(),n=A(),a&&a.c(),x(t,"class","form-group svelte-zka2ua")},m(e,o){w(e,t,o),i&&i.m(t,null),b(t,n),a&&a.m(t,null),r=!0},p(e,[r]){e[0]?i||(i=In(),i.c(),i.m(t,n)):i&&(i.d(1),i=null),a&&a.p&&2&r&&a.p(h(o,e,e[1],null),f(o,e[1],r,null))},i(e){r||(de(a,e),r=!0)},o(e){me(a,e),r=!1},d(e){e&&T(t),i&&i.d(),a&&a.d(e)}}}function An(e,t,n){let{heading:r}=t,{$$slots:i={},$$scope:o}=t;return e.$set=e=>{"heading"in e&&n(0,r=e.heading),"$$scope"in e&&n(1,o=e.$$scope)},[r,o,i]}document.addEventListener("DOMContentLoaded",(function(){[{type:"single",items:[...document.querySelectorAll("div.underline-heading ")]},{type:"group",items:[...document.querySelectorAll("#aboutSection > div#container > div")]},{type:"group",items:[...document.querySelectorAll("#lpnp > div#container > div")]},{type:"group",items:[...document.querySelectorAll("#STATISTICS > div#container > div")]},{type:"single",items:[...document.querySelectorAll("#speakers > div.container > div")]},{type:"single",items:[...document.querySelectorAll("#sponsors > div.sponsor-category")]}].forEach(e=>{Sn(e)})}),!1);class Dn extends _e{constructor(e){super(),ke(this,e,An,Cn,s,{heading:0})}}function Nn(t){let n,r,i,a,s,u;return{c(){n=S("div"),r=S("input"),i=A(),a=S("label"),s=C(t[1]),x(r,"type","email"),x(r,"id",t[1]),x(r,"class","floatLabel svelte-540n9y"),x(r,"name",t[1]),x(a,"for",t[1]),x(a,"class","svelte-540n9y"),L(a,"active",t[2]),x(n,"class","controls svelte-540n9y")},m(e,o){w(e,n,o),b(n,r),t[6](r),M(r,t[0]),b(n,i),b(n,a),b(a,s),u=[N(r,"focus",t[4]),N(r,"blur",t[5]),N(r,"input",t[7])]},p(e,[t]){2&t&&x(r,"id",e[1]),2&t&&x(r,"name",e[1]),1&t&&r.value!==e[0]&&M(r,e[0]),2&t&&R(s,e[1]),2&t&&x(a,"for",e[1]),4&t&&L(a,"active",e[2])},i:e,o:e,d(e){e&&T(n),t[6](null),o(u)}}}function kn(e,t,n){let r,i,{Name:o}=t,{value:a}=t;K(()=>{n(2,r=""!==a&&void 0!==a)});return e.$set=e=>{"Name"in e&&n(1,o=e.Name),"value"in e&&n(0,a=e.value)},[a,o,r,i,e=>{n(2,r=!0)},e=>{""===i.value&&n(2,r=!1)},function(e){X[e?"unshift":"push"](()=>{n(3,i=e)})},function(){a=this.value,n(0,a)}]}class _n extends _e{constructor(e){super(),ke(this,e,kn,Nn,s,{Name:1,value:0})}}function xn(e){let t,n;return{c(){t=S("p"),n=C(e[2]),x(t,"class","textAreaLabel svelte-nt8hlu"),x(t,"for","")},m(e,r){w(e,t,r),b(t,n)},p(e,t){4&t&&R(n,e[2])},d(e){e&&T(t)}}}function Rn(t){let n,r,i,a,s,u,c,l=t[2]&&xn(t);return{c(){l&&l.c(),n=A(),r=S("div"),i=S("input"),a=A(),s=S("label"),u=C(t[1]),x(i,"type","text"),x(i,"id",t[1]),x(i,"class","floatLabel svelte-nt8hlu"),x(i,"name",t[1]),x(s,"class"," svelte-nt8hlu"),x(s,"for",t[1]),L(s,"active",t[3]),L(s,"truncate",t[3]),x(r,"class","controls svelte-nt8hlu")},m(e,o){l&&l.m(e,o),w(e,n,o),w(e,r,o),b(r,i),t[7](i),M(i,t[0]),b(r,a),b(r,s),b(s,u),c=[N(i,"focus",t[5]),N(i,"blur",t[6]),N(i,"input",t[8])]},p(e,[t]){e[2]?l?l.p(e,t):(l=xn(e),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),2&t&&x(i,"id",e[1]),2&t&&x(i,"name",e[1]),1&t&&i.value!==e[0]&&M(i,e[0]),2&t&&R(u,e[1]),2&t&&x(s,"for",e[1]),8&t&&L(s,"active",e[3]),8&t&&L(s,"truncate",e[3])},i:e,o:e,d(e){l&&l.d(e),e&&T(n),e&&T(r),t[7](null),o(c)}}}function Mn(e,t,n){let r,i,{Name:o}=t,{value:a}=t,{label:s}=t;K(()=>{n(3,r=""!==a&&void 0!==a)});return e.$set=e=>{"Name"in e&&n(1,o=e.Name),"value"in e&&n(0,a=e.value),"label"in e&&n(2,s=e.label)},[a,o,s,r,i,e=>{n(3,r=!0)},e=>{""===i.value&&n(3,r=!1)},function(e){X[e?"unshift":"push"](()=>{n(4,i=e)})},function(){a=this.value,n(0,a)}]}class On extends _e{constructor(e){super(),ke(this,e,Mn,Rn,s,{Name:1,value:0,label:2})}}const Pn=["January","February","March","April","May","June","July","August","September","October","November","December"],Ln=[31,28,31,30,31,30,31,31,30,31,30,31],Fn=(e,t)=>1!==e?Ln[e]:(e=>e%4==0)(t)?29:28,Bn=e=>Pn[e],qn=(e,t)=>{const{days:n}=((e,t)=>{const n=new Date(t,e,1).getMonth();return{name:n[n],days:Fn(n,t)}})(e,t),r=Array.from({length:42}).map(()=>[]),i=new Date(t,e,1).getDay();Array.from({length:n}).forEach((e,t)=>{r[i+t]=t+1});const o=r.map(e=>Array.isArray(e)?void 0:e);return o[35]?o:o.slice(0,-7)},Vn=()=>{},$n=(()=>{let e=1;return()=>++e})();function Un(e,t,n){const r=e.slice();return r[9]=t[n].allowed,r[10]=t[n].value,r}function jn(e,t,n){const r=e.slice();return r[13]=t[n],r}function Wn(t){let n,r,i=t[13]+"";return{c(){n=S("div"),r=C(i),x(n,"class","cell svelte-1xnygc9")},m(e,t){w(e,n,t),b(n,r)},p:e,d(e){e&&T(n)}}}function zn(e,t){let n,r,i,o,s=(t[10]||"")+"";return{key:e,first:null,c(){n=S("div"),r=C(s),i=A(),x(n,"class","svelte-1xnygc9"),L(n,"cell",!0),L(n,"highlight",t[9]&&t[10]),L(n,"disabled",!t[9]),L(n,"selected",new Date(t[0].getFullYear(),t[0].getMonth(),t[0].getDate()).getTime()===new Date(t[2],t[1],t[10]).getTime()),this.first=n},m(e,s){w(e,n,s),b(n,r),b(n,i),o=N(n,"click",(function(){a(t[9]&&t[10]?t[5].bind(this,t[10]):Vn)&&(t[9]&&t[10]?t[5].bind(this,t[10]):Vn).apply(this,arguments)}))},p(e,i){t=e,8&i&&s!==(s=(t[10]||"")+"")&&R(r,s),8&i&&L(n,"highlight",t[9]&&t[10]),8&i&&L(n,"disabled",!t[9]),15&i&&L(n,"selected",new Date(t[0].getFullYear(),t[0].getMonth(),t[0].getDate()).getTime()===new Date(t[2],t[1],t[10]).getTime())},d(e){e&&T(n),o()}}}function Kn(t){let n,r,i,o,a=[],s=new Map,u=t[4],c=[];for(let e=0;e<u.length;e+=1)c[e]=Wn(jn(t,u,e));let l=t[3];const h=e=>$n();for(let e=0;e<l.length;e+=1){let n=Un(t,l,e),r=h();s.set(r,a[e]=zn(r,n))}return{c(){n=S("div"),r=S("div");for(let e=0;e<c.length;e+=1)c[e].c();i=A(),o=S("div");for(let e=0;e<a.length;e+=1)a[e].c();x(r,"class","row svelte-1xnygc9"),x(o,"class","row svelte-1xnygc9"),x(n,"class","container svelte-1xnygc9")},m(e,t){w(e,n,t),b(n,r);for(let e=0;e<c.length;e+=1)c[e].m(r,null);b(n,i),b(n,o);for(let e=0;e<a.length;e+=1)a[e].m(o,null)},p(e,[t]){if(16&t){let n;for(u=e[4],n=0;n<u.length;n+=1){const i=jn(e,u,n);c[n]?c[n].p(i,t):(c[n]=Wn(i),c[n].c(),c[n].m(r,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=u.length}const n=e[3];a=Te(a,t,h,1,e,n,s,o,be,zn,null,Un)},i:e,o:e,d(e){e&&T(n),E(c,e);for(let e=0;e<a.length;e+=1)a[e].d()}}}function Gn(e,t,n){const r=Q();let{date:i}=t,{month:o}=t,{year:a}=t,{isAllowed:s}=t;let u;const c=(e,t,n)=>!n||s(new Date(e,t,n));return e.$set=e=>{"date"in e&&n(0,i=e.date),"month"in e&&n(1,o=e.month),"year"in e&&n(2,a=e.year),"isAllowed"in e&&n(6,s=e.isAllowed)},e.$$.update=()=>{6&e.$$.dirty&&n(3,u=qn(o,a).map(e=>({value:e,allowed:c(a,o,e)})))},[i,o,a,u,["Su","Mo","Tu","We","Th","Fr","Sa"],e=>{r("datechange",new Date(a,o,e))},s]}class Qn extends _e{constructor(e){super(),ke(this,e,Gn,Kn,s,{date:0,month:1,year:2,isAllowed:6})}}function Hn(e){let t;const n=new lt({props:{$$slots:{default:[Yn]},$$scope:{ctx:e}}});return n.$on("close",e[10]),{c(){Ce(n.$$.fragment)},m(e,r){Ae(n,e,r),t=!0},p(e,t){const r={};16399&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){t||(de(n.$$.fragment,e),t=!0)},o(e){me(n.$$.fragment,e),t=!1},d(e){De(n,e)}}}function Yn(e){let t,n,r,i,a,s,u,c,l,h,f,p,d,m,g,y=Bn(e[2])+"";const v=new Qn({props:{month:e[2],year:e[3],date:e[1],isAllowed:e[0]}});return v.$on("datechange",e[9]),{c(){t=S("div"),n=S("div"),r=S("div"),i=S("button"),i.textContent="Prev",a=A(),s=S("div"),u=C(y),c=A(),l=C(e[3]),h=A(),f=S("div"),p=S("button"),p.textContent="Next",d=A(),Ce(v.$$.fragment),x(r,"class","center svelte-uj0r83"),x(s,"class","center svelte-uj0r83"),x(f,"class","center svelte-uj0r83"),x(n,"class","month-name svelte-uj0r83"),x(t,"class","box svelte-uj0r83")},m(o,y){w(o,t,y),b(t,n),b(n,r),b(r,i),b(n,a),b(n,s),b(s,u),b(s,c),b(s,l),b(n,h),b(n,f),b(f,p),b(t,d),Ae(v,t,null),m=!0,g=[N(i,"click",k(e[8])),N(p,"click",k(e[7]))]},p(e,t){(!m||4&t)&&y!==(y=Bn(e[2])+"")&&R(u,y),(!m||8&t)&&R(l,e[3]);const n={};4&t&&(n.month=e[2]),8&t&&(n.year=e[3]),2&t&&(n.date=e[1]),1&t&&(n.isAllowed=e[0]),v.$set(n)},i(e){m||(de(v.$$.fragment,e),m=!0)},o(e){me(v.$$.fragment,e),m=!1},d(e){e&&T(t),De(v),o(g)}}}function Xn(e){let t,n,r,i,o,a,s,u,c=e[4]&&e[5]&&Hn(e);return{c(){t=S("div"),n=S("label"),n.textContent="Foundation Date:",r=A(),i=S("input"),a=A(),c&&c.c(),x(n,"for",""),x(i,"type","text"),i.value=o=e[1].toDateString(),x(i,"class","svelte-uj0r83"),x(t,"class","relative svelte-uj0r83")},m(o,l){w(o,t,l),b(t,n),b(t,r),b(t,i),b(t,a),c&&c.m(t,null),s=!0,u=N(i,"click",e[6])},p(e,[n]){(!s||2&n&&o!==(o=e[1].toDateString())&&i.value!==o)&&(i.value=o),e[4]&&e[5]?c?(c.p(e,n),de(c,1)):(c=Hn(e),c.c(),de(c,1),c.m(t,null)):c&&(fe(),me(c,1,1,()=>{c=null}),pe())},i(e){s||(de(c),s=!0)},o(e){me(c),s=!1},d(e){e&&T(t),c&&c.d(),u()}}}function Jn(e,t,n){const r=Q();let i,o,a,s,u,{isAllowed:c=(()=>!0)}=t,{selected:l=new Date}=t;return e.$set=e=>{"isAllowed"in e&&n(0,c=e.isAllowed),"selected"in e&&n(1,l=e.selected)},e.$$.update=()=>{2&e.$$.dirty&&(i=l.getDate(),n(2,o=l.getMonth()),n(3,a=l.getFullYear()))},[c,l,o,a,s,u,()=>{n(4,s=!0),n(5,u=!0)},()=>{if(11===o)return n(2,o=0),void n(3,a+=1);n(2,o+=1)},()=>{if(0===o)return n(2,o=11),void n(3,a-=1);n(2,o-=1)},e=>{n(4,s=!1),r("datechange",e.detail)},()=>{n(5,u=!u)}]}class Zn extends _e{constructor(e){super(),ke(this,e,Jn,Xn,s,{isAllowed:0,selected:1})}}function er(e){let t,n;return{c(){t=S("p"),n=C(e[2]),x(t,"class","textAreaLabel svelte-15bjk33"),x(t,"for","")},m(e,r){w(e,t,r),b(t,n)},p(e,t){4&t&&R(n,e[2])},d(e){e&&T(t)}}}function tr(t){let n,r,i,a,s,u,c,l=t[2]&&er(t);return{c(){l&&l.c(),n=A(),r=S("div"),i=S("textarea"),a=A(),s=S("label"),u=C(t[1]),x(i,"name",t[1]),x(i,"class","floatLabel svelte-15bjk33"),x(i,"id",t[1]),x(i,"rows","4"),x(s,"for",t[1]),x(s,"class","svelte-15bjk33"),L(s,"active",t[3]),L(s,"truncate",t[3]),x(r,"class","controls svelte-15bjk33")},m(e,o){l&&l.m(e,o),w(e,n,o),w(e,r,o),b(r,i),t[7](i),M(i,t[0]),b(r,a),b(r,s),b(s,u),c=[N(i,"focus",t[5]),N(i,"blur",t[6]),N(i,"input",t[8])]},p(e,[t]){e[2]?l?l.p(e,t):(l=er(e),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),2&t&&x(i,"name",e[1]),2&t&&x(i,"id",e[1]),1&t&&M(i,e[0]),2&t&&R(u,e[1]),2&t&&x(s,"for",e[1]),8&t&&L(s,"active",e[3]),8&t&&L(s,"truncate",e[3])},i:e,o:e,d(e){l&&l.d(e),e&&T(n),e&&T(r),t[7](null),o(c)}}}function nr(e,t,n){let r,i,{Name:o}=t,{value:a}=t,{label:s}=t;K(()=>{n(3,r=""!==a&&void 0!==a)});return e.$set=e=>{"Name"in e&&n(1,o=e.Name),"value"in e&&n(0,a=e.value),"label"in e&&n(2,s=e.label)},[a,o,s,r,i,e=>{n(3,r=!0)},e=>{""===i.value&&n(3,r=!1)},function(e){X[e?"unshift":"push"](()=>{n(4,i=e)})},function(){a=this.value,n(0,a)}]}class rr extends _e{constructor(e){super(),ke(this,e,nr,tr,s,{Name:1,value:0,label:2})}}function ir(e,t,n){const r=e.slice();return r[5]=t[n],r}function or(e){let t,n,r,i,o,a,s,u=e[5]+"";return{c(){t=S("label"),n=S("input"),i=A(),o=C(u),a=A(),x(n,"type","radio"),x(n,"name",e[2]),n.__value=r=e[5],n.value=n.__value,e[4][0].push(n),x(t,"class","radiolabel svelte-2jmqa0")},m(r,u){w(r,t,u),b(t,n),n.checked=n.__value===e[0],b(t,i),b(t,o),b(t,a),s=N(n,"change",e[3])},p(e,t){4&t&&x(n,"name",e[2]),2&t&&r!==(r=e[5])&&(n.__value=r),n.value=n.__value,1&t&&(n.checked=n.__value===e[0]),2&t&&u!==(u=e[5]+"")&&R(o,u)},d(r){r&&T(t),e[4][0].splice(e[4][0].indexOf(n),1),s()}}}function ar(t){let n,r,i,o,a=t[1],s=[];for(let e=0;e<a.length;e+=1)s[e]=or(ir(t,a,e));return{c(){n=S("div"),r=S("p"),i=C(t[2]),o=A();for(let e=0;e<s.length;e+=1)s[e].c();x(r,"class","radioP svelte-2jmqa0"),x(n,"class","radioContainer svelte-2jmqa0")},m(e,t){w(e,n,t),b(n,r),b(r,i),b(n,o);for(let e=0;e<s.length;e+=1)s[e].m(n,null)},p(e,[t]){if(4&t&&R(i,e[2]),7&t){let r;for(a=e[1],r=0;r<a.length;r+=1){const i=ir(e,a,r);s[r]?s[r].p(i,t):(s[r]=or(i),s[r].c(),s[r].m(n,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=a.length}},i:e,o:e,d(e){e&&T(n),E(s,e)}}}function sr(e,t,n){let{items:r}=t,{Name:i}=t,{chosenValue:o}=t;return e.$set=e=>{"items"in e&&n(1,r=e.items),"Name"in e&&n(2,i=e.Name),"chosenValue"in e&&n(0,o=e.chosenValue)},[o,r,i,function(){o=this.__value,n(0,o)},[[]]]}class ur extends _e{constructor(e){super(),ke(this,e,sr,ar,s,{items:1,Name:2,chosenValue:0})}}function cr(e){let t,n;function r(t){e[5].call(null,t)}let i={Name:"How much money has been raised since the start?"};void 0!==e[0]&&(i.value=e[0]);const o=new On({props:i});return X.push(()=>Ie(o,"value",r)),{c(){Ce(o.$$.fragment)},m(e,t){Ae(o,e,t),n=!0},p(e,n){const r={};!t&&1&n&&(t=!0,r.value=e[0],re(()=>t=!1)),o.$set(r)},i(e){n||(de(o.$$.fragment,e),n=!0)},o(e){me(o.$$.fragment,e),n=!1},d(e){De(o,e)}}}function lr(e){let t,n,r,i,a,s,u,c,l,h,f,p,d="yes"===e[1]&&cr(e);return{c(){t=S("div"),n=S("p"),r=C(e[2]),i=A(),a=S("div"),s=S("button"),s.textContent="YES",u=A(),c=S("button"),c.textContent="NO",l=A(),d&&d.c(),h=D(),x(s,"class","yes svelte-iin1v5"),x(c,"class","no svelte-iin1v5"),x(a,"class","btn-container svelte-iin1v5"),x(t,"class","YNquestion svelte-iin1v5")},m(o,m){w(o,t,m),b(t,n),b(n,r),b(t,i),b(t,a),b(a,s),b(a,u),b(a,c),w(o,l,m),d&&d.m(o,m),w(o,h,m),f=!0,p=[N(s,"click",k(e[3])),N(c,"click",k(e[4]))]},p(e,[t]){(!f||4&t)&&R(r,e[2]),"yes"===e[1]?d?(d.p(e,t),de(d,1)):(d=cr(e),d.c(),de(d,1),d.m(h.parentNode,h)):d&&(fe(),me(d,1,1,()=>{d=null}),pe())},i(e){f||(de(d),f=!0)},o(e){me(d),f=!1},d(e){e&&T(t),e&&T(l),d&&d.d(e),e&&T(h),o(p)}}}function hr(e,t,n){let{question:r}=t,{value:i}=t,{answer:o}=t;return e.$set=e=>{"question"in e&&n(2,r=e.question),"value"in e&&n(0,i=e.value),"answer"in e&&n(1,o=e.answer)},[i,o,r,()=>{n(1,o="yes")},()=>{n(1,o="no")},function(e){i=e,n(0,i)}]}class fr extends _e{constructor(e){super(),ke(this,e,hr,lr,s,{question:2,value:0,answer:1})}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var pr=function(e,t){return(pr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var dr=function(){return(dr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function mr(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function gr(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function yr(e){return this instanceof yr?(this.v=e,this):new yr(e)}var vr=Object.freeze({__proto__:null,__extends:function(e,t){function n(){this.constructor=e}pr(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},get __assign(){return dr},__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},__decorate:function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},__param:function(e,t){return function(n,r){t(n,r,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},__generator:function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__exportStar:function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},__values:mr,__read:gr,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(gr(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},__await:yr,__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof yr?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:yr(e[r](t)),done:"return"===r}:i?i(t):t}:i}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=mr(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}}),br=Et((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var n={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},r=function(e,t){if(!e)throw i(t)},i=function(e){return new Error("Firebase Database ("+n.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},o=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},s=function(e){try{return a.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function u(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=u(e[n],t[n]));return e}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var c=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var h=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,f.prototype.create),i}return vr.__extends(t,e),t}(Error),f=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?p(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new h(i,s),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in u&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),u[f]=r[f])}return u},e}();function p(e,t){return e.replace(d,(function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"}))}var d=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function m(e){return JSON.parse(e)}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var g=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=m(s(o[0])||""),n=m(s(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var y=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();var v=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=b),void 0===r.error&&(r.error=b),void 0===r.complete&&(r.complete=b);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function b(){}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function w(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=r+" argument "}t.CONSTANTS=n,t.Deferred=c,t.ErrorFactory=f,t.FirebaseError=h,t.Sha1=y,t.assert=r,t.assertionError=i,t.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){e.apply(void 0,n)})).catch((function(e){t&&t(e)}))}},t.base64=a,t.base64Decode=s,t.base64Encode=function(e){var t=o(e);return a.encodeByteArray(t,!0)},t.contains=
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new v(e,t);return n.subscribe.bind(n)},t.decode=g,t.deepCopy=
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){return u(void 0,e)},t.deepExtend=u,t.errorPrefix=w,t.getUA=l,t.isAdmin=function(e){var t=g(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isBrowserExtension=function(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},t.isElectron=function(){return l().indexOf("Electron/")>=0},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){var e=l();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())},t.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(wt.process)}catch(e){return!1}},t.isNodeSdk=function(){return!0===n.NODE_CLIENT||!0===n.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isUWP=function(){return l().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){var t=g(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=g(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){var t=g(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=m,t.map=function(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */,t.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);if(o>=55296&&o<=56319){var a=o-55296;i++,r(i<e.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(e.charCodeAt(i)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(w(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(w(e,t,r)+"must be a valid context object.")}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */,t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(w(e,t,r)+"must be a valid firebase namespace.")}}));Tt(br);br.CONSTANTS,br.Deferred,br.ErrorFactory,br.FirebaseError,br.Sha1,br.assert,br.assertionError,br.async,br.base64,br.base64Decode,br.base64Encode,br.contains,br.createSubscribe,br.decode,br.deepCopy,br.deepExtend,br.errorPrefix,br.getUA,br.isAdmin,br.isBrowser,br.isBrowserExtension,br.isElectron,br.isEmpty,br.isIE,br.isMobileCordova,br.isNode,br.isNodeSdk,br.isReactNative,br.isUWP,br.isValidFormat,br.isValidTimestamp,br.issuedAtTime,br.jsonEval,br.map,br.querystring,br.querystringDecode,br.safeGet,br.stringLength,br.stringToByteArray,br.stringify,br.validateArgCount,br.validateCallback,br.validateContextObject,br.validateNamespace;var wr=Et((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e}(),r=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(e){void 0===e&&(e="[DEFAULT]");var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new br.Deferred;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=vr.__assign({identifier:"[DEFAULT]",optional:!1},e),n=t.identifier,r=t.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService("[DEFAULT]")}catch(e){}try{for(var r=vr.__values(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=vr.__read(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService(u);s.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return vr.__awaiter(this,void 0,void 0,(function(){var e;return vr.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.getOrInitializeService=function(e){var t=this.instances.get(e);return!t&&this.component&&(t=this.component.instanceFactory(this.container,function(e){return"[DEFAULT]"===e?void 0:e}(e)),this.instances.set(e,t)),t||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e}();
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var i=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new r(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=n,t.ComponentContainer=i,t.Provider=r}));Tt(wr);wr.Component,wr.ComponentContainer,wr.Provider;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function Tr(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Er,Sr=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Er||(Er={}));var Ir=Er.INFO,Cr=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString();switch(t){case Er.DEBUG:case Er.VERBOSE:console.log.apply(console,Tr(["["+i+"]  "+e.name+":"],n));break;case Er.INFO:console.info.apply(console,Tr(["["+i+"]  "+e.name+":"],n));break;case Er.WARN:console.warn.apply(console,Tr(["["+i+"]  "+e.name+":"],n));break;case Er.ERROR:console.error.apply(console,Tr(["["+i+"]  "+e.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},Ar=function(){function e(e){this.name=e,this._logLevel=Ir,this._logHandler=Cr,Sr.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in Er))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,Tr([this,Er.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,Tr([this,Er.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,Tr([this,Er.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,Tr([this,Er.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,Tr([this,Er.ERROR],e))},e}();var Dr=Object.freeze({__proto__:null,get LogLevel(){return Er},Logger:Ar,setLogLevel:
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){Sr.forEach((function(t){t.logLevel=e}))}}),Nr=Et((function(e,t){
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var n;Object.defineProperty(t,"__esModule",{value:!0});var r,i=((n={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",n["bad-app-name"]="Illegal App name: '{$appName}",n["duplicate-app"]="Firebase App named '{$appName}' already exists",n["app-deleted"]="Firebase App named '{$appName}' already deleted",n["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",n),o=new br.ErrorFactory("app","Firebase",i),a="@firebase/app",s=((r={})[a]="fire-core",r["@firebase/analytics"]="fire-analytics",r["@firebase/auth"]="fire-auth",r["@firebase/database"]="fire-rtdb",r["@firebase/functions"]="fire-fn",r["@firebase/installations"]="fire-iid",r["@firebase/messaging"]="fire-fcm",r["@firebase/performance"]="fire-perf",r["@firebase/remote-config"]="fire-rc",r["@firebase/storage"]="fire-gcs",r["@firebase/firestore"]="fire-fst",r["fire-js"]="fire-js",r["firebase-wrapper"]="fire-js-all",r),u=new Dr.Logger("@firebase/app"),c=function(){function e(e,t,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=br.deepCopy(e),this.container=new wr.ComponentContainer(t.name),this._addComponent(new wr.Component("app",(function(){return o}),"PUBLIC"));try{for(var a=vr.__values(this.firebase_.INTERNAL.components.values()),s=a.next();!s.done;s=a.next()){var u=s.value;this._addComponent(u)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){return void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t="[DEFAULT]"),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){u.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw o.create("app-deleted",{appName:this.name_})},e}();c.prototype.name&&c.prototype.options||c.prototype.delete||console.log("dc");var l=
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function e(){var t=
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var a=i;void 0===a.name&&(a.name="[DEFAULT]");var s=a.name;if("string"!=typeof s||!s)throw o.create("bad-app-name",{appName:String(s)});if(br.contains(t,s))throw o.create("duplicate-app",{appName:s});var u=new e(n,a,r);return t[s]=u,u},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=s[e])&&void 0!==r?r:e;n&&(i+="-"+n);var o=i.match(/\s|\//),c=t.match(/\s|\//);if(o||c){var l=['Unable to register library "'+i+'" with version "'+t+'":'];return o&&l.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&c&&l.push("and"),c&&l.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void u.warn(l.join(" "))}a(new wr.Component(i+"-version",(function(){return{library:i,version:t}}),"VERSION"))},apps:null,SDK_VERSION:"7.8.1",INTERNAL:{registerComponent:a,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){if("serverAuth"===t)return null;return t}}};function i(e){if(e=e||"[DEFAULT]",!br.contains(t,e))throw o.create("no-app",{appName:e});return t[e]}function a(a){var s,c,l=a.name;if(n.has(l))return u.debug("There were multiple attempts to register component "+l+"."),"PUBLIC"===a.type?r[l]:null;if(n.set(l,a),"PUBLIC"===a.type){var h=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[l])throw o.create("invalid-app-argument",{appName:l});return e[l]()};void 0!==a.serviceProps&&br.deepExtend(h,a.serviceProps),r[l]=h,e.prototype[l]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,l);return n.apply(this,a.multipleInstances?e:[])}}try{for(var f=vr.__values(Object.keys(t)),p=f.next();!p.done;p=f.next()){var d=p.value;t[d]._addComponent(a)}}catch(e){s={error:e}}finally{try{p&&!p.done&&(c=f.return)&&c.call(f)}finally{if(s)throw s.error}}return"PUBLIC"===a.type?r[l]:null}return(r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),i.App=e,r)}(c);return t.INTERNAL=vr.__assign(vr.__assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){br.deepExtend(t,e)},createSubscribe:br.createSubscribe,ErrorFactory:br.ErrorFactory,deepExtend:br.deepExtend}),t}(),h=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t,n=e.getComponent();return"VERSION"===(null===(t=n)||void 0===t?void 0:t.type)}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if(br.isBrowser()&&void 0!==self.firebase){u.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&u.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var p=l.initializeApp;l.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return br.isNode()&&u.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),p.apply(void 0,e)};var d=l;!function(e,t){e.INTERNAL.registerComponent(new wr.Component("platform-logger",(function(e){return new h(e)}),"PRIVATE")),e.registerVersion(a,"0.5.4",t),e.registerVersion("fire-js","")}(d),t.default=d,t.firebase=d}));Tt(Nr);Nr.firebase;var kr,_r=(kr=Nr)&&"object"==typeof kr&&"default"in kr?kr.default:kr;
/**
     * @license
     * Copyright 2018 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
_r.registerVersion("firebase","7.8.2","app");var xr=_r;Et((function(e,t){!function(e){try{(function(){e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,n)};function n(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r,i,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n=n||Promise)((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function l(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString();switch(t){case r.DEBUG:case r.VERBOSE:console.log.apply(console,c(["["+o+"]  "+e.name+":"],n));break;case r.INFO:console.info.apply(console,c(["["+o+"]  "+e.name+":"],n));break;case r.WARN:console.warn.apply(console,c(["["+o+"]  "+e.name+":"],n));break;case r.ERROR:console.error.apply(console,c(["["+o+"]  "+e.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}}(i=r=r||{})[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var h=r.INFO,f=(Object.defineProperty(p.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in r))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),p.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,c([this,r.DEBUG],e))},p.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,c([this,r.VERBOSE],e))},p.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,c([this,r.INFO],e))},p.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,c([this,r.WARN],e))},p.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,c([this,r.ERROR],e))},p);function p(e){this.name=e,this._logLevel=h,this._logHandler=l}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var m,g=(n(y,m=Error),y);function y(e,t){var n=m.call(this,t)||this;return n.code=e,n.name="FirebaseError",Object.setPrototypeOf(n,y.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,v.prototype.create),n}var v=(b.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?function(e,t){return e.replace(w,(function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"}))}(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new g(i,s),c=0,l=Object.keys(r);c<l.length;c++){var h=l[c];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},b);function b(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var w=/\{\$([^}]+)}/g,T=(E.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},E.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},E.prototype.setServiceProps=function(e){return this.serviceProps=e,this},E);function E(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var S,I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==wt?wt:"undefined"!=typeof self?self:{},C=C||{},A=I;function D(e){return"string"==typeof e}function N(e){return"number"==typeof e}function k(e,t){e=e.split("."),t=t||A;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t}function _(){}function x(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function R(e){return"array"==x(e)}function M(e){var t=x(e);return"array"==t||"object"==t&&"number"==typeof e.length}function O(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function F(e,t,n){return e.call.apply(e.bind,arguments)}function B(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function q(e,t,n){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?F:B).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var $=Date.now||function(){return+new Date};function U(e,t){function n(){}n.prototype=t.prototype,e.N=t.prototype,e.prototype=new n,(e.prototype.constructor=e).xb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[P]||(this[P]=++L))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var W=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(D(e))return D(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},z=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=D(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function K(e){return Array.prototype.concat.apply([],arguments)}function G(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Q(e){return/^[\s\xa0]*$/.test(e)}var H,Y=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function X(e,t){return-1!=e.indexOf(t)}function J(e,t){return e<t?-1:t<e?1:0}e:{var Z=A.navigator;if(Z){var ee=Z.userAgent;if(ee){H=ee;break e}}H=""}function te(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ne(e){var t,n={};for(t in e)n[t]=e[t];return n}var re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<re.length;o++)n=re[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function oe(e){return oe[" "](e),e}oe[" "]=_;var ae,se,ue=X(H,"Opera"),ce=X(H,"Trident")||X(H,"MSIE"),le=X(H,"Edge"),he=le||ce,fe=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),pe=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function de(){var e=A.document;return e?e.documentMode:void 0}e:{var me="",ge=(se=H,fe?/rv:([^\);]+)(\)|;)/.exec(se):le?/Edge\/([\d\.]+)/.exec(se):ce?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(se):pe?/WebKit\/(\S+)/.exec(se):ue?/(?:Version)[ \/]?(\S+)/.exec(se):void 0);if(ge&&(me=ge?ge[1]:""),ce){var ye=de();if(null!=ye&&ye>parseFloat(me)){ae=String(ye);break e}}ae=me}var ve,be={};function we(e){return function(t,n){var r=be;return Object.prototype.hasOwnProperty.call(r,t)?r[t]:r[t]=function(){for(var t=0,n=Y(String(ae)).split("."),r=Y(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=J(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==a[2].length,0==s[2].length)||J(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}()}(e)}var Te=A.document;ve=Te&&ce?de()||("CSS1Compat"==Te.compatMode?parseInt(ae,10):5):void 0;var Ee=!ce||9<=Number(ve),Se=ce&&!we("9"),Ie=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{A.addEventListener("test",_,t),A.removeEventListener("test",_,t)}catch(e){}return e}();function Ce(e,t){this.type=e,this.a=this.target=t,this.Ia=!0}function Ae(e,t){if(Ce.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(fe){e:{try{oe(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=D(e.pointerType)?e.pointerType:De[e.pointerType]||"",(this.c=e).defaultPrevented&&this.b()}}Ce.prototype.b=function(){this.Ia=!1},U(Ae,Ce);var De={2:"touch",3:"pen",4:"mouse"};Ae.prototype.b=function(){Ae.N.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Se)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}};var Ne="closure_listenable_"+(1e6*Math.random()|0),ke=0;function _e(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.da=i,this.key=++ke,this.X=this.Z=!1}function xe(e){e.X=!0,e.listener=null,e.proxy=null,e.src=null,e.da=null}function Re(e){this.src=e,this.a={},this.b=0}function Me(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=W(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(xe(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function Oe(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.X&&o.listener==t&&o.capture==!!n&&o.da==r)return i}return-1}Re.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Oe(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new _e(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var Pe="closure_lm_"+(1e6*Math.random()|0),Le={};function Fe(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,o){if(R(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);return null}return r=ze(r),t&&t[Ne]?t.Aa(n,r,O(i)?!!i.capture:!!i,o):Be(t,n,r,!0,i,o)}(e,t,n,r,i);if(R(t)){for(var o=0;o<t.length;o++)Fe(e,t[o],n,r,i);return null}return n=ze(n),e&&e[Ne]?e.za(t,n,O(r)?!!r.capture:!!r,i):Be(e,t,n,!1,r,i)}function Be(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=O(i)?!!i.capture:!!i;if(a&&!Ee)return null;var s=je(e);if(s||(e[Pe]=s=new Re(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=Ue,t=Ee?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),(n.proxy=r).src=e,r.listener=n,e.addEventListener)Ie||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ve(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function qe(e){if(!N(e)&&e&&!e.X){var t=e.src;if(t&&t[Ne])Me(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ve(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=je(t))?(Me(n,e),0==n.b&&(n.src=null,t[Pe]=null)):xe(e)}}}function Ve(e){return e in Le?Le[e]:Le[e]="on"+e}function $e(e,t){var n=e.listener,r=e.da||e.src;return e.Z&&qe(e),n.call(r,t)}function Ue(e,t){return!!e.X||$e(e,Ee?new Ae(t,this):t=new Ae(t||k("window.event"),this))}function je(e){return(e=e[Pe])instanceof Re?e:null}var We="__closure_events_fn_"+(1e9*Math.random()>>>0);function ze(e){return"function"==x(e)?e:(e[We]||(e[We]=function(t){return e.handleEvent(t)}),e[We])}function Ke(){j.call(this),this.c=new Re(this),(this.J=this).B=null}function Ge(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&Me(e.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ia}U(Ke,j),Ke.prototype[Ne]=!0,(S=Ke.prototype).addEventListener=function(e,t,n,r){Fe(this,e,t,n,r)},S.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,o){if(R(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);else i=O(i)?!!i.capture:!!i,r=ze(r),t&&t[Ne]?(t=t.c,(n=String(n).toString())in t.a&&-1<(r=Oe(a=t.a[n],r,i,o))&&(xe(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--))):(t=t&&je(t))&&(n=t.a[n.toString()],t=-1,n&&(t=Oe(n,r,i,o)),(r=-1<t?n[t]:null)&&qe(r))}(this,e,t,n,r)},S.dispatchEvent=function(e){var t,n=this.B;if(n)for(t=[];n;n=n.B)t.push(n);n=this.J;var r=e.type||e;if(D(e))e=new Ce(e,n);else if(e instanceof Ce)e.target=e.target||n;else{var i=e;ie(e=new Ce(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.a=t[o];i=Ge(a,r,!0,e)&&i}if(i=Ge(a=e.a=n,r,!0,e)&&i,i=Ge(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=Ge(a=e.a=t[o],r,!1,e)&&i;return i},S.G=function(){if(Ke.N.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)xe(n[r]);delete t.a[e],t.b--}}this.B=null},S.za=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},S.Aa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Qe=A.JSON.stringify;function He(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function Ye(){this.b=this.a=null}He.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var Xe,Je=new He((function(){return new Ze}),(function(e){e.reset()}));function Ze(){this.next=this.b=this.a=null}function et(e){A.setTimeout((function(){throw e}),0)}function tt(e,t){Xe||function(){var e=A.Promise.resolve(void 0);Xe=function(){e.then(it)}}(),nt||(Xe(),nt=!0),rt.add(e,t)}Ye.prototype.add=function(e,t){var n=Je.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},Ze.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null};var nt=!(Ze.prototype.reset=function(){this.next=this.b=this.a=null}),rt=new Ye;function it(){for(var e;r=n=void 0,r=null,(n=rt).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),e=r;){try{e.a.call(e.b)}catch(e){et(e)}var t=Je;t.f(e),t.b<100&&(t.b++,e.next=t.a,t.a=e)}var n,r;nt=!1}function ot(e,t){Ke.call(this),this.b=e||1,this.a=t||A,this.f=q(this.fb,this),this.g=$()}function at(e){e.ba=!1,e.L&&(e.a.clearTimeout(e.L),e.L=null)}function st(e,t,n){if("function"==x(e))n&&(e=q(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=q(e.handleEvent,e)}return 2147483647<Number(t)?-1:A.setTimeout(e,t||0)}function ut(e,t,n){j.call(this),this.f=null!=n?q(e,n):e,this.c=t,this.b=q(this.$a,this),this.a=[]}function ct(e){e.U=st(e.b,e.c),e.f.apply(null,e.a)}function lt(e){j.call(this),this.b=e,this.a={}}U(ot,Ke),(S=ot.prototype).ba=!1,S.L=null,S.fb=function(){if(this.ba){var e=$()-this.g;0<e&&e<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-e):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(at(this),this.start()))}},S.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=$())},S.G=function(){ot.N.G.call(this),at(this),delete this.a},U(ut,j),(S=ut.prototype).ea=!1,S.U=null,S.Ta=function(e){this.a=arguments,this.U?this.ea=!0:ct(this)},S.G=function(){ut.N.G.call(this),this.U&&(A.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},S.$a=function(){this.U=null,this.ea&&(this.ea=!1,ct(this))},U(lt,j);var ht=[];function ft(e,t,n,r){R(n)||(n&&(ht[0]=n.toString()),n=ht);for(var i=0;i<n.length;i++){var o=Fe(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function pt(e){te(e.a,(function(e,t){this.a.hasOwnProperty(t)&&qe(e)}),e),e.a={}}function dt(){}lt.prototype.G=function(){lt.N.G.call(this),pt(this)},lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mt=new Ke;function gt(e){Ce.call(this,"serverreachability",e)}function yt(e){mt.dispatchEvent(new gt(mt,e))}function vt(e){Ce.call(this,"statevent",e)}function bt(e){mt.dispatchEvent(new vt(mt,e))}function Tt(e){Ce.call(this,"timingevent",e)}function Et(e,t){if("function"!=x(e))throw Error("Fn must not be null and must be a function");return A.setTimeout((function(){e()}),t)}U(gt,Ce),U(vt,Ce),U(Tt,Ce);var St={NO_ERROR:0,gb:1,nb:2,mb:3,jb:4,lb:5,ob:6,La:7,TIMEOUT:8,rb:9},It={ib:"complete",vb:"success",Ma:"error",La:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",kb:"downloadprogress",wb:"uploadprogress"};function Ct(){}function At(e){var t;return(t=e.a)||(t=e.a={}),t}function Dt(){}Ct.prototype.a=null;var Nt,kt={OPEN:"a",hb:"b",Ma:"c",qb:"d"};function _t(){Ce.call(this,"d")}function xt(){Ce.call(this,"c")}function Rt(){}function Mt(e,t,n){this.g=e,this.W=t,this.V=n||1,this.I=new lt(this),this.O=Ot,e=he?125:void 0,this.P=new ot(e),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}U(_t,Ce),U(xt,Ce),U(Rt,Ct),Nt=new Rt;var Ot=45e3,Pt={},Lt={};function Ft(e,t,n){e.F=1,e.f=cn(tn(t)),e.l=n,e.H=!0,qt(e,null)}function Bt(e,t,n,r){e.F=1,e.f=cn(tn(t)),e.l=null,e.H=n,qt(e,r)}function qt(e,t){e.v=$(),Ut(e),e.D=tn(e.f),un(e.D,"t",e.V),e.A=0,e.a=e.g.$(e.g.Y()?t:null),0<e.J&&(e.B=new ut(q(e.Ja,e,e.a),e.J)),ft(e.I,e.a,"readystatechange",e.cb),t=e.h?ne(e.h):{},e.l?(e.w||(e.w="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ca(e.D,e.w,e.l,t)):(e.w="GET",e.a.ca(e.D,e.w,null,t)),yt(1)}function Vt(e,t,n){for(var r=!0;!e.m&&e.A<n.length;){var i=$t(e,n);if(i==Lt){4==t&&(e.c=4,bt(14),r=!1);break}if(i==Pt){e.c=4,bt(15),r=!1;break}Gt(e,i)}4==t&&0==n.length&&(e.c=1,bt(16),r=!1),e.b=e.b&&r,r||(Kt(e),zt(e))}function $t(e,t){var n=e.A,r=t.indexOf("\n",n);return-1==r?Lt:(n=Number(t.substring(n,r)),isNaN(n)?Pt:(r+=1)+n>t.length?Lt:(t=t.substr(r,n),e.A=r+n,t))}function Ut(e){e.R=$()+e.O,jt(e,e.O)}function jt(e,t){if(null!=e.i)throw Error("WatchDog timer not null");e.i=Et(q(e.ab,e),t)}function Wt(e){e.i&&(A.clearTimeout(e.i),e.i=null)}function zt(e){e.g.Ca()||e.m||e.g.na(e)}function Kt(e){Wt(e);var t=e.B;t&&"function"==typeof t.la&&t.la(),e.B=null,at(e.P),pt(e.I),e.a&&(t=e.a,e.a=null,t.abort(),t.la())}function Gt(e,t){try{e.g.Fa(e,t),yt(4)}catch(e){}}function Qt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(M(e)||D(e))z(e,t,void 0);else{if(e.K&&"function"==typeof e.K)var n=e.K();else if(e.C&&"function"==typeof e.C)n=void 0;else if(M(e)||D(e)){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.C&&"function"==typeof e.C)return e.C();if(D(e))return e.split("");if(M(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function Ht(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Ht)for(n=e.K(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Yt(e,t){Jt(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Xt(e))}function Xt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Jt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Jt(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function Jt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(S=Mt.prototype).setTimeout=function(e){this.O=e},S.cb=function(e){e=e.target;var t=this.B;t&&3==tr(e)?t.Ta():this.Ja(e)},S.Ja=function(e){try{if(e==this.a)e:{var t=tr(this.a),n=this.a.ya(),r=this.a.T();if(!(t<3||3==t&&!he&&!this.a.aa())){this.m||4!=t||7==n||yt(8==n||r<=0?3:2),Wt(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){t:{if(this.a){var a=nr(this.a,"X-HTTP-Initial-Response");if(a&&!Q(a)){var s=a;break t}}s=null}if(!s){this.b=!1,this.c=3,bt(12),Kt(this),zt(this);break e}this.s=!0,Gt(this,s)}this.H?(Vt(this,t,o),he&&this.b&&3==t&&(ft(this.I,this.P,"tick",this.bb),this.P.start())):Gt(this,o),4==t&&Kt(this),this.b&&!this.m&&(4==t?this.g.na(this):(this.b=!1,Ut(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,bt(12)):(this.c=0,bt(13)),Kt(this),zt(this)}}}catch(e){}},S.bb=function(){if(this.a){var e=tr(this.a),t=this.a.aa();this.A<t.length&&(Wt(this),Vt(this,e,t),this.b&&4!=e&&Ut(this))}},S.cancel=function(){this.m=!0,Kt(this)},S.ab=function(){this.i=null;var e=$();0<=e-this.R?(2!=this.F&&(yt(3),bt(17)),Kt(this),this.c=2,zt(this)):jt(this,this.R-e)},(S=Ht.prototype).C=function(){Xt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},S.K=function(){return Xt(this),this.a.concat()},S.get=function(e,t){return Jt(this.b,e)?this.b[e]:t},S.set=function(e,t){Jt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},S.forEach=function(e,t){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Zt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function en(e,t){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,e instanceof en?(this.h=void 0!==t?t:e.h,nn(this,e.f),this.j=e.j,rn(this,e.b),on(this,e.i),this.a=e.a,an(this,Sn(e.c)),this.g=e.g):e&&(n=String(e).match(Zt))?(this.h=!!t,nn(this,n[1]||"",!0),this.j=ln(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.a=ln(n[5]||"",!0),an(this,n[6]||"",!0),this.g=ln(n[7]||"")):(this.h=!!t,this.c=new vn(null,this.h))}function tn(e){return new en(e)}function nn(e,t,n){e.f=n?ln(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function rn(e,t,n){e.b=n?ln(t,!0):t}function on(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.i=t}else e.i=null}function an(e,t,n){t instanceof vn?(e.c=t,function(e,t){t&&!e.f&&(bn(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(wn(this,t),En(this,n,e))}),e)),e.f=t}(e.c,e.h)):(n||(t=hn(t,gn)),e.c=new vn(t,e.h))}function sn(e,t,n){e.c.set(t,n)}function un(e,t,n){R(n)||(n=[String(n)]),En(e.c,t,n)}function cn(e){return sn(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^$()).toString(36)),e}function ln(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function hn(e,t,n){return D(e)?(e=encodeURI(e).replace(t,fn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function fn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}en.prototype.toString=function(){var e=[],t=this.f;t&&e.push(hn(t,pn,!0),":");var n=this.b;return!n&&"file"!=t||(e.push("//"),(t=this.j)&&e.push(hn(t,pn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(hn(n,"/"==n.charAt(0)?mn:dn,!0))),(n=this.c.toString())&&e.push("?",n),(n=this.g)&&e.push("#",hn(n,yn)),e.join("")},en.prototype.resolve=function(e){var t=tn(this),n=!!e.f;n?nn(t,e.f):n=!!e.j,n?t.j=e.j:n=!!e.b,n?rn(t,e.b):n=null!=e.i;var r=e.a;if(n)on(t,e.i);else if(n=!!e.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=t.a.lastIndexOf("/");-1!=i&&(r=t.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(X(i,"./")||X(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.a=r:n=""!==e.c.toString(),n?an(t,Sn(e.c)):n=!!e.g,n&&(t.g=e.g),t};var pn=/[#\/\?@]/g,dn=/[#\?:]/g,mn=/[#\?]/g,gn=/[#\?@]/g,yn=/#/g;function vn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function bn(e){e.a||(e.a=new Ht,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function wn(e,t){bn(e),t=In(e,t),Jt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Yt(e.a,t))}function Tn(e,t){return bn(e),t=In(e,t),Jt(e.a.b,t)}function En(e,t,n){wn(e,t),0<n.length&&(e.c=null,e.a.set(In(e,t),G(n)),e.b+=n.length)}function Sn(e){var t=new vn;return t.c=e.c,e.a&&(t.a=new Ht(e.a),t.b=e.b),t}function In(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function Cn(e){this.a=e,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function An(e){var t=e.a.F.a;if(null!=t)bt(4),t?(bt(10),dr(e.a,e,!1)):(bt(11),dr(e.a,e,!0));else{e.b=new Mt(e,void 0,void 0),e.b.h=e.h,t=br(t=e.a,t.Y()?e.f:null,e.i),bt(4),un(t,"TYPE","xmlhttp");var n=e.a.j,r=e.a.I;n&&r&&sn(t,n,r),Bt(e.b,t,!1,e.f)}}function Dn(){this.a=this.b=null}function Nn(){this.a=new Ht}function kn(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[P]||(e[P]=++L)):t.charAt(0)+e}function _n(e,t){this.b=e,this.a=t}function xn(e){this.g=e||Rn,e=A.PerformanceNavigationTiming?0<(e=A.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(A.ka&&A.ka.Da&&A.ka.Da()&&A.ka.Da().yb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Nn),this.b=null,this.c=[]}(S=vn.prototype).add=function(e,t){bn(this),this.c=null,e=In(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},S.forEach=function(e,t){bn(this),this.a.forEach((function(n,r){z(n,(function(n){e.call(t,n,r,this)}),this)}),this)},S.K=function(){bn(this);for(var e=this.a.C(),t=this.a.K(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},S.C=function(e){bn(this);var t=[];if(D(e))Tn(this,e)&&(t=K(t,this.a.get(In(this,e))));else{e=this.a.C();for(var n=0;n<e.length;n++)t=K(t,e[n])}return t},S.set=function(e,t){return bn(this),this.c=null,Tn(this,e=In(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},S.get=function(e,t){return e&&0<(e=this.C(e)).length?String(e[0]):t},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.K(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")},U((function(){}),(function(){})),(S=Cn.prototype).M=null,S.$=function(e){return this.a.$(e)},S.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},S.Ca=function(){return!1},S.Fa=function(e,t){if(this.c=e.o,0==this.M){if(!this.a.o&&(e=e.a)){var n=nr(e,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(e=nr(e,"X-HTTP-Session-Id"))&&(this.a.I=e)}if(t){try{var r=this.a.ja.a.parse(t)}catch(e){return(t=this.a).m=this.c,void yr(t,2)}this.f=r[0]}else(t=this.a).m=this.c,yr(t,2)}else 1==this.M&&(this.g?bt(6):"11111"==t?(bt(5),this.g=!0,(!ce||10<=Number(ve))&&(this.c=200,this.b.cancel(),bt(11),dr(this.a,this,!0))):(bt(7),this.g=!1))},S.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,An(this)):1==this.M&&(this.g?(bt(11),dr(this.a,this,!0)):(bt(10),dr(this.a,this,!1)));else{0==this.M?bt(8):1==this.M&&bt(9);var e=this.a;e.m=this.c,yr(e,2)}},S.Y=function(){return this.a.Y()},S.ma=function(){return this.a.ma()},Nn.prototype.add=function(e){this.a.set(kn(e),e)},Nn.prototype.C=function(){return this.a.C()};var Rn=10;function Mn(e,t){!e.a&&(X(t,"spdy")||X(t,"quic")||X(t,"h2"))&&(e.f=e.g,e.a=new Nn,e.b&&(Fn(e,e.b),e.b=null))}function On(e){return!!e.b||!!e.a&&e.a.a.c>=e.f}function Pn(e){return e.b?1:e.a?e.a.a.c:0}function Ln(e,t){return e.b?e.b==t:!!e.a&&(t=kn(t),Jt(e.a.a.b,t))}function Fn(e,t){e.a?e.a.add(t):e.b=t}function Bn(e,t){var n;e.b&&e.b==t?e.b=null:((n=e.a)&&(n=kn(t),n=Jt(e.a.a.b,n)),n&&Yt(e.a.a,kn(t)))}function qn(e){if(null!=e.b)return e.c.concat(e.b.j);if(null==e.a||0==e.a.a.c)return G(e.c);var t=e.c;return z(e.a.C(),(function(e){t=t.concat(e.j)})),t}function Vn(){}function $n(){this.a=new Vn}function Un(e,t,n){var r=n||"";try{Qt(e,(function(e,n){var i=e;O(e)&&(i=Qe(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function jn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}xn.prototype.cancel=function(){this.c=qn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(z(this.a.C(),(function(e){e.cancel()})),function(e){e.b={},e.a.length=0,e.c=0}(this.a.a))},Vn.prototype.stringify=function(e){return A.JSON.stringify(e,void 0)},Vn.prototype.parse=function(e){return A.JSON.parse(e,void 0)};var Wn=A.JSON.parse;function zn(e){Ke.call(this),this.headers=new Ht,this.H=e||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Kn,this.D=this.F=!1}U(zn,Ke);var Kn="",Gn=/^https?$/i,Qn=["POST","PUT"];function Hn(e){return"content-type"==e.toLowerCase()}function Yn(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,Xn(e),Zn(e)}function Xn(e){e.v||(e.v=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Jn(e){if(e.b&&void 0!==C&&(!e.s[1]||4!=tr(e)||2!=e.T()))if(e.l&&4==tr(e))st(e.Ea,0,e);else if(e.dispatchEvent("readystatechange"),4==tr(e)){e.b=!1;try{var t,n=e.T();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.A).match(Zt)[1]||null;if(!o&&A.self&&A.self.location){var a=A.self.location.protocol;o=a.substr(0,a.length-1)}i=!Gn.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{e.h=6;try{var s=2<tr(e)?e.a.statusText:""}catch(e){s=""}e.f=s+" ["+e.T()+"]",Xn(e)}}finally{Zn(e)}}}function Zn(e,t){if(e.a){er(e);var n=e.a,r=e.s[0]?_:null;e.a=null,e.s=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){}}}function er(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(A.clearTimeout(e.m),e.m=null)}function tr(e){return e.a?e.a.readyState:0}function nr(e,t){return e.a?e.a.getResponseHeader(t):null}function rr(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}if(r)return e;if(n=function(e){var t="";return te(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),D(e)){if(t=encodeURIComponent(String(t)),t+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=e.indexOf("#"))<0&&(n=e.length),(r=e.indexOf("?"))<0||n<r){r=n;var i=""}else i=e.substring(r+1,n);n=(e=[e.substr(0,r),i,e.substr(n)])[1],e[1]=t?n?n+"&"+t:t:n,e=e[0]+(e[1]?"?"+e[1]:"")+e[2]}return e}return sn(e,t,n),e}function ir(e){this.f=[],this.F=new Dn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!k("internalChannelParams.failFast",e),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=k("internalChannelParams.baseRetryDelayMs",e)||5e3,this.Ra=k("internalChannelParams.retryDelaySeedMs",e)||1e4,this.Pa=k("internalChannelParams.forwardChannelMaxRetries",e)||2,this.qa=k("internalChannelParams.forwardChannelRequestTimeoutMs",e)||2e4,this.Ka=e&&e.zb||void 0,this.D=void 0,this.R=e&&e.supportsCrossDomainXhr||!1,this.H="",this.b=new xn(e&&e.concurrentRequestLimit),this.ja=new $n,this.o=!e||void 0===e.backgroundChannelTest||e.backgroundChannelTest,(this.W=e&&e.fastHandshake||!1)&&!this.o&&(this.o=!0),e&&e.forceLongPolling&&(this.oa=!1),this.fa=void 0}function or(e){if(ar(e),3==e.u){var t=e.P++,n=tn(e.B);sn(n,"SID",e.H),sn(n,"RID",t),sn(n,"TYPE","terminate"),lr(e,n),(t=new Mt(e,t,void 0)).F=2,t.f=cn(tn(n)),n=!1,A.navigator&&A.navigator.sendBeacon&&(n=A.navigator.sendBeacon(t.f.toString(),"")),!n&&A.Image&&((new Image).src=t.f,n=!0),n||(t.a=t.g.$(null),t.a.ca(t.f)),t.v=$(),Ut(t)}vr(e)}function ar(e){e.w&&(e.w.abort(),e.w=null),e.a&&(e.a.cancel(),e.a=null),e.l&&(A.clearTimeout(e.l),e.l=null),mr(e),e.b.cancel(),e.h&&(N(e.h)&&A.clearTimeout(e.h),e.h=null)}function sr(e,t){e.f.push(new _n(e.Qa++,t)),3==e.u&&ur(e)}function ur(e){On(e.b)||e.h||(e.h=!0,tt(e.Ha,e),e.A=0)}function cr(e,t){var n;n=t?t.W:e.P++;var r=tn(e.B);sn(r,"SID",e.H),sn(r,"RID",n),sn(r,"AID",e.O),lr(e,r),e.g&&e.i&&rr(r,e.g,e.i),n=new Mt(e,n,e.A+1),null===e.g&&(n.h=e.i),t&&(e.f=t.j.concat(e.f)),t=hr(e,n,1e3),n.setTimeout(Math.round(.5*e.qa)+Math.round(.5*e.qa*Math.random())),Fn(e.b,n),Ft(n,r,t)}function lr(e,t){e.c&&Qt({},(function(e,n){sn(t,n,e)}))}function hr(e,t,n){n=Math.min(e.f.length,n);var r=e.c?q(e.c.Sa,e.c,e):null;e:for(var i=e.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),s=!1;else try{Un(l,a,"req"+c+"_")}catch(e){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.f.splice(0,n),t.j=e,r}function fr(e){e.a||e.l||(e.S=1,tt(e.Ga,e),e.v=0)}function pr(e){return!(e.a||e.l||3<=e.v||(e.S++,e.l=Et(q(e.Ga,e),gr(e,e.v)),e.v++,0))}function dr(e,t,n){var r=t.l;r&&Mn(e.b,r),e.ia=e.oa&&n,e.m=t.c,e.B=br(e,null,e.ha),ur(e)}function mr(e){null!=e.s&&(A.clearTimeout(e.s),e.s=null)}function gr(e,t){var n=e.Na+Math.floor(Math.random()*e.Ra);return e.ma()||(n*=2),n*t}function yr(e,t){if(2==t){var n=null;e.c&&(n=null);var r=q(e.eb,e);n||(n=new en("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||nn(n,"https"),cn(n)),function(e,t){var n=new dt;if(A.Image){var r=new Image;r.onload=V(jn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=V(jn,n,r,"TestLoadImage: error",!1,t),r.onabort=V(jn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=V(jn,n,r,"TestLoadImage: timeout",!1,t),A.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else bt(2);e.u=0,e.c&&e.c.ta(t),vr(e),ar(e)}function vr(e){e.u=0,e.m=-1,e.c&&(0==qn(e.b).length&&0==e.f.length||(e.b.c.length=0,G(e.f),e.f.length=0),e.c.sa())}function br(e,t,n){var r=function(e){return e instanceof en?tn(e):new en(e,void 0)}(n);if(""!=r.b)t&&rn(r,t+"."+r.b),on(r,r.i);else{var i,o=A.location;i=t?t+"."+o.hostname:o.hostname,r=function(e,t,n,r){var i=new en(null,void 0);return e&&nn(i,e),t&&rn(i,t),n&&on(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return e.V&&te(e.V,(function(e,t){sn(r,t,e)})),t=e.j,n=e.I,t&&n&&sn(r,t,n),sn(r,"VER",e.wa),lr(e,r),r}function wr(){}function Tr(){if(ce&&!(10<=Number(ve)))throw Error("Environmental error: no available transport.")}function Er(e,t){Ke.call(this),this.a=new ir(t),this.g=e,this.m=t&&t.testUrl?t.testUrl:function(e){for(var t=e,n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?t=i:((r=""==t)||(r=0<=(r=t.length-1)&&t.indexOf("/",r)==r),t+=r?i:"/"+i)}return t}(this.g,"test"),this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.i=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.xa&&(e?e["X-WebChannel-Client-Profile"]=t.xa:e={"X-WebChannel-Client-Profile":t.xa}),this.a.J=e,(e=t&&t.httpHeadersOverwriteParam)&&!Q(e)&&(this.a.g=e),this.l=t&&t.supportsCrossDomainXhr||!1,this.h=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Q(t)&&(this.a.j=t,null!==(e=this.b)&&t in e&&t in(e=this.b)&&delete e[t]),this.f=new Cr(this)}function Sr(e){_t.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function Ir(){xt.call(this),this.status=1}function Cr(e){this.a=e}(S=zn.prototype).ca=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+e);t=t?t.toUpperCase():"GET",this.A=e,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?At(this.H):At(Nt),this.a.onreadystatechange=q(this.Ea,this);try{this.w=!0,this.a.open(t,String(e),!0),this.w=!1}catch(e){return void Yn(this,e)}e=n||"";var i=new Ht(this.headers);r&&Qt(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=Hn,n=e.length,r=D(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:D(e)?e.charAt(t):e[t]}(i.K()),n=A.FormData&&e instanceof A.FormData,0<=W(Qn,t)&&!r&&!n&&i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{er(this),0<this.o&&((this.D=function(e){return ce&&we(9)&&N(e.timeout)&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=q(this.Ba,this)):this.m=st(this.Ba,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(e){Yn(this,e)}},S.Ba=function(){void 0!==C&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Zn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Zn(this,!0)),zn.N.G.call(this)},S.Ea=function(){this.j||(this.w||this.l||this.g?Jn(this):this.Za())},S.Za=function(){Jn(this)},S.T=function(){try{return 2<tr(this)?this.a.status:-1}catch(e){return-1}},S.aa=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},S.Ua=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Wn(t)}},S.ya=function(){return this.h},S.Xa=function(){return D(this.f)?this.f:String(this.f)},(S=ir.prototype).wa=8,S.u=1,S.Ca=function(){return 0==this.u},S.Ha=function(e){if(this.h)if(this.h=null,1==this.u){if(!e){this.P=Math.floor(1e5*Math.random());var t,n=new Mt(this,e=this.P++,void 0),r=this.i;if(this.J&&(r?ie(r=ne(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)e:{for(var i=t=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&D(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.f.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=hr(this,n,t),sn(i=tn(this.B),"RID",e),sn(i,"CVER",22),this.o&&this.j&&sn(i,"X-HTTP-Session-Id",this.j),lr(this,i),this.g&&r&&rr(i,this.g,r),Fn(this.b,n),this.W?(sn(i,"$req",t),sn(i,"SID","null"),n.S=!0,Ft(n,i,null)):Ft(n,i,t),this.u=2}}else 3==this.u&&(e?cr(this,e):0==this.f.length||On(this.b)||cr(this))},S.Ga=function(){this.l=null,this.a=new Mt(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var e=tn(this.pa);sn(e,"RID","rpc"),sn(e,"SID",this.H),sn(e,"CI",this.ia?"0":"1"),sn(e,"AID",this.O),lr(this,e),sn(e,"TYPE","xmlhttp"),this.g&&this.i&&rr(e,this.g,this.i),this.D&&this.a.setTimeout(this.D),Bt(this.a,e,!0,this.ga)},S.Fa=function(e,t){if(0!=this.u&&(this.a==e||Ln(this.b,e)))if(this.m=e.o,!e.s&&Ln(this.b,e)&&3==this.u){try{var n=this.ja.a.parse(t)}catch(e){n=null}if(R(n)&&3==n.length){if(0==(t=n)[0]){e:if(!this.l){if(this.a){if(!(this.a.v+3e3<e.v))break e;mr(this),this.a.cancel(),this.a=null}pr(this),bt(18)}}else this.ra=t[1],0<this.ra-this.O&&t[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Et(q(this.Ya,this),6e3));if(Pn(this.b)<=1&&this.fa){try{this.fa()}catch(e){}this.fa=void 0}}else yr(this,11)}else if(!e.s&&this.a!=e||mr(this),!Q(t))for(t=n=this.ja.a.parse(t),n=0;n<t.length;n++){var r=t[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&N(r)&&0<r&&(this.D=1.5*r),this.o&&(r=e.a)&&((i=nr(r,"X-Client-Wire-Protocol"))&&Mn(this.b,i),this.j&&(r=nr(r,"X-HTTP-Session-Id")))&&(this.I=r,sn(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=e,this.pa=br(this,this.Y()?this.ga:null,this.ha),r.s?(Bn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Wt(r),Ut(r)),this.a=r):fr(this),0<this.f.length&&ur(this)}else"stop"!=r[0]&&"close"!=r[0]||yr(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?yr(this,7):or(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},S.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,pr(this),bt(19))},S.na=function(e){var t=null;if(this.a==e){mr(this),this.a=null;var n=2}else{if(!Ln(this.b,e))return;t=e.j,Bn(this.b,e),n=1}if(this.m=e.o,0!=this.u)if(e.b)1==n?(t=$()-e.v,mt.dispatchEvent(new Tt(mt,e.l?e.l.length:0,t,this.A)),ur(this)):fr(this);else{var r=e.c;if(3==r||0==r&&0<this.m||!(1==n&&function(e,t){return!(Pn(e.b)>=e.b.f-(e.h?1:0)||(e.h?(e.f=t.j.concat(e.f),0):1==e.u||2==e.u||e.A>=(e.Oa?0:e.Pa)||(e.h=Et(q(e.Ha,e,t),gr(e,e.A)),e.A++,0)))}(this,e)||2==n&&pr(this)))switch(t&&0<t.length&&(e=this.b,e.c=e.c.concat(t)),r){case 1:yr(this,5);break;case 4:yr(this,10);break;case 3:yr(this,6);break;default:yr(this,2)}}},S.eb=function(e){bt(e?2:1)},S.$=function(e){if(e&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new zn(this.Ka)).F=this.R,e},S.ma=function(){return!!this.c&&!0},S.Y=function(){return this.R},(S=wr.prototype).va=function(){},S.ua=function(){},S.ta=function(){},S.sa=function(){},S.Sa=function(){},Tr.prototype.a=function(e,t){return new Er(e,t)},U(Er,Ke),(S=Er.prototype).addEventListener=function(e,t,n,r){Er.N.addEventListener.call(this,e,t,n,r)},S.removeEventListener=function(e,t,n,r){Er.N.removeEventListener.call(this,e,t,n,r)},S.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var e=this.a,t=this.m,n=this.g,r=this.b||void 0;bt(0),e.ha=n,e.V=r||{},e.o&&(e.F.b=[],e.F.a=!1),e.w=new Cn(e),null===e.g&&(e.w.h=e.i),n=t,e.g&&e.i&&(n=rr(t,e.g,e.i)),(e=e.w).i=n,t=br(e.a,null,e.i),bt(3),null!=(n=e.a.F.b)?(e.f=n[0],e.M=1,An(e)):(un(t,"MODE","init"),!e.a.o&&e.a.j&&un(t,"X-HTTP-Session-Id",e.a.j),e.b=new Mt(e,void 0,void 0),e.b.h=e.h,Bt(e.b,t,!1,null),e.M=0)},S.close=function(){or(this.a)},S.Wa=function(e){if(D(e)){var t={};t.__data__=e,sr(this.a,t)}else this.h?((t={}).__data__=Qe(e),sr(this.a,t)):sr(this.a,e)},S.G=function(){this.a.c=null,delete this.f,or(this.a),delete this.a,Er.N.G.call(this)},U(Sr,_t),U(Ir,xt),U(Cr,wr),Cr.prototype.va=function(){this.a.dispatchEvent("a")},Cr.prototype.ua=function(e){this.a.dispatchEvent(new Sr(e))},Cr.prototype.ta=function(e){this.a.dispatchEvent(new Ir(e))},Cr.prototype.sa=function(){this.a.dispatchEvent("b")};var Ar=V((function(e,t){function n(){}n.prototype=e.prototype;var r=new n;return e.apply(r,Array.prototype.slice.call(arguments,1)),r}),Tr);Tr.prototype.createWebChannel=Tr.prototype.a,Er.prototype.send=Er.prototype.Wa,Er.prototype.open=Er.prototype.Va,Er.prototype.close=Er.prototype.close,St.NO_ERROR=0,St.TIMEOUT=8,St.HTTP_ERROR=6,It.COMPLETE="complete",(Dt.EventType=kt).OPEN="a",kt.CLOSE="b",kt.ERROR="c",kt.MESSAGE="d",Ke.prototype.listen=Ke.prototype.za,zn.prototype.listenOnce=zn.prototype.Aa,zn.prototype.getLastError=zn.prototype.Xa,zn.prototype.getLastErrorCode=zn.prototype.ya,zn.prototype.getStatus=zn.prototype.T,zn.prototype.getResponseJson=zn.prototype.Ua,zn.prototype.getResponseText=zn.prototype.aa,zn.prototype.send=zn.prototype.ca;var Dr,Nr,kr={createWebChannelTransport:Ar,ErrorCode:St,EventType:It,WebChannel:Dt,XhrIo:zn},_r=kr.createWebChannelTransport,xr=kr.ErrorCode,Rr=kr.EventType,Mr=kr.WebChannel,Or=kr.XhrIo,Pr=e.SDK_VERSION,Lr=new f("@firebase/firestore");function Fr(){return Lr.logLevel===r.DEBUG?Dr.DEBUG:Lr.logLevel===r.SILENT?Dr.SILENT:Dr.ERROR}function Br(e){switch(e){case Dr.DEBUG:Lr.logLevel=r.DEBUG;break;case Dr.ERROR:Lr.logLevel=r.ERROR;break;case Dr.SILENT:Lr.logLevel=r.SILENT;break;default:Lr.error("Firestore ("+Pr+"): Invalid value passed to `setLogLevel`")}}function qr(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(Lr.logLevel<=r.DEBUG){var o=n.map($r);Lr.debug.apply(Lr,u(["Firestore ("+Pr+") ["+e+"]: "+t],o))}}function Vr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lr.logLevel<=r.ERROR){var i=t.map($r);Lr.error.apply(Lr,u(["Firestore ("+Pr+"): "+e],i))}}function $r(e){if("string"==typeof e)return e;var t=Wr.getPlatform();try{return t.formatJSON(e)}catch(t){return e}}function Ur(e){var t="FIRESTORE ("+Pr+") INTERNAL ASSERTION FAILED: "+e;throw Vr(t),new Error(t)}function jr(e,t){e||Ur(t)}(Nr=Dr=Dr||{})[Nr.DEBUG=0]="DEBUG",Nr[Nr.ERROR=1]="ERROR",Nr[Nr.SILENT=2]="SILENT";var Wr=(zr.setPlatform=function(e){zr.platform&&Ur("Platform already defined"),zr.platform=e},zr.getPlatform=function(){return zr.platform||Ur("Platform not set"),zr.platform},zr);function zr(){}function Kr(){return Wr.getPlatform().emptyByteString}var Gr,Qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Hr=(n(Yr,Gr=Error),Yr);function Yr(e,t){var n=Gr.call(this,t)||this;return n.code=e,n.message=t,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Xr(e,t){function n(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new Hr(Qr.INVALID_ARGUMENT,e)}for(var r in n.prototype=e.prototype,e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function Jr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Zr(e,t){return void 0!==e?e:t}function ei(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Number(n);isNaN(r)||t(r,e[n])}}function ti(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ni(e){for(var t in jr(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function ri(e,t){if(0!==t.length)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() does not support arguments, but was called with "+wi(t.length,"argument")+".")}function ii(e,t,n){if(t.length!==n)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires "+wi(n,"argument")+", but was called with "+wi(t.length,"argument")+".")}function oi(e,t,n){if(t.length<n)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires at least "+wi(n,"argument")+", but was called with "+wi(t.length,"argument")+".")}function ai(e,t,n,r){if(t.length<n||t.length>r)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+wi(t.length,"argument")+".")}function si(e,t,n,r){fi(e,t,bi(n)+" argument",r)}function ui(e,t,n,r){void 0!==r&&si(e,t,n,r)}function ci(e,t,n,r){fi(e,t,n+" option",r)}function li(e,t,n,r){void 0!==r&&ci(e,t,n,r)}function hi(e,t,n,r,i){void 0!==r&&function(e,t,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(di(u))}var c=di(r);throw new Hr(Qr.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(e,0,n,r,i)}function fi(e,t,n,r){if(!("object"===t?pi(r):"non-empty string"===t?"string"==typeof r&&""!==r:typeof r===t)){var i=di(r);throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+i)}}function pi(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function di(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ur("Unknown wrong type: "+typeof e);if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}function mi(e,t,n){if(void 0===n)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+bi(t)+" argument, but it was undefined.")}function gi(e,t,n){ti(t,(function(t,r){if(n.indexOf(t)<0)throw new Hr(Qr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+n.join(", "))}))}function yi(e,t,n,r){var i=di(r);return new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires its "+bi(n)+" argument to be a "+t+", but it was: "+i)}function vi(e,t,n){if(n<=0)throw new Hr(Qr.INVALID_ARGUMENT,'Function "'+e+'()" requires its '+bi(t)+" argument to be a positive number, but it was: "+n+".")}function bi(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function wi(e,t){return e+" "+t+(1===e?"":"s")}var Ti=(Ei.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<20;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return jr(20===t.length,"Invalid auto ID: "+t),t},Ei);function Ei(){}function Si(e,t){return e<t?-1:t<e?1:0}function Ii(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].isEqual(t[n]))return!1;return!0}function Ci(e){return e+"\0"}function Ai(){if("undefined"==typeof Uint8Array)throw new Hr(Qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Di(){if(!Wr.getPlatform().base64Available)throw new Hr(Qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ni=(ki.fromBase64String=function(e){ii("Blob.fromBase64String",arguments,1),si("Blob.fromBase64String","string",1,e),Di();try{return new ki(Wr.getPlatform().atob(e))}catch(e){throw new Hr(Qr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},ki.fromUint8Array=function(e){if(ii("Blob.fromUint8Array",arguments,1),Ai(),!(e instanceof Uint8Array))throw yi("Blob.fromUint8Array","Uint8Array",1,e);return new ki(Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join(""))},ki.prototype.toBase64=function(){return ii("Blob.toBase64",arguments,0),Di(),Wr.getPlatform().btoa(this._binaryString)},ki.prototype.toUint8Array=function(){ii("Blob.toUint8Array",arguments,0),Ai();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},ki.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ki.prototype.isEqual=function(e){return this._binaryString===e._binaryString},ki.prototype._approximateByteSize=function(){return 2*this._binaryString.length},ki.prototype._compareTo=function(e){return Si(this._binaryString,e._binaryString)},ki);function ki(e){Di(),this._binaryString=e}var _i=Xr(Ni,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),xi=function(e,t,n,r,i){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i},Ri="(default)",Mi=(Object.defineProperty(Oi.prototype,"isDefaultDatabase",{get:function(){return this.database===Ri},enumerable:!0,configurable:!0}),Oi.prototype.isEqual=function(e){return e instanceof Oi&&e.projectId===this.projectId&&e.database===this.database},Oi.prototype.compareTo=function(e){return Si(this.projectId,e.projectId)||Si(this.database,e.database)},Oi);function Oi(e,t){this.projectId=e,this.database=t||Ri}var Pi=(Li.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},Li.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},Li.INVALID=-1,Li);function Li(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}var Fi="__name__",Bi=(Object.defineProperty(qi.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),qi.prototype.isEqual=function(e){return 0===qi.comparator(this,e)},qi.prototype.child=function(e){var t=this.segments.slice(this.offset,this.limit());return e instanceof qi?e.forEach((function(e){t.push(e)})):t.push(e),this.construct(t)},qi.prototype.limit=function(){return this.offset+this.length},qi.prototype.popFirst=function(e){return e=void 0===e?1:e,jr(this.length>=e,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},qi.prototype.popLast=function(){return jr(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},qi.prototype.firstSegment=function(){return jr(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},qi.prototype.lastSegment=function(){return this.get(this.length-1)},qi.prototype.get=function(e){return jr(e<this.length,"Index out of range"),this.segments[this.offset+e]},qi.prototype.isEmpty=function(){return 0===this.length},qi.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},qi.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},qi.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},qi.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},qi.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(o<i)return 1}return e.length<t.length?-1:e.length>t.length?1:0},qi);function qi(e,t,n){void 0===t?t=0:t>e.length&&Ur("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&Ur("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n}var Vi,$i=(n(Ui,Vi=Bi),Ui.prototype.construct=function(e,t,n){return new Ui(e,t,n)},Ui.prototype.canonicalString=function(){return this.toArray().join("/")},Ui.prototype.toString=function(){return this.canonicalString()},Ui.fromString=function(e){if(0<=e.indexOf("//"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new Ui(e.split("/").filter((function(e){return 0<e.length})))},Ui.EMPTY_PATH=new Ui([]),Ui);function Ui(){return null!==Vi&&Vi.apply(this,arguments)||this}var ji,Wi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zi=(n(Ki,ji=Bi),Ki.prototype.construct=function(e,t,n){return new Ki(e,t,n)},Ki.isValidIdentifier=function(e){return Wi.test(e)},Ki.prototype.canonicalString=function(){return this.toArray().map((function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),Ki.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")},Ki.prototype.toString=function(){return this.canonicalString()},Ki.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===Fi},Ki.keyField=function(){return new Ki([Fi])},Ki.fromServerFormat=function(e){for(var t=[],n="",r=0,i=function(){if(0===n.length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");t.push(n),n=""},o=!1;r<e.length;){var a=e[r];if("\\"===a){if(r+1===e.length)throw new Hr(Qr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[r+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Hr(Qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=s,r+=2}else"`"===a?o=!o:"."!==a||o?n+=a:i(),r++}if(i(),o)throw new Hr(Qr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ki(t)},Ki.EMPTY_PATH=new Ki([]),Ki);function Ki(){return null!==ji&&ji.apply(this,arguments)||this}var Gi=(Qi.prototype.hasCollectionId=function(e){return 2<=this.path.length&&this.path.get(this.path.length-2)===e},Qi.prototype.isEqual=function(e){return null!==e&&0===$i.comparator(this.path,e.path)},Qi.prototype.toString=function(){return this.path.toString()},Qi.comparator=function(e,t){return $i.comparator(e.path,t.path)},Qi.isDocumentKey=function(e){return e.length%2==0},Qi.fromSegments=function(e){return new Qi(new $i(e.slice()))},Qi.fromPathString=function(e){return new Qi($i.fromString(e))},Qi.EMPTY=new Qi(new $i([])),Qi);function Qi(e){this.path=e,jr(Qi.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}var Hi,Yi,Xi=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};(Yi=Hi=Hi||{}).All="all",Yi.ListenStreamIdle="listen_stream_idle",Yi.ListenStreamConnectionBackoff="listen_stream_connection_backoff",Yi.WriteStreamIdle="write_stream_idle",Yi.WriteStreamConnectionBackoff="write_stream_connection_backoff",Yi.OnlineStateTimeout="online_state_timeout",Yi.ClientMetadataRefresh="client_metadata_refresh",Yi.LruGarbageCollection="lru_garbage_collection",Yi.RetryTransaction="retry_transaction";var Ji=(Zi.createAndSchedule=function(e,t,n,r,i){var o=new Zi(e,t,Date.now()+n,r,i);return o.start(n),o},Zi.prototype.start=function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)},Zi.prototype.skipDelay=function(){return this.handleDelayElapsed()},Zi.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Hr(Qr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},Zi.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))},Zi.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},Zi);function Zi(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Xi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}var eo=(Object.defineProperty(to.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),to.prototype.enqueueAndForget=function(e){this.enqueue(e)},to.prototype.enqueueAndForgetEvenAfterShutdown=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},to.prototype.enqueueEvenAfterShutdown=function(e){return this.verifyNotFailed(),this.enqueueInternal(e)},to.prototype.enqueueAndInitiateShutdown=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},to.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(e){})):this.enqueueInternal(e)},to.prototype.enqueueInternal=function(e){var t=this,n=this.tail.then((function(){return t.operationInProgress=!0,e().catch((function(e){t.failure=e,t.operationInProgress=!1;var n=e.stack||e.message||"";throw Vr("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw e}),0),e})).then((function(e){return t.operationInProgress=!1,e}))}));return this.tail=n},to.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),jr(0<=t,"Attempted to schedule an operation with a negative delay of "+t),-1<this.timerIdsToSkip.indexOf(e)&&(t=0);var i=Ji.createAndSchedule(this,e,t,n,(function(e){return r.removeDelayedOperation(e)}));return this.delayedOperations.push(i),i},to.prototype.verifyNotFailed=function(){this.failure&&Ur("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},to.prototype.verifyOperationInProgress=function(){jr(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},to.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},to.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},to.prototype.runDelayedOperationsEarly=function(e){var t=this;return this.drain().then((function(){jr(e===Hi.All||t.containsDelayedOperation(e),"Attempted to drain to missing operation "+e),t.delayedOperations.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));for(var n=0,r=t.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),e!==Hi.All&&i.timerId===e)break}return t.drain()}))},to.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},to.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);jr(0<=t,"Delayed operation not found."),this.delayedOperations.splice(t,1)},to);function to(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}function no(e){for(var t="",n=0;n<e.length;n++)0<t.length&&(t=io(t)),t=ro(e.get(n),t);return io(t)}function ro(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function io(e){return e+""}function oo(e){var t=e.length;if(jr(2<=t,"Invalid path "+e),2===t)return jr(""===e.charAt(0)&&""===e.charAt(1),"Non-empty path "+e+" had length 2"),$i.EMPTY_PATH;for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf("",o);switch((a<0||n<a)&&Ur('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case"":var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=e.substring(o,a),i+="\0";break;case"":i+=e.substring(o,a+1);break;default:Ur('Invalid encoded resource path: "'+e+'"')}o=a+2}return new $i(r)}var ao=(so.now=function(){return so.fromMillis(Date.now())},so.fromDate=function(e){return so.fromMillis(e.getTime())},so.fromMillis=function(e){var t=Math.floor(e/1e3);return new so(t,1e6*(e-1e3*t))},so.prototype.toDate=function(){return new Date(this.toMillis())},so.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},so.prototype._compareTo=function(e){return this.seconds===e.seconds?Si(this.nanoseconds,e.nanoseconds):Si(this.seconds,e.seconds)},so.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},so.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},so);function so(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}var uo=(co.fromMicroseconds=function(e){var t=Math.floor(e/1e6);return new co(new ao(t,e%1e6*1e3))},co.fromTimestamp=function(e){return new co(e)},co.forDeletedDoc=function(){return co.MIN},co.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},co.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},co.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},co.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},co.prototype.toTimestamp=function(){return this.timestamp},co.MIN=new co(new ao(0,0)),co);function co(e){this.timestamp=e}var lo=(ho.prototype.insert=function(e,t){return new ho(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mo.BLACK,null,null))},ho.prototype.remove=function(e){return new ho(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mo.BLACK,null,null))},ho.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:0<n&&(t=t.right)}return null},ho.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;n=r<0?n.left:(t+=n.left.size+1,n.right)}return-1},ho.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(ho.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),ho.prototype.minKey=function(){return this.root.minKey()},ho.prototype.maxKey=function(){return this.root.maxKey()},ho.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},ho.prototype.forEach=function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))},ho.prototype.toString=function(){var e=[];return this.inorderTraversal((function(t,n){return e.push(t+":"+n),!1})),"{"+e.join(", ")+"}"},ho.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},ho.prototype.getIterator=function(){return new fo(this.root,null,this.comparator,!1)},ho.prototype.getIteratorFrom=function(e){return new fo(this.root,e,this.comparator,!1)},ho.prototype.getReverseIterator=function(){return new fo(this.root,null,this.comparator,!0)},ho.prototype.getReverseIteratorFrom=function(e){return new fo(this.root,e,this.comparator,!0)},ho);function ho(e,t){this.comparator=e,this.root=t||mo.EMPTY}var fo=(po.prototype.getNext=function(){jr(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},po.prototype.hasNext=function(){return 0<this.nodeStack.length},po.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},po);function po(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}var mo=(go.prototype.copy=function(e,t,n,r,i){return new go(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},go.prototype.isEmpty=function(){return!1},go.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},go.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},go.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},go.prototype.minKey=function(){return this.min().key},go.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},go.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},go.prototype.removeMin=function(){if(this.left.isEmpty())return go.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},go.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return go.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()},go.prototype.isRed=function(){return this.color},go.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},go.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},go.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},go.prototype.rotateLeft=function(){var e=this.copy(null,null,go.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},go.prototype.rotateRight=function(){var e=this.copy(null,null,go.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},go.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},go.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},go.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Ur("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw Ur("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw Ur("Black depths differ");return e+(this.isRed()?0:1)},go.EMPTY=null,go.RED=!0,go.BLACK=!1,go);function go(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:go.RED,this.left=null!=r?r:go.EMPTY,this.right=null!=i?i:go.EMPTY,this.size=this.left.size+1+this.right.size}var yo=(Object.defineProperty(vo.prototype,"key",{get:function(){throw Ur("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"value",{get:function(){throw Ur("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"color",{get:function(){throw Ur("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"left",{get:function(){throw Ur("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"right",{get:function(){throw Ur("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),vo.prototype.copy=function(e,t,n,r,i){return this},vo.prototype.insert=function(e,t,n){return new mo(e,t)},vo.prototype.remove=function(e,t){return this},vo.prototype.isEmpty=function(){return!0},vo.prototype.inorderTraversal=function(e){return!1},vo.prototype.reverseTraversal=function(e){return!1},vo.prototype.minKey=function(){return null},vo.prototype.maxKey=function(){return null},vo.prototype.isRed=function(){return!1},vo.prototype.checkMaxDepth=function(){return!0},vo.prototype.check=function(){return 0},vo);function vo(){this.size=0}mo.EMPTY=new yo;var bo=(wo.fromMapKeys=function(e){var t=new wo(e.comparator);return e.forEach((function(e){t=t.add(e)})),t},wo.prototype.has=function(e){return null!==this.data.get(e)},wo.prototype.first=function(){return this.data.minKey()},wo.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(wo.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),wo.prototype.indexOf=function(e){return this.data.indexOf(e)},wo.prototype.forEach=function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))},wo.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,e[1]))return;t(r.key)}},wo.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},wo.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},wo.prototype.getIterator=function(){return new To(this.data.getIterator())},wo.prototype.getIteratorFrom=function(e){return new To(this.data.getIteratorFrom(e))},wo.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},wo.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},wo.prototype.isEmpty=function(){return this.data.isEmpty()},wo.prototype.unionWith=function(e){var t=this;return e.forEach((function(e){t=t.add(e)})),t},wo.prototype.isEqual=function(e){if(!(e instanceof wo))return!1;if(this.size!==e.size)return!1;for(var t=this.data.getIterator(),n=e.data.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},wo.prototype.toArray=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},wo.prototype.toString=function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"},wo.prototype.copy=function(e){var t=new wo(this.comparator);return t.data=e,t},wo);function wo(e){this.comparator=e,this.data=new lo(this.comparator)}var To=(Eo.prototype.getNext=function(){return this.iter.getNext().key},Eo.prototype.hasNext=function(){return this.iter.hasNext()},Eo);function Eo(e){this.iter=e}var So=new lo(Gi.comparator);function Io(){return So}function Co(){return Io()}var Ao=new lo(Gi.comparator);function Do(){return Ao}var No=new lo(Gi.comparator);function ko(){return No}var _o=new bo(Gi.comparator);function xo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=_o,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ro=new bo(Si);function Mo(){return Ro}var Oo=(Po.prototype.applyToRemoteDocument=function(e,t,n){t&&jr(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;jr(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(e)){var a=r[i];t=o.applyToRemoteDocument(t,a)}}return t},Po.prototype.applyToLocalView=function(e,t){t&&jr(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(e)&&(t=s.applyToLocalView(t,t,this.localWriteTime));for(var i=t,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(e)&&(t=s.applyToLocalView(t,i,this.localWriteTime))}return t},Po.prototype.applyToLocalDocumentSet=function(e){var t=this,n=e;return this.mutations.forEach((function(r){var i=t.applyToLocalView(r.key,e.get(r.key));i&&(n=n.insert(r.key,i))})),n},Po.prototype.keys=function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),xo())},Po.prototype.isEqual=function(e){return this.batchId===e.batchId&&Ii(this.mutations,e.mutations)&&Ii(this.baseMutations,e.baseMutations)},Po);function Po(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,jr(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}var Lo=(Fo.from=function(e,t,n,r){jr(e.mutations.length===n.length,"Mutations sent "+e.mutations.length+" must equal results received "+n.length);for(var i=ko(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new Fo(e,t,n,r,i)},Fo);function Fo(e,t,n,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.streamToken=r,this.docVersions=i}var Bo=(qo.prototype.catch=function(e){return this.next(void 0,e)},qo.prototype.next=function(e,t){var n=this;return this.callbackAttached&&Ur("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new qo((function(r,i){n.nextCallback=function(t){n.wrapSuccess(e,t).next(r,i)},n.catchCallback=function(e){n.wrapFailure(t,e).next(r,i)}}))},qo.prototype.toPromise=function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))},qo.prototype.wrapUserFunction=function(e){try{var t=e();return t instanceof qo?t:qo.resolve(t)}catch(e){return qo.reject(e)}},qo.prototype.wrapSuccess=function(e,t){return e?this.wrapUserFunction((function(){return e(t)})):qo.resolve(t)},qo.prototype.wrapFailure=function(e,t){return e?this.wrapUserFunction((function(){return e(t)})):qo.reject(t)},qo.resolve=function(e){return new qo((function(t,n){t(e)}))},qo.reject=function(e){return new qo((function(t,n){n(e)}))},qo.waitFor=function(e){return new qo((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(e){return n(e)}))})),o=!0,i===r&&t()}))},qo.or=function(e){for(var t=qo.resolve(!1),n=function(e){t=t.next((function(t){return t?qo.resolve(t):e()}))},r=0,i=e;r<i.length;r++)n(i[r]);return t},qo.forEach=function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)},qo);function qo(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)}),(function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)}))}var Vo="SimpleDb",$o=(Uo.openOrCreate=function(e,t,n){return jr(Uo.isAvailable(),"IndexedDB not supported in current environment."),qr(Vo,"Opening database:",e),new Bo((function(r,i){var o=window.indexedDB.open(e,t);o.onsuccess=function(e){var t=e.target.result;r(new Uo(t))},o.onblocked=function(){i(new Hr(Qr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=function(e){var t=e.target.error;"VersionError"===t.name?i(new Hr(Qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i(t)},o.onupgradeneeded=function(t){qr(Vo,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var r=t.target.result;n.createOrUpgrade(r,o.transaction,t.oldVersion,cu).next((function(){qr(Vo,"Database upgrade to version "+cu+" complete")}))}})).toPromise()},Uo.delete=function(e){return qr(Vo,"Removing database:",e),Ho(window.indexedDB.deleteDatabase(e)).toPromise()},Uo.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(Uo.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var e=d(),t=Uo.getIOSVersion(e),n=0<t&&t<10,r=Uo.getAndroidVersion(e),i=0<r&&r<4.5;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||n||i)},Uo.isMockPersistence=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},Uo.getStore=function(e,t){return e.store(t)},Uo.getIOSVersion=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Uo.getAndroidVersion=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Uo.prototype.setVersionChangeListener=function(e){this.db.onversionchange=function(t){return e(t)}},Uo.prototype.runTransaction=function(e,t,n){return a(this,void 0,void 0,(function(){var r,i,o,a,u,c;return s(this,(function(l){switch(l.label){case 0:r=e.startsWith("readonly"),i=e.endsWith("idempotent"),o=0,a=function(){var e,a,c,l;return s(this,(function(s){switch(s.label){case 0:++o,e=zo.open(u.db,r?"readonly":"readwrite",t),s.label=1;case 1:return s.trys.push([1,3,,4]),(a=n(e).catch((function(t){return e.abort(t),Bo.reject(t)})).toPromise()).catch((function(){})),[4,e.completionPromise];case 2:return s.sent(),[2,{value:a}];case 3:return c=s.sent(),l=i&&"FirebaseError"!==c.name&&o<3,qr(Vo,"Transaction failed with error: %s. Retrying: %s.",c.message,l),l?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}}))},u=this,l.label=1;case 1:return[5,a()];case 2:return"object"==typeof(c=l.sent())?[2,c.value]:[3,1];case 3:return[2]}}))}))},Uo.prototype.close=function(){this.db.close()},Uo);function Uo(e){this.db=e,12.2===Uo.getIOSVersion(d())&&Vr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}var jo=(Object.defineProperty(Wo.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(Wo.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(Wo.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),Wo.prototype.done=function(){this.shouldStop=!0},Wo.prototype.skip=function(e){this.nextKey=e},Wo.prototype.delete=function(){return Ho(this.dbCursor.delete())},Wo);function Wo(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}var zo=(Ko.open=function(e,t,n){return new Ko(e.transaction(n,t))},Object.defineProperty(Ko.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),Ko.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(qr(Vo,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ko.prototype.store=function(e){var t=this.transaction.objectStore(e);return jr(!!t,"Object store not part of transaction: "+e),new Go(t)},Ko);function Ko(e){var t=this;this.transaction=e,this.aborted=!1,this.completionDeferred=new Xi,this.transaction.oncomplete=function(){t.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?t.completionDeferred.reject(e.error):t.completionDeferred.resolve()},this.transaction.onerror=function(e){var n=Xo(e.target.error);t.completionDeferred.reject(n)}}var Go=(Qo.prototype.put=function(e,t){return Ho(void 0!==t?(qr(Vo,"PUT",this.store.name,e,t),this.store.put(t,e)):(qr(Vo,"PUT",this.store.name,"<auto-key>",e),this.store.put(e)))},Qo.prototype.add=function(e){return qr(Vo,"ADD",this.store.name,e,e),Ho(this.store.add(e))},Qo.prototype.get=function(e){var t=this;return Ho(this.store.get(e)).next((function(n){return void 0===n&&(n=null),qr(Vo,"GET",t.store.name,e,n),n}))},Qo.prototype.delete=function(e){return qr(Vo,"DELETE",this.store.name,e),Ho(this.store.delete(e))},Qo.prototype.count=function(){return qr(Vo,"COUNT",this.store.name),Ho(this.store.count())},Qo.prototype.loadAll=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.iterateCursor(n,(function(e,t){r.push(t)})).next((function(){return r}))},Qo.prototype.deleteAll=function(e,t){qr(Vo,"DELETE ALL",this.store.name);var n=this.options(e,t);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(e,t,n){return n.delete()}))},Qo.prototype.iterate=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.iterateCursor(r,t)},Qo.prototype.iterateSerial=function(e){var t=this.cursor({});return new Bo((function(n,r){t.onerror=function(e){var t=Xo(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))},Qo.prototype.iterateCursor=function(e,t){var n=[];return new Bo((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new jo(i),a=t(i.primaryKey,i.value,o);if(a instanceof Bo){var s=a.catch((function(e){return o.done(),Bo.reject(e)}));n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}})).next((function(){return Bo.waitFor(n)}))},Qo.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(jr(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},Qo.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},Qo);function Qo(e){this.store=e}function Ho(e){return new Bo((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Xo(e.target.error);n(t)}}))}var Yo=!1;function Xo(e){var t=$o.getIOSVersion(d());if(12.2<=t&&t<13){var n="An internal error was encountered in the Indexed Database server";if(0<=e.message.indexOf(n)){var r=new Hr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Yo||(Yo=!0,setTimeout((function(){throw r}),0)),r}}return e}var Jo,Zo,ea=(ta.forUser=function(e,t,n,r){return jr(""!==e.uid,"UserID must not be an empty string."),new ta(e.isAuthenticated()?e.uid:"",t,n,r)},ta.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oa(e).iterate({index:yu.userMutationsIndex,range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))},ta.prototype.acknowledgeBatch=function(e,t,n){return this.getMutationQueueMetadata(e).next((function(t){return t.lastStreamToken=ia(n),sa(e).put(t)}))},ta.prototype.getLastStreamToken=function(e){return this.getMutationQueueMetadata(e).next((function(e){return e.lastStreamToken}))},ta.prototype.setLastStreamToken=function(e,t){return this.getMutationQueueMetadata(e).next((function(n){return n.lastStreamToken=ia(t),sa(e).put(n)}))},ta.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=aa(e),a=oa(e);return a.add({}).next((function(s){jr("number"==typeof s,"Auto-generated key is not a number");for(var u=new Oo(s,t,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),l=[],h=new bo((function(e,t){return Si(e.canonicalString(),t.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],m=bu.key(i.userId,d.key.path,s);h=h.add(d.key.path.popLast()),l.push(a.put(c)),l.push(o.put(m,bu.PLACEHOLDER))}return h.forEach((function(t){l.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.documentKeysByBatchId[s]=u.keys()})),Bo.waitFor(l).next((function(){return u}))}))},ta.prototype.lookupMutationBatch=function(e,t){var n=this;return oa(e).get(t).next((function(e){return e?(jr(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),n.serializer.fromDbMutationBatch(e)):null}))},ta.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?Bo.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.documentKeysByBatchId[t]=r}return null}))},ta.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return oa(e).iterate({index:yu.userMutationsIndex,range:i},(function(e,t,i){t.userId===n.userId&&(jr(t.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(t)),i.done()})).next((function(){return o}))},ta.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return oa(e).iterate({index:yu.userMutationsIndex,range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))},ta.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oa(e).loadAll(yu.userMutationsIndex,n).next((function(e){return e.map((function(e){return t.serializer.fromDbMutationBatch(e)}))}))},ta.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=bu.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return aa(e).iterate({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=oo(u);if(s===n.userId&&t.path.isEqual(l))return oa(e).get(c).next((function(e){if(!e)throw Ur("Dangling document-mutation reference found: "+r+" which points to "+c);jr(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(e))}));a.done()})).next((function(){return o}))},ta.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new bo(Si),i=[];return t.forEach((function(t){var o=bu.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=aa(e).iterate({range:a},(function(e,i,o){var a=e[0],s=e[1],u=e[2],c=oo(s);a===n.userId&&t.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),Bo.waitFor(i).next((function(){return n.lookupMutationBatches(e,r)}))},ta.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this;jr(!t.isDocumentQuery(),"Document queries shouldn't go down this path"),jr(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=t.path,i=r.length+1,o=bu.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new bo(Si);return aa(e).iterate({range:a},(function(e,t,o){var a=e[0],u=e[1],c=e[2],l=oo(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.lookupMutationBatches(e,s)}))},ta.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(oa(e).get(t).next((function(e){if(null===e)throw Ur("Dangling document-mutation reference found, which points to "+t);jr(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(n.serializer.fromDbMutationBatch(e))})))})),Bo.waitFor(i).next((function(){return r}))},ta.prototype.removeMutationBatch=function(e,t){var n=this;return ra(e.simpleDbTransaction,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.removeCachedMutationKeys(t.batchId)})),Bo.forEach(r,(function(t){return n.referenceDelegate.removeMutationReference(e,t)}))}))},ta.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},ta.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Bo.resolve();var r=IDBKeyRange.lowerBound(bu.prefixForUser(t.userId)),i=[];return aa(e).iterate({range:r},(function(e,n,r){if(e[0]===t.userId){var o=oo(e[1]);i.push(o)}else r.done()})).next((function(){jr(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(e){return e.canonicalString()})))}))}))},ta.prototype.containsKey=function(e,t){return na(e,this.userId,t)},ta.prototype.getMutationQueueMetadata=function(e){var t=this;return sa(e).get(this.userId).next((function(e){return e||new mu(t.userId,-1,"")}))},ta);function ta(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}function na(e,t,n){var r=bu.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return aa(e).iterate({range:o,keysOnly:!0},(function(e,n,r){var o=e[0],s=e[1];e[2],o===t&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function ra(e,t,n){var r=e.store(yu.store),i=e.store(bu.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(e,t,n){return s++,n.delete()}));o.push(u.next((function(){jr(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=bu.key(t,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Bo.waitFor(o).next((function(){return c}))}function ia(e){return e instanceof Uint8Array?(jr($o.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),e.toString()):e}function oa(e){return Ec.getStore(e,yu.store)}function aa(e){return Ec.getStore(e,bu.store)}function sa(e){return Ec.getStore(e,mu.store)}(Zo=Jo=Jo||{})[Zo.QueryCache=0]="QueryCache",Zo[Zo.SyncEngine=1]="SyncEngine";var ua=(ca.prototype.next=function(){var e=this.nextId;return this.nextId+=2,e},ca.prototype.after=function(e){return this.seek(e+2),this.next()},ca.prototype.seek=function(e){jr((1&e)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=e},ca.forTargetCache=function(){return new ca(Jo.QueryCache,2)},ca.forSyncEngine=function(){return new ca(Jo.SyncEngine)},ca);function ca(e,t){jr((1&(this.generatorId=e))===e,"Generator ID "+e+" contains more than 1 reserved bits"),this.seek(void 0!==t?t:this.generatorId)}var la=(ha.prototype.allocateTargetId=function(e){var t=this;return this.retrieveMetadata(e).next((function(n){return n.highestTargetId=t.targetIdGenerator.after(n.highestTargetId),t.saveMetadata(e,n).next((function(){return n.highestTargetId}))}))},ha.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next((function(e){return uo.fromTimestamp(new ao(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))},ha.prototype.getHighestSequenceNumber=function(e){return da(e.simpleDbTransaction)},ha.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.retrieveMetadata(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.saveMetadata(e,i)}))},ha.prototype.addTargetData=function(e,t){var n=this;return this.saveTargetData(e,t).next((function(){return n.retrieveMetadata(e).next((function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(t,r),n.saveMetadata(e,r)}))}))},ha.prototype.updateTargetData=function(e,t){return this.saveTargetData(e,t)},ha.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return fa(e).delete(t.targetId)})).next((function(){return n.retrieveMetadata(e)})).next((function(t){return jr(0<t.targetCount,"Removing from an empty target cache"),t.targetCount-=1,n.saveMetadata(e,t)}))},ha.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return fa(e).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(e,u)))})).next((function(){return Bo.waitFor(o)})).next((function(){return i}))},ha.prototype.forEachTarget=function(e,t){var n=this;return fa(e).iterate((function(e,r){var i=n.serializer.fromDbTarget(r);t(i)}))},ha.prototype.retrieveMetadata=function(e){return pa(e.simpleDbTransaction)},ha.prototype.saveMetadata=function(e,t){return function(e){return Ec.getStore(e,xu.store)}(e).put(xu.key,t)},ha.prototype.saveTargetData=function(e,t){return fa(e).put(this.serializer.toDbTarget(t))},ha.prototype.updateMetadataFromTargetData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},ha.prototype.getTargetCount=function(e){return this.retrieveMetadata(e).next((function(e){return e.targetCount}))},ha.prototype.getTargetData=function(e,t){var n=this,r=t.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return fa(e).iterate({range:i,index:Du.queryTargetsIndexName},(function(e,r,i){var a=n.serializer.fromDbTarget(r);t.isEqual(a.target)&&(o=a,i.done())})).next((function(){return o}))},ha.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=ma(e);return t.forEach((function(t){var a=no(t.path);i.push(o.put(new ku(n,a))),i.push(r.referenceDelegate.addReference(e,t))})),Bo.waitFor(i)},ha.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=ma(e);return Bo.forEach(t,(function(t){var o=no(t.path);return Bo.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,t)])}))},ha.prototype.removeMatchingKeysForTargetId=function(e,t){var n=ma(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},ha.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ma(e),i=xo();return r.iterate({range:n,keysOnly:!0},(function(e,t,n){var r=oo(e[1]),o=new Gi(r);i=i.add(o)})).next((function(){return i}))},ha.prototype.containsKey=function(e,t){var n=no(t.path),r=IDBKeyRange.bound([n],[Ci(n)],!1,!0),i=0;return ma(e).iterate({index:ku.documentTargetsIndex,keysOnly:!0,range:r},(function(e,t,n){var r=e[0];e[1],0!==r&&(i++,n.done())})).next((function(){return 0<i}))},ha.prototype.getTargetDataForTarget=function(e,t){var n=this;return fa(e).get(t).next((function(e){return e?n.serializer.fromDbTarget(e):null}))},ha);function ha(e,t){this.referenceDelegate=e,this.serializer=t,this.targetIdGenerator=ua.forTargetCache()}function fa(e){return Ec.getStore(e,Du.store)}function pa(e){return $o.getStore(e,xu.store).get(xu.key).next((function(e){return jr(null!==e,"Missing metadata row."),e}))}function da(e){return pa(e).next((function(e){return e.highestListenSequenceNumber}))}function ma(e){return Ec.getStore(e,ku.store)}var ga=(ya.fromSet=function(e){return new ya(e)},ya.fromArray=function(e){var t=new bo(zi.comparator);return e.forEach((function(e){return t=t.add(e)})),new ya(t)},ya.prototype.covers=function(e){var t=!1;return this.fields.forEach((function(n){n.isPrefixOf(e)&&(t=!0)})),t},ya.prototype.isEqual=function(e){return this.fields.isEqual(e.fields)},ya);function ya(e){this.fields=e}var va=(ba.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},ba);function ba(e,t){this.field=e,this.transform=t}var wa,Ta,Ea=function(e,t){this.version=e,this.transformResults=t};(Ta=wa=wa||{})[Ta.Set=0]="Set",Ta[Ta.Patch=1]="Patch",Ta[Ta.Transform=2]="Transform",Ta[Ta.Delete=3]="Delete",Ta[Ta.Verify=4]="Verify";var Sa=(Ia.exists=function(e){return new Ia(void 0,e)},Ia.updateTime=function(e){return new Ia(e)},Object.defineProperty(Ia.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Ia.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof qs&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===e instanceof qs:(jr(this.isNone,"Precondition should be empty"),!0)},Ia.prototype.isEqual=function(e){return function(e,t){return null!=e?!(!t||!e.isEqual(t)):e===t}(this.updateTime,e.updateTime)&&this.exists===e.exists},Ia.NONE=new Ia,Ia);function Ia(e,t){this.updateTime=e,this.exists=t,jr(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}var Ca=(Aa.prototype.verifyKeyMatches=function(e){null!=e&&jr(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},Aa.getPostMutationVersion=function(e){return e instanceof qs?e.version:uo.MIN},Aa);function Aa(){}var Da,Na=(n(ka,Da=Ca),ka.prototype.applyToRemoteDocument=function(e,t){this.verifyKeyMatches(e),jr(null==t.transformResults,"Transform results received by SetMutation.");var n=t.version;return new qs(this.key,n,{hasCommittedMutations:!0},this.value)},ka.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=Ca.getPostMutationVersion(e);return new qs(this.key,r,{hasLocalMutations:!0},this.value)},ka.prototype.extractBaseValue=function(e){return null},ka.prototype.isEqual=function(e){return e instanceof ka&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},ka);function ka(e,t,n){var r=Da.call(this)||this;return r.key=e,r.value=t,r.precondition=n,r.type=wa.Set,r}var _a,xa=(n(Ra,_a=Ca),Ra.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),jr(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return new zs(this.key,t.version);var n=this.patchDocument(e);return new qs(this.key,t.version,{hasCommittedMutations:!0},n)},Ra.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=Ca.getPostMutationVersion(e),i=this.patchDocument(e);return new qs(this.key,r,{hasLocalMutations:!0},i)},Ra.prototype.extractBaseValue=function(e){return null},Ra.prototype.isEqual=function(e){return e instanceof Ra&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},Ra.prototype.patchDocument=function(e){var t;return t=e instanceof qs?e.data():xs.EMPTY,this.patchObject(t)},Ra.prototype.patchObject=function(e){var t=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e=null!==r?e.set(n,r):e.delete(n)}})),e},Ra);function Ra(e,t,n,r){var i=_a.call(this)||this;return i.key=e,i.data=t,i.fieldMask=n,i.precondition=r,i.type=wa.Patch,i}var Ma,Oa=(n(Pa,Ma=Ca),Pa.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),jr(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return new zs(this.key,t.version);var n=this.requireDocument(e),r=this.serverTransformResults(e,t.transformResults),i=t.version,o=this.transformObject(n.data(),r);return new qs(this.key,i,{hasCommittedMutations:!0},o)},Pa.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=this.requireDocument(e),i=this.localTransformResults(n,e,t),o=this.transformObject(r.data(),i);return new qs(this.key,r.version,{hasLocalMutations:!0},o)},Pa.prototype.extractBaseValue=function(e){for(var t=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=e instanceof qs?e.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(t=null==t?xs.EMPTY.set(i.field,a):t.set(i.field,a))}return t},Pa.prototype.isEqual=function(e){return e instanceof Pa&&this.key.isEqual(e.key)&&Ii(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},Pa.prototype.requireDocument=function(e){return jr(e instanceof qs,"Unknown MaybeDocument type "+e),jr(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},Pa.prototype.serverTransformResults=function(e,t){var n=[];jr(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<t.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;e instanceof qs&&(a=e.field(i.field)),n.push(o.applyToRemoteDocument(a,t[r]))}return n},Pa.prototype.localTransformResults=function(e,t,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;t instanceof qs&&(u=t.field(a.field)),null===u&&n instanceof qs&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,e))}return r},Pa.prototype.transformObject=function(e,t){jr(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;e=e.set(r,t[n])}return e},Pa);function Pa(e,t){var n=Ma.call(this)||this;return n.key=e,n.fieldTransforms=t,n.type=wa.Transform,n.precondition=Sa.exists(!0),n}var La,Fa=(n(Ba,La=Ca),Ba.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),jr(null==t.transformResults,"Transform results received by DeleteMutation."),new Us(this.key,t.version,{hasCommittedMutations:!0})},Ba.prototype.applyToLocalView=function(e,t,n){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&jr(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Us(this.key,uo.forDeletedDoc())):e},Ba.prototype.extractBaseValue=function(e){return null},Ba.prototype.isEqual=function(e){return e instanceof Ba&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},Ba);function Ba(e,t){var n=La.call(this)||this;return n.key=e,n.precondition=t,n.type=wa.Delete,n}var qa,Va,$a,Ua,ja,Wa=(n(za,qa=Ca),za.prototype.applyToRemoteDocument=function(e,t){Ur("VerifyMutation should only be used in Transactions.")},za.prototype.applyToLocalView=function(e,t,n){Ur("VerifyMutation should only be used in Transactions.")},za.prototype.extractBaseValue=function(e){Ur("VerifyMutation should only be used in Transactions.")},za.prototype.isEqual=function(e){return e instanceof za&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},za);function za(e,t){var n=qa.call(this)||this;return n.key=e,n.precondition=t,n.type=wa.Verify,n}($a=Va=Va||{})[$a.NullValue=0]="NullValue",$a[$a.BooleanValue=1]="BooleanValue",$a[$a.NumberValue=2]="NumberValue",$a[$a.TimestampValue=3]="TimestampValue",$a[$a.StringValue=4]="StringValue",$a[$a.BlobValue=5]="BlobValue",$a[$a.RefValue=6]="RefValue",$a[$a.GeoPointValue=7]="GeoPointValue",$a[$a.ArrayValue=8]="ArrayValue",$a[$a.ObjectValue=9]="ObjectValue",(ja=Ua=Ua||{})[ja.Default=0]="Default",ja[ja.Estimate=1]="Estimate",ja[ja.Previous=2]="Previous";var Ka=(Ga.fromSnapshotOptions=function(e,t){switch(e.serverTimestamps){case"estimate":return new Ga(Ua.Estimate,t);case"previous":return new Ga(Ua.Previous,t);case"none":case void 0:return new Ga(Ua.Default,t);default:return Ur("fromSnapshotOptions() called with invalid options.")}},Ga);function Ga(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}var Qa=(Ha.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},Ha.prototype.defaultCompareTo=function(e){return jr(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),Si(this.typeOrder,e.typeOrder)},Ha);function Ha(){}var Ya,Xa=(n(Ja,Ya=Qa),Ja.prototype.value=function(e){return null},Ja.prototype.isEqual=function(e){return e instanceof Ja},Ja.prototype.compareTo=function(e){return e instanceof Ja?0:this.defaultCompareTo(e)},Ja.prototype.approximateByteSize=function(){return 4},Ja.INSTANCE=new Ja,Ja);function Ja(){var e=Ya.call(this)||this;return e.typeOrder=Va.NullValue,e.internalValue=null,e}var Za,es=(n(ts,Za=Qa),ts.prototype.value=function(e){return this.internalValue},ts.prototype.isEqual=function(e){return e instanceof ts&&this.internalValue===e.internalValue},ts.prototype.compareTo=function(e){return e instanceof ts?Si(this,e):this.defaultCompareTo(e)},ts.prototype.approximateByteSize=function(){return 4},ts.of=function(e){return e?ts.TRUE:ts.FALSE},ts.TRUE=new ts(!0),ts.FALSE=new ts(!1),ts);function ts(e){var t=Za.call(this)||this;return t.internalValue=e,t.typeOrder=Va.BooleanValue,t}var ns,rs=(n(is,ns=Qa),is.prototype.value=function(e){return this.internalValue},is.prototype.compareTo=function(e){return e instanceof is?function(e,t){return e<t?-1:t<e?1:e===t?0:isNaN(e)?isNaN(t)?0:-1:1}(this.internalValue,e.internalValue):this.defaultCompareTo(e)},is.prototype.approximateByteSize=function(){return 8},is);function is(e){var t=ns.call(this)||this;return t.internalValue=e,t.typeOrder=Va.NumberValue,t}function os(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var as,ss=(n(us,as=rs),us.prototype.isEqual=function(e){return e instanceof us&&os(this.internalValue,e.internalValue)},us);function us(){return null!==as&&as.apply(this,arguments)||this}var cs,ls=(n(hs,cs=rs),hs.prototype.isEqual=function(e){return e instanceof hs&&os(this.internalValue,e.internalValue)},hs.NAN=new hs(NaN),hs.POSITIVE_INFINITY=new hs(1/0),hs.NEGATIVE_INFINITY=new hs(-1/0),hs);function hs(){return null!==cs&&cs.apply(this,arguments)||this}var fs,ps=(n(ds,fs=Qa),ds.prototype.value=function(e){return this.internalValue},ds.prototype.isEqual=function(e){return e instanceof ds&&this.internalValue===e.internalValue},ds.prototype.compareTo=function(e){return e instanceof ds?Si(this.internalValue,e.internalValue):this.defaultCompareTo(e)},ds.prototype.approximateByteSize=function(){return 2*this.internalValue.length},ds);function ds(e){var t=fs.call(this)||this;return t.internalValue=e,t.typeOrder=Va.StringValue,t}var ms,gs=(n(ys,ms=Qa),ys.prototype.value=function(e){return!e||e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},ys.prototype.isEqual=function(e){return e instanceof ys&&this.internalValue.isEqual(e.internalValue)},ys.prototype.compareTo=function(e){return e instanceof ys?this.internalValue._compareTo(e.internalValue):e instanceof bs?-1:this.defaultCompareTo(e)},ys.prototype.approximateByteSize=function(){return 16},ys);function ys(e){var t=ms.call(this)||this;return t.internalValue=e,t.typeOrder=Va.TimestampValue,t}var vs,bs=(n(ws,vs=Qa),ws.prototype.value=function(e){return e&&e.serverTimestampBehavior===Ua.Estimate?new gs(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===Ua.Previous&&this.previousValue?this.previousValue.value(e):null},ws.prototype.isEqual=function(e){return e instanceof ws&&this.localWriteTime.isEqual(e.localWriteTime)},ws.prototype.compareTo=function(e){return e instanceof ws?this.localWriteTime._compareTo(e.localWriteTime):e instanceof gs?1:this.defaultCompareTo(e)},ws.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},ws.prototype.approximateByteSize=function(){return 16+(this.previousValue?this.previousValue.approximateByteSize():0)},ws);function ws(e,t){var n=vs.call(this)||this;return n.localWriteTime=e,n.previousValue=t,n.typeOrder=Va.TimestampValue,n}var Ts,Es=(n(Ss,Ts=Qa),Ss.prototype.value=function(e){return this.internalValue},Ss.prototype.isEqual=function(e){return e instanceof Ss&&this.internalValue.isEqual(e.internalValue)},Ss.prototype.compareTo=function(e){return e instanceof Ss?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},Ss.prototype.approximateByteSize=function(){return this.internalValue._approximateByteSize()},Ss);function Ss(e){var t=Ts.call(this)||this;return t.internalValue=e,t.typeOrder=Va.BlobValue,t}var Is,Cs=(n(As,Is=Qa),As.prototype.value=function(e){return this.key},As.prototype.isEqual=function(e){return e instanceof As&&this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId)},As.prototype.compareTo=function(e){if(e instanceof As){var t=this.databaseId.compareTo(e.databaseId);return 0!==t?t:Gi.comparator(this.key,e.key)}return this.defaultCompareTo(e)},As.prototype.approximateByteSize=function(){return this.databaseId.projectId.length+this.databaseId.database.length+this.key.toString().length},As);function As(e,t){var n=Is.call(this)||this;return n.databaseId=e,n.key=t,n.typeOrder=Va.RefValue,n}var Ds,Ns=(n(ks,Ds=Qa),ks.prototype.value=function(e){return this.internalValue},ks.prototype.isEqual=function(e){return e instanceof ks&&this.internalValue.isEqual(e.internalValue)},ks.prototype.compareTo=function(e){return e instanceof ks?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},ks.prototype.approximateByteSize=function(){return 16},ks);function ks(e){var t=Ds.call(this)||this;return t.internalValue=e,t.typeOrder=Va.GeoPointValue,t}var _s,xs=(n(Rs,_s=Qa),Rs.prototype.value=function(e){var t={};return this.internalValue.inorderTraversal((function(n,r){t[n]=r.value(e)})),t},Rs.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},Rs.prototype.isEqual=function(e){if(e instanceof Rs){for(var t=this.internalValue.getIterator(),n=e.internalValue.getIterator();t.hasNext()&&n.hasNext();){var r=t.getNext(),i=n.getNext();if(r.key!==i.key||!r.value.isEqual(i.value))return!1}return!t.hasNext()&&!n.hasNext()}return!1},Rs.prototype.compareTo=function(e){if(e instanceof Rs){for(var t=this.internalValue.getIterator(),n=e.internalValue.getIterator();t.hasNext()&&n.hasNext();){var r=t.getNext(),i=n.getNext(),o=Si(r.key,i.key)||r.value.compareTo(i.value);if(o)return o}return Si(t.hasNext(),n.hasNext())}return this.defaultCompareTo(e)},Rs.prototype.set=function(e,t){if(jr(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),t);var n=this.child(e.firstSegment());n instanceof Rs||(n=Rs.EMPTY);var r=n.set(e.popFirst(),t);return this.setChild(e.firstSegment(),r)},Rs.prototype.delete=function(e){if(jr(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new Rs(this.internalValue.remove(e.firstSegment()));var t=this.child(e.firstSegment());if(t instanceof Rs){var n=t.delete(e.popFirst());return new Rs(this.internalValue.insert(e.firstSegment(),n))}return this},Rs.prototype.contains=function(e){return null!==this.field(e)},Rs.prototype.field=function(e){jr(!e.isEmpty(),"Can't get field of empty path");var t=this;return e.forEach((function(e){t=t instanceof Rs?t.internalValue.get(e):null})),t},Rs.prototype.fieldMask=function(){var e=new bo(zi.comparator);return this.internalValue.forEach((function(t,n){var r=new zi([t]);if(n instanceof Rs){var i=n.fieldMask().fields;i.isEmpty()?e=e.add(r):i.forEach((function(t){e=e.add(r.child(t))}))}else e=e.add(r)})),ga.fromSet(e)},Rs.prototype.approximateByteSize=function(){var e=0;return this.internalValue.inorderTraversal((function(t,n){e+=t.length+n.approximateByteSize()})),e},Rs.prototype.toString=function(){return this.internalValue.toString()},Rs.prototype.child=function(e){return this.internalValue.get(e)||void 0},Rs.prototype.setChild=function(e,t){return new Rs(this.internalValue.insert(e,t))},Rs.EMPTY=new Rs(new lo(Si)),Rs);function Rs(e){var t=_s.call(this)||this;return t.internalValue=e,t.typeOrder=Va.ObjectValue,t}var Ms,Os=(n(Ps,Ms=Qa),Ps.prototype.value=function(e){return this.internalValue.map((function(t){return t.value(e)}))},Ps.prototype.contains=function(e){for(var t=0,n=this.internalValue;t<n.length;t++)if(n[t].isEqual(e))return!0;return!1},Ps.prototype.forEach=function(e){this.internalValue.forEach(e)},Ps.prototype.isEqual=function(e){if(e instanceof Ps){if(this.internalValue.length!==e.internalValue.length)return!1;for(var t=0;t<this.internalValue.length;t++)if(!this.internalValue[t].isEqual(e.internalValue[t]))return!1;return!0}return!1},Ps.prototype.compareTo=function(e){if(e instanceof Ps){for(var t=Math.min(this.internalValue.length,e.internalValue.length),n=0;n<t;n++){var r=this.internalValue[n].compareTo(e.internalValue[n]);if(r)return r}return Si(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},Ps.prototype.approximateByteSize=function(){return this.internalValue.reduce((function(e,t){return e+t.approximateByteSize()}),0)},Ps.prototype.toString=function(){return"["+this.internalValue.map((function(e){return e.toString()})).join(",")+"]"},Ps);function Ps(e){var t=Ms.call(this)||this;return t.internalValue=e,t.typeOrder=Va.ArrayValue,t}var Ls=(Fs.compareByKey=function(e,t){return Gi.comparator(e.key,t.key)},Fs);function Fs(e,t){this.key=e,this.version=t}var Bs,qs=(n(Vs,Bs=Ls),Vs.prototype.field=function(e){if(this.objectValue)return this.objectValue.field(e);this.fieldValueCache||(this.fieldValueCache=new Map);var t=e.canonicalString(),n=this.fieldValueCache.get(t);if(void 0===n){var r=this.getProtoField(e);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(t,n)}return n},Vs.prototype.data=function(){var e=this;if(!this.objectValue){var t=xs.EMPTY;ti(this.proto.fields||{},(function(n,r){t=t.set(new zi([n]),e.converter(r))})),this.objectValue=t,this.fieldValueCache=void 0}return this.objectValue},Vs.prototype.value=function(){return this.data().value()},Vs.prototype.isEqual=function(e){return e instanceof Vs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.data().isEqual(e.data())},Vs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Vs.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Vs.prototype.getProtoField=function(e){jr(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var t=this.proto.fields?this.proto.fields[e.firstSegment()]:void 0,n=1;n<e.length;++n){if(!t||!t.mapValue||!t.mapValue.fields)return;t=t.mapValue.fields[e.get(n)]}return t},Vs.compareByField=function(e,t,n){var r=t.field(e),i=n.field(e);return null!==r&&null!==i?r.compareTo(i):Ur("Trying to compare documents on fields that don't exist")},Vs);function Vs(e,t,n,r,i,o){var a=Bs.call(this,e,t)||this;return a.objectValue=r,a.proto=i,a.converter=o,jr(void 0!==a.objectValue||void 0!==a.proto&&void 0!==a.converter,"If objectValue is not defined, proto and converter need to be set."),a.hasLocalMutations=!!n.hasLocalMutations,a.hasCommittedMutations=!!n.hasCommittedMutations,a}var $s,Us=(n(js,$s=Ls),js.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(js.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),js.prototype.isEqual=function(e){return e instanceof js&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},js);function js(e,t,n){var r=$s.call(this,e,t)||this;return r.hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}var Ws,zs=(n(Ks,Ws=Ls),Ks.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ks.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Ks.prototype.isEqual=function(e){return e instanceof Ks&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},Ks);function Ks(){return null!==Ws&&Ws.apply(this,arguments)||this}var Gs=(Qs.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(e))return s}},Qs.prototype.has=function(e){return void 0!==this.get(e)},Qs.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},Qs.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},Qs.prototype.forEach=function(e){ti(this.inner,(function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];e(a,s)}}))},Qs.prototype.isEmpty=function(){return ni(this.inner)},Qs);function Qs(e){this.mapKeyFn=e,this.inner={}}var Hs=(Object.defineProperty(Ys.prototype,"readTime",{get:function(){return jr(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(e){jr(void 0===this._readTime||this._readTime.isEqual(e),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=e},enumerable:!0,configurable:!0}),Ys.prototype.addEntry=function(e,t){this.assertNotApplied(),this.readTime=t,this.changes.set(e.key,e)},Ys.prototype.removeEntry=function(e,t){this.assertNotApplied(),t&&(this.readTime=t),this.changes.set(e,null)},Ys.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Bo.resolve(n):this.getFromCache(e,t)},Ys.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},Ys.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},Ys.prototype.assertNotApplied=function(){jr(!this.changesApplied,"Changes have already been applied.")},Ys);function Ys(){this.changes=new Gs((function(e){return e.toString()})),this.changesApplied=!1}var Xs,Js=(Zs.prototype.addEntry=function(e,t,n){return nu(e).put(ru(t),n)},Zs.prototype.removeEntry=function(e,t){var n=nu(e),r=ru(t);return n.delete(r)},Zs.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.setMetadata(e,r)}))},Zs.prototype.getEntry=function(e,t){var n=this;return nu(e).get(ru(t)).next((function(e){return n.maybeDecodeDocument(e)}))},Zs.prototype.getSizedEntry=function(e,t){var n=this;return nu(e).get(ru(t)).next((function(e){var t=n.maybeDecodeDocument(e);return t?{maybeDocument:t,size:iu(e)}:null}))},Zs.prototype.getEntries=function(e,t){var n=this,r=Co();return this.forEachDbEntry(e,t,(function(e,t){var i=n.maybeDecodeDocument(t);r=r.insert(e,i)})).next((function(){return r}))},Zs.prototype.getSizedEntries=function(e,t){var n=this,r=Co(),i=new lo(Gi.comparator);return this.forEachDbEntry(e,t,(function(e,t){var o=n.maybeDecodeDocument(t);i=o?(r=r.insert(e,o),i.insert(e,iu(t))):(r=r.insert(e,null),i.insert(e,0))})).next((function(){return{maybeDocuments:r,sizeMap:i}}))},Zs.prototype.forEachDbEntry=function(e,t,n){if(t.isEmpty())return Bo.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return nu(e).iterate({range:r},(function(e,t,r){for(var a=Gi.fromSegments(e);o&&Gi.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},Zs.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this;jr(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Do(),o=t.path.length+1,a={};if(n.isEqual(uo.MIN)){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=t.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Su.collectionReadTimeIndex}return nu(e).iterate(a,(function(e,n,a){if(e.length===o){var s=r.serializer.fromDbRemoteDocument(n);t.path.isPrefixOf(s.key.path)?s instanceof qs&&t.matches(s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},Zs.prototype.getNewDocumentChanges=function(e,t){var n=this,r=Io(),i=this.serializer.toDbTimestampKey(t),o=nu(e),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:Su.readTimeIndex,range:a},(function(e,t){var o=n.serializer.fromDbRemoteDocument(t);r=r.insert(o.key,o),i=t.readTime})).next((function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}}))},Zs.prototype.getLastReadTime=function(e){var t=this,n=nu(e),r=uo.MIN;return n.iterate({index:Su.readTimeIndex,reverse:!0},(function(e,n,i){n.readTime&&(r=t.serializer.fromDbTimestampKey(n.readTime)),i.done()})).next((function(){return r}))},Zs.prototype.newChangeBuffer=function(e){return new Zs.RemoteDocumentChangeBuffer(this,!!e&&e.trackRemovals)},Zs.prototype.getSize=function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))},Zs.prototype.getMetadata=function(e){return tu(e).get(Cu.key).next((function(e){return jr(!!e,"Missing document cache metadata"),e}))},Zs.prototype.setMetadata=function(e,t){return tu(e).put(Cu.key,t)},Zs.prototype.maybeDecodeDocument=function(e){if(e){var t=this.serializer.fromDbRemoteDocument(e);return t instanceof Us&&t.version.isEqual(uo.forDeletedDoc())?null:t}return null},Zs.RemoteDocumentChangeBuffer=(n(eu,Xs=Hs),eu.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new bo((function(e,t){return Si(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(o,a){var s=t.documentSizes.get(o);if(jr(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){jr(!t.readTime.isEqual(uo.MIN),"Cannot add a document with a read time of zero");var u=t.documentCache.serializer.toDbRemoteDocument(a,t.readTime);i=i.add(o.path.popLast());var c=iu(u);r+=c-s,n.push(t.documentCache.addEntry(e,o,u))}else if(r-=s,t.trackRemovals){var l=t.documentCache.serializer.toDbRemoteDocument(new Us(o,uo.forDeletedDoc()),t.readTime);n.push(t.documentCache.addEntry(e,o,l))}else n.push(t.documentCache.removeEntry(e,o))})),i.forEach((function(r){n.push(t.documentCache.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.documentCache.updateMetadata(e,r)),Bo.waitFor(n)},eu.prototype.getFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntry(e,t).next((function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)}))},eu.prototype.getAllFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntries(e,t).next((function(e){var t=e.maybeDocuments;return e.sizeMap.forEach((function(e,t){n.documentSizes.set(e,t)})),t}))},eu),Zs);function Zs(e,t){this.serializer=e,this.indexManager=t}function eu(e,t){var n=Xs.call(this)||this;return n.documentCache=e,n.trackRemovals=t,n.documentSizes=new Gs((function(e){return e.toString()})),n}function tu(e){return Ec.getStore(e,Cu.store)}function nu(e){return Ec.getStore(e,Su.store)}function ru(e){return e.path.toArray()}function iu(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Ur("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var ou=(au.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),Bo.resolve()},au.prototype.getCollectionParents=function(e,t){return Bo.resolve(this.collectionParentIndex.getEntries(t))},au);function au(){this.collectionParentIndex=new su}var su=(uu.prototype.add=function(e){jr(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new bo($i.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},uu.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},uu.prototype.getEntries=function(e){return(this.index[e]||new bo($i.comparator)).toArray()},uu);function uu(){this.index={}}var cu=9,lu=(hu.prototype.createOrUpgrade=function(e,t,n,r){var i=this;jr(n<r&&0<=n&&r<=cu,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new zo(t);n<1&&1<=r&&(function(e){e.createObjectStore(pu.store)}(e),function(e){e.createObjectStore(mu.store,{keyPath:mu.keyPath}),e.createObjectStore(yu.store,{keyPath:yu.keyPath,autoIncrement:!0}).createIndex(yu.userMutationsIndex,yu.userMutationsKeyPath,{unique:!0}),e.createObjectStore(bu.store)}(e),Pu(e),function(e){e.createObjectStore(Su.store)}(e));var a=Bo.resolve();return n<3&&3<=r&&(0!==n&&(function(e){e.deleteObjectStore(ku.store),e.deleteObjectStore(Du.store),e.deleteObjectStore(xu.store)}(e),Pu(e)),a=a.next((function(){return function(e){var t=e.store(xu.store),n=new xu(0,0,uo.MIN.toTimestamp(),0);return t.put(xu.key,n)}(o)}))),n<4&&4<=r&&(0!==n&&(a=a.next((function(){return function(e,t){return t.store(yu.store).loadAll().next((function(n){e.deleteObjectStore(yu.store),e.createObjectStore(yu.store,{keyPath:yu.keyPath,autoIncrement:!0}).createIndex(yu.userMutationsIndex,yu.userMutationsKeyPath,{unique:!0});var r=t.store(yu.store),i=n.map((function(e){return r.put(e)}));return Bo.waitFor(i)}))}(e,o)}))),a=a.next((function(){!function(e){e.createObjectStore(Lu.store,{keyPath:Lu.keyPath})}(e)}))),n<5&&5<=r&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&6<=r&&(a=a.next((function(){return function(e){e.createObjectStore(Cu.store)}(e),i.addDocumentGlobal(o)}))),n<7&&7<=r&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&8<=r&&(a=a.next((function(){return i.createCollectionParentIndex(e,o)}))),n<9&&9<=r&&(a=a.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(Su.store);t.createIndex(Su.readTimeIndex,Su.readTimeIndexPath,{unique:!1}),t.createIndex(Su.collectionReadTimeIndex,Su.collectionReadTimeIndexPath,{unique:!1})}(t)}))),a},hu.prototype.addDocumentGlobal=function(e){var t=0;return e.store(Su.store).iterate((function(e,n){t+=iu(n)})).next((function(){var n=new Cu(t);return e.store(Cu.store).put(Cu.key,n)}))},hu.prototype.removeAcknowledgedMutations=function(e){var t=this,n=e.store(mu.store),r=e.store(yu.store);return n.loadAll().next((function(n){return Bo.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(yu.userMutationsIndex,i).next((function(r){return Bo.forEach(r,(function(r){jr(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=t.serializer.fromDbMutationBatch(r);return ra(e,n.userId,i).next((function(){}))}))}))}))}))},hu.prototype.ensureSequenceNumbers=function(e){var t=e.store(ku.store),n=e.store(Su.store);return da(e).next((function(e){var r=[];return n.iterate((function(n,i){var o=new $i(n),a=function(e){return[0,no(e)]}(o);r.push(t.get(a).next((function(n){return n?Bo.resolve():function(n){return t.put(new ku(0,no(n),e))}(o)})))})).next((function(){return Bo.waitFor(r)}))}))},hu.prototype.createCollectionParentIndex=function(e,t){function n(e){if(i.add(e)){var t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:no(n)})}}e.createObjectStore(Mu.store,{keyPath:Mu.keyPath});var r=t.store(Mu.store),i=new su;return t.store(Su.store).iterate({keysOnly:!0},(function(e,t){return n(new $i(e).popLast())})).next((function(){return t.store(bu.store).iterate({keysOnly:!0},(function(e,t){e[0];var r=e[1];return n((e[2],oo(r)).popLast())}))}))},hu);function hu(e){this.serializer=e}var fu=function(e,t){this.seconds=e,this.nanoseconds=t},pu=(du.store="owner",du.key="owner",du);function du(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}var mu=(gu.store="mutationQueues",gu.keyPath="userId",gu);function gu(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}var yu=(vu.store="mutations",vu.keyPath="batchId",vu.userMutationsIndex="userMutationsIndex",vu.userMutationsKeyPath=["userId","batchId"],vu);function vu(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}var bu=(wu.prefixForUser=function(e){return[e]},wu.prefixForPath=function(e,t){return[e,no(t)]},wu.key=function(e,t,n){return[e,no(t),n]},wu.store="documentMutations",wu.PLACEHOLDER=new wu,wu);function wu(){}var Tu=function(e,t){this.path=e,this.readTime=t},Eu=function(e,t){this.path=e,this.version=t},Su=(Iu.store="remoteDocuments",Iu.readTimeIndex="readTimeIndex",Iu.readTimeIndexPath="readTime",Iu.collectionReadTimeIndex="collectionReadTimeIndex",Iu.collectionReadTimeIndexPath=["parentPath","readTime"],Iu);function Iu(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}var Cu=(Au.store="remoteDocumentGlobal",Au.key="remoteDocumentGlobalKey",Au);function Au(e){this.byteSize=e}var Du=(Nu.store="targets",Nu.keyPath="targetId",Nu.queryTargetsIndexName="queryTargetsIndex",Nu.queryTargetsKeyPath=["canonicalId","targetId"],Nu);function Nu(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}var ku=(_u.store="targetDocuments",_u.keyPath=["targetId","path"],_u.documentTargetsIndex="documentTargetsIndex",_u.documentTargetsKeyPath=["path","targetId"],_u);function _u(e,t,n){this.targetId=e,this.path=t,jr(0===e==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}var xu=(Ru.key="targetGlobalKey",Ru.store="targetGlobal",Ru);function Ru(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}var Mu=(Ou.store="collectionParents",Ou.keyPath=["collectionId","parent"],Ou);function Ou(e,t){this.collectionId=e,this.parent=t}function Pu(e){e.createObjectStore(ku.store,{keyPath:ku.keyPath}).createIndex(ku.documentTargetsIndex,ku.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(Du.store,{keyPath:Du.keyPath}).createIndex(Du.queryTargetsIndexName,Du.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(xu.store)}var Lu=(Fu.store="clientMetadata",Fu.keyPath="clientId",Fu);function Fu(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}var Bu,qu,Vu=u(u(u([mu.store,yu.store,bu.store,Su.store,Du.store,pu.store,xu.store,ku.store],[Lu.store]),[Cu.store]),[Mu.store]),$u=(Uu.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(jr(t.length%2==1,"Expected a collection path."),this.collectionParentsCache.has(t))return Bo.resolve();var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.collectionParentsCache.add(t)}));var o={collectionId:r,parent:no(i)};return ju(e).put(o)},Uu.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[Ci(t),""],!1,!0);return ju(e).loadAll(r).next((function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(oo(o.parent))}return n}))},Uu);function Uu(){this.collectionParentsCache=new su}function ju(e){return Ec.getStore(e,Mu.store)}(qu=Bu=Bu||{})[qu.Listen=0]="Listen",qu[qu.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",qu[qu.LimboResolution=2]="LimboResolution";var Wu=(zu.prototype.withSequenceNumber=function(e){return new zu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},zu.prototype.withResumeToken=function(e,t){return new zu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)},zu.prototype.withLastLimboFreeSnapshotVersion=function(e){return new zu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},zu.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.sequenceNumber===e.sequenceNumber&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(e.lastLimboFreeSnapshotVersion)&&this.resumeToken===e.resumeToken&&this.target.isEqual(e.target)},zu);function zu(e,t,n,r,i,o,a){void 0===i&&(i=uo.MIN),void 0===o&&(o=uo.MIN),void 0===a&&(a=Kr()),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}var Ku=(Gu.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=Gi.fromSegments(e.noDocument.path),n=this.fromDbTimestamp(e.noDocument.readTime);return new Us(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(t=Gi.fromSegments(e.unknownDocument.path),n=this.fromDbTimestamp(e.unknownDocument.version),new zs(t,n)):Ur("Unexpected DbRemoteDocument")},Gu.prototype.toDbRemoteDocument=function(e,t){var n=this.toDbTimestampKey(t),r=e.key.path.popLast().toArray();if(e instanceof qs){var i=e.proto?e.proto:this.remoteSerializer.toDocument(e),o=e.hasCommittedMutations;return new Su(null,null,i,o,n,r)}if(e instanceof Us){var a=e.key.path.toArray(),s=this.toDbTimestamp(e.version);return o=e.hasCommittedMutations,new Su(null,new Tu(a,s),null,o,n,r)}if(e instanceof zs){a=e.key.path.toArray();var u=this.toDbTimestamp(e.version);return new Su(new Eu(a,u),null,null,!0,n,r)}return Ur("Unexpected MaybeDocument")},Gu.prototype.toDbTimestampKey=function(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]},Gu.prototype.fromDbTimestampKey=function(e){var t=new ao(e[0],e[1]);return uo.fromTimestamp(t)},Gu.prototype.toDbTimestamp=function(e){var t=e.toTimestamp();return new fu(t.seconds,t.nanoseconds)},Gu.prototype.fromDbTimestamp=function(e){var t=new ao(e.seconds,e.nanoseconds);return uo.fromTimestamp(t)},Gu.prototype.toDbMutationBatch=function(e,t){var n=this,r=t.baseMutations.map((function(e){return n.remoteSerializer.toMutation(e)})),i=t.mutations.map((function(e){return n.remoteSerializer.toMutation(e)}));return new yu(e,t.batchId,t.localWriteTime.toMillis(),r,i)},Gu.prototype.fromDbMutationBatch=function(e){var t=this,n=(e.baseMutations||[]).map((function(e){return t.remoteSerializer.fromMutation(e)})),r=e.mutations.map((function(e){return t.remoteSerializer.fromMutation(e)})),i=ao.fromMillis(e.localWriteTimeMs);return new Oo(e.batchId,i,n,r)},Gu.prototype.toDbResourcePaths=function(e){var t=[];return e.forEach((function(e){t.push(no(e.path))})),t},Gu.prototype.fromDbResourcePaths=function(e){for(var t=xo(),n=0,r=e;n<r.length;n++){var i=r[n];t=t.add(new Gi(oo(i)))}return t},Gu.prototype.fromDbTarget=function(e){var t,n=this.fromDbTimestamp(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(e.lastLimboFreeSnapshotVersion):uo.MIN,i=e.resumeToken;return t=function(e){return void 0!==e.documents}(e.query)?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new Wu(t,e.targetId,Bu.Listen,e.lastListenSequenceNumber,n,r,i)},Gu.prototype.toDbTarget=function(e){jr(Bu.Listen===e.purpose,"Only queries with purpose "+Bu.Listen+" may be stored, got "+e.purpose);var t,n,r=this.toDbTimestamp(e.snapshotVersion),i=this.toDbTimestamp(e.lastLimboFreeSnapshotVersion);return t=e.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.target):this.remoteSerializer.toQueryTarget(e.target),n=e.resumeToken instanceof Uint8Array?(jr($o.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),e.resumeToken.toString()):e.resumeToken,new Du(e.targetId,e.target.canonicalId(),r,n,e.sequenceNumber,i,t)},Gu);function Gu(e){this.remoteSerializer=e}var Qu=(Hu.prototype.getDocument=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.getDocumentInternal(e,t,r)}))},Hu.prototype.getDocumentInternal=function(e,t,n){return this.remoteDocumentCache.getEntry(e,t).next((function(e){for(var r=0,i=n;r<i.length;r++)e=i[r].applyToLocalView(t,e);return e}))},Hu.prototype.applyLocalMutationsToDocuments=function(e,t,n){var r=Co();return t.forEach((function(e,t){for(var i=0,o=n;i<o.length;i++)t=o[i].applyToLocalView(e,t);r=r.insert(e,t)})),r},Hu.prototype.getDocuments=function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t)}))},Hu.prototype.getLocalViewOfDocuments=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(r){var i=n.applyLocalMutationsToDocuments(e,t,r),o=Io();return i.forEach((function(e,t){t=t||new Us(e,uo.forDeletedDoc()),o=o.insert(e,t)})),o}))},Hu.prototype.getDocumentsMatchingQuery=function(e,t,n){return t.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(e,t.path):t.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)},Hu.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new Gi(t)).next((function(e){var t=Do();return e instanceof qs&&(t=t.insert(e.key,e)),t}))},Hu.prototype.getDocumentsMatchingCollectionGroupQuery=function(e,t,n){var r=this;jr(t.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=t.collectionGroup,o=Do();return this.indexManager.getCollectionParents(e,i).next((function(a){return Bo.forEach(a,(function(a){var s=t.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){o=o.insert(e,t)}))}))})).next((function(){return o}))}))},Hu.prototype.getDocumentsMatchingCollectionQuery=function(e,t,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n).next((function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(e,t)})).next((function(t){return i=t,o.addMissingBaseDocuments(e,i,r).next((function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);r=h instanceof qs?r.insert(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(e,n){t.matches(n)||(r=r.remove(e))})),r}))},Hu.prototype.addMissingBaseDocuments=function(e,t,n){for(var r=xo(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof xa&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(e,r).next((function(e){return e.forEach((function(e,t){null!==t&&t instanceof qs&&(c=c.insert(e,t))})),c}))},Hu);function Hu(e,t,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=n}var Yu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Xu=(Ju.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},Ju.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(e){return e()}))},Ju);function Ju(){this.onCommittedListeners=[]}var Zu=(ec.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},ec.prototype.addReference=function(e,t){var n=new tc(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},ec.prototype.addReferences=function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))},ec.prototype.removeReference=function(e,t){this.removeRef(new tc(e,t))},ec.prototype.removeReferences=function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))},ec.prototype.removeReferencesForId=function(e){var t=this,n=Gi.EMPTY,r=new tc(n,e),i=new tc(n,e+1),o=[];return this.refsByTarget.forEachInRange([r,i],(function(e){t.removeRef(e),o.push(e.key)})),o},ec.prototype.removeAllReferences=function(){var e=this;this.refsByKey.forEach((function(t){return e.removeRef(t)}))},ec.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},ec.prototype.referencesForId=function(e){var t=Gi.EMPTY,n=new tc(t,e),r=new tc(t,e+1),i=xo();return this.refsByTarget.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i},ec.prototype.containsKey=function(e){var t=new tc(e,0),n=this.refsByKey.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},ec);function ec(){this.refsByKey=new bo(tc.compareByKey),this.refsByTarget=new bo(tc.compareByTargetId)}var tc=(nc.compareByKey=function(e,t){return Gi.comparator(e.key,t.key)||Si(e.targetOrBatchId,t.targetOrBatchId)},nc.compareByTargetId=function(e,t){return Si(e.targetOrBatchId,t.targetOrBatchId)||Gi.comparator(e.key,t.key)},nc);function nc(e,t){this.key=e,this.targetOrBatchId=t}var rc="LocalStore",ic=(oc.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},oc.prototype.handleUserChange=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i=this;return s(this,(function(o){switch(o.label){case 0:return t=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next((function(a){return o=a,t=i.persistence.getMutationQueue(e),n=new Qu(i.remoteDocuments,t,i.persistence.getIndexManager()),t.getAllMutationBatches(r)})).next((function(e){for(var t=[],i=[],a=xo(),s=0,u=o;s<u.length;s++){var c=u[s];t.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var p=0,d=e;p<d.length;p++){c=d[p],i.push(c.batchId);for(var m=0,g=c.mutations;m<g.length;m++)f=g[m],a=a.add(f.key)}return n.getDocuments(r,a).next((function(e){return{affectedDocuments:e,removedBatchIds:t,addedBatchIds:i}}))}))}))];case 1:return r=o.sent(),this.mutationQueue=t,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}}))}))},oc.prototype.localWrite=function(e){var t,n=this,r=ao.now(),i=e.reduce((function(e,t){return e.add(t.key)}),xo());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.localDocuments.getDocuments(o,i).next((function(i){t=i;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=c.extractBaseValue(t.get(c.key));null!=l&&a.push(new xa(c.key,l,l.fieldMask(),Sa.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,e)}))})).then((function(e){var n=e.applyToLocalDocumentSet(t);return{batchId:e.batchId,changes:n}}))},oc.prototype.lookupMutationDocuments=function(e){var t=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return t.mutationQueue.lookupMutationKeys(n,e).next((function(e){return e?t.localDocuments.getDocuments(n,e):Bo.resolve(null)}))}))},oc.prototype.acknowledgeBatch=function(e){var t=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=e.batch.keys(),i=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return t.mutationQueue.acknowledgeBatch(n,e.batch,e.streamToken).next((function(){return t.applyWriteToRemoteDocuments(n,e,i)})).next((function(){return i.apply(n)})).next((function(){return t.mutationQueue.performConsistencyCheck(n)})).next((function(){return t.localDocuments.getDocuments(n,r)}))}))},oc.prototype.rejectBatch=function(e){var t=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return t.mutationQueue.lookupMutationBatch(n,e).next((function(e){return jr(null!==e,"Attempt to reject nonexistent batch!"),r=e.keys(),t.mutationQueue.removeMutationBatch(n,e)})).next((function(){return t.mutationQueue.performConsistencyCheck(n)})).next((function(){return t.localDocuments.getDocuments(n,r)}))}))},oc.prototype.getHighestUnacknowledgedBatchId=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(t){return e.mutationQueue.getHighestUnacknowledgedBatchId(t)}))},oc.prototype.getLastStreamToken=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(t){return e.mutationQueue.getLastStreamToken(t)}))},oc.prototype.setLastStreamToken=function(e){var t=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return t.mutationQueue.setLastStreamToken(n,e)}))},oc.prototype.getLastRemoteSnapshotVersion=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(t){return e.targetCache.getLastRemoteSnapshotVersion(t)}))},oc.prototype.applyRemoteEvent=function(e){var t=this,n=e.snapshotVersion,r=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(i){var o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=t.targetDataByTarget;var a=[];ei(e.targetChanges,(function(e,o){var s=r.get(e);if(s){a.push(t.targetCache.removeMatchingKeys(i,o.removedDocuments,e).next((function(){return t.targetCache.addMatchingKeys(i,o.addedDocuments,e)})));var u=o.resumeToken;if(0<u.length){var c=s.withResumeToken(u,n).withSequenceNumber(i.currentSequenceNumber);r=r.insert(e,c),oc.shouldPersistTargetData(s,c,o)&&a.push(t.targetCache.updateTargetData(i,c))}}}));var s=Io(),u=xo();if(e.documentUpdates.forEach((function(e,t){u=u.add(e)})),a.push(o.getEntries(i,u).next((function(r){e.documentUpdates.forEach((function(u,c){var l=r.get(u);c instanceof Us&&c.version.isEqual(uo.MIN)?(o.removeEntry(u,n),s=s.insert(u,c)):null==l||0<c.version.compareTo(l.version)||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(jr(!uo.MIN.isEqual(n),"Cannot add a document when the remote version is zero"),o.addEntry(c,n),s=s.insert(u,c)):qr(rc,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}))}))),!n.isEqual(uo.MIN)){var c=t.targetCache.getLastRemoteSnapshotVersion(i).next((function(e){return jr(0<=n.compareTo(e),"Watch stream reverted to previous snapshot?? "+n+" < "+e),t.targetCache.setTargetsMetadata(i,i.currentSequenceNumber,n)}));a.push(c)}return Bo.waitFor(a).next((function(){return o.apply(i)})).next((function(){return t.localDocuments.getLocalViewOfDocuments(i,s)}))})).then((function(e){return t.targetDataByTarget=r,e}))},oc.shouldPersistTargetData=function(e,t,n){return jr(0<t.resumeToken.length,"Attempted to persist target data with no resume token"),0===e.resumeToken.length||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||0<n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size},oc.prototype.notifyLocalViewChanges=function(e){for(var t=this,n=0,r=e;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);jr(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return Bo.forEach(e,(function(e){return Bo.forEach(e.removedKeys,(function(e){return t.persistence.referenceDelegate.removeReference(n,e)}))}))}))},oc.prototype.nextMutationBatch=function(e){var t=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)}))},oc.prototype.readDocument=function(e){var t=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return t.localDocuments.getDocument(n,e)}))},oc.prototype.allocateTarget=function(e){var t=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return t.targetCache.getTargetData(n,e).next((function(i){return i?(r=i,Bo.resolve(r)):t.targetCache.allocateTargetId(n).next((function(i){return r=new Wu(e,i,Bu.Listen,n.currentSequenceNumber),t.targetCache.addTargetData(n,r).next((function(){return r}))}))}))})).then((function(n){return null===t.targetDataByTarget.get(n.targetId)&&(t.targetDataByTarget=t.targetDataByTarget.insert(n.targetId,n),t.targetIdByTarget.set(e,n.targetId)),n}))},oc.prototype.getTargetData=function(e,t){var n=this.targetIdByTarget.get(t);return void 0!==n?Bo.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(e,t)},oc.prototype.releaseTarget=function(e,t){var n=this,r=this.targetDataByTarget.get(e);jr(null!==r,"Tried to release nonexistent target: "+e);var i=t?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.localViewReferences.removeReferencesForId(e);return t?Bo.resolve():Bo.forEach(o,(function(e){return n.persistence.referenceDelegate.removeReference(i,e)})).next((function(){n.persistence.referenceDelegate.removeTarget(i,r)}))})).then((function(){n.targetDataByTarget=n.targetDataByTarget.remove(e),n.targetIdByTarget.delete(r.target)}))},oc.prototype.executeQuery=function(e,t){var n=this,r=uo.MIN,i=xo();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.getTargetData(o,e.toTarget()).next((function(e){if(e)return r=e.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,e.targetId).next((function(e){i=e}))})).next((function(){return n.queryEngine.getDocumentsMatchingQuery(o,e,t?r:uo.MIN,t?i:xo())})).next((function(e){return{documents:e,remoteKeys:i}}))}))},oc.prototype.remoteDocumentKeys=function(e){var t=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return t.targetCache.getMatchingKeysForTargetId(n,e)}))},oc.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},oc.prototype.removeCachedMutationBatchMetadata=function(e){this.mutationQueue.removeCachedMutationKeys(e)},oc.prototype.setNetworkEnabled=function(e){this.persistence.setNetworkEnabled(e)},oc.prototype.applyWriteToRemoteDocuments=function(e,t,n){var r=this,i=t.batch,o=i.keys(),a=Bo.resolve();return o.forEach((function(r){a=a.next((function(){return n.getEntry(e,r)})).next((function(e){var o=e,a=t.docVersions.get(r);jr(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,t))?n.addEntry(o,t.commitVersion):jr(!e,"Mutation batch "+i+" applied to document "+e+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(e,i)}))},oc.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return e.collect(n,t.targetDataByTarget)}))},oc.prototype.getTarget=function(e){var t=this,n=this.targetDataByTarget.get(e);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return t.targetCache.getTargetDataForTarget(n,e).next((function(e){return e?e.target:null}))}))},oc.prototype.getNewDocumentChanges=function(){var e=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(t){return e.remoteDocuments.getNewDocumentChanges(t,e.lastDocumentChangeReadTime)})).then((function(t){var n=t.changedDocs,r=t.readTime;return e.lastDocumentChangeReadTime=r,n}))},oc.prototype.synchronizeLastDocumentChangeReadTime=function(){return a(this,void 0,void 0,(function(){var e,t=this;return s(this,(function(n){switch(n.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(e){return t.remoteDocuments.getLastReadTime(e)}))];case 1:return e.lastDocumentChangeReadTime=n.sent(),[2]}}))}))},oc.RESUME_TOKEN_MAX_AGE_MICROS=3e8,oc);function oc(e,t,n){this.persistence=e,this.queryEngine=t,this.localViewReferences=new Zu,this.targetDataByTarget=new lo(Si),this.targetIdByTarget=new Gs((function(e){return e.canonicalId()})),this.lastDocumentChangeReadTime=uo.MIN,jr(e.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=e.getMutationQueue(n),this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.localDocuments=new Qu(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}function ac(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){if(e.code!==Qr.FAILED_PRECONDITION||e.message!==Yu)throw e;return qr(rc,"Unexpectedly lost primary lease"),[2]}))}))}function sc(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=Si(n,i);return 0===a?Si(r,o):a}var uc=(cc.prototype.nextIndex=function(){return++this.previousIndex},cc.prototype.addElement=function(e){var t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();sc(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(cc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),cc);function cc(e){this.maxElements=e,this.buffer=new bo(sc),this.previousIndex=0}var lc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hc=(fc.withCacheSize=function(e){return new fc(e,fc.DEFAULT_COLLECTION_PERCENTILE,fc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},fc.COLLECTION_DISABLED=-1,fc.MINIMUM_CACHE_SIZE_BYTES=1048576,fc.DEFAULT=new fc(fc.DEFAULT_CACHE_SIZE_BYTES=41943040,fc.DEFAULT_COLLECTION_PERCENTILE=10,fc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),fc.DISABLED=new fc(fc.COLLECTION_DISABLED,0,0),fc);function fc(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}var pc=(dc.prototype.start=function(){jr(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==hc.COLLECTION_DISABLED&&this.scheduleGC()},dc.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(dc.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),dc.prototype.scheduleGC=function(){var e=this;jr(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?3e5:6e4;qr("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(Hi.LruGarbageCollection,t,(function(){return e.gcTask=null,e.hasRun=!0,e.localStore.collectGarbage(e.garbageCollector).then((function(){return e.scheduleGC()})).catch(ac)}))},dc);function dc(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.hasRun=!1,this.gcTask=null}var mc=(gc.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next((function(e){return Math.floor(t/100*e)}))},gc.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return Bo.resolve(Pi.INVALID);var r=new uc(t);return this.delegate.forEachTarget(e,(function(e){return r.addElement(e.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,(function(e){return r.addElement(e)}))})).next((function(){return r.maxValue}))},gc.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},gc.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},gc.prototype.collect=function(e,t){var n=this;return this.params.cacheSizeCollectionThreshold===hc.COLLECTION_DISABLED?(qr("LruGarbageCollector","Garbage collection skipped; disabled"),Bo.resolve(lc)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(qr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),lc):n.runGarbageCollection(e,t)}))},gc.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},gc.prototype.runGarbageCollection=function(e,t){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return r=t>c.params.maximumSequenceNumbersToCollect?(qr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+t),c.params.maximumSequenceNumbersToCollect):t,o=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),Fr()<=Dr.DEBUG&&qr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),Bo.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))},gc);function gc(e,t){this.delegate=e,this.params=t}var yc,vc="IndexedDbPersistence",bc="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",wc=(n(Tc,yc=Xu),Tc);function Tc(e,t){var n=yc.call(this)||this;return n.simpleDbTransaction=e,n.currentSequenceNumber=t,n}var Ec=(Sc.getStore=function(e,t){if(e instanceof wc)return $o.getStore(e.simpleDbTransaction,t);throw Ur("IndexedDbPersistence must use instances of IndexedDbTransaction")},Sc.createIndexedDbPersistence=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if(!Sc.isAvailable())throw new Hr(Qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(t=new Sc(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.lruParams,e.queue,e.serializer,e.sequenceNumberSyncer)).start()];case 1:return n.sent(),[2,t]}}))}))},Sc.prototype.start=function(){var e=this;return jr(!this.started,"IndexedDbPersistence double-started!"),jr(null!==this.window,"Expected 'window' to be defined"),$o.openOrCreate(this.dbName,cu,new lu(this.serializer)).then((function(t){return e.simpleDb=t,e.updateClientMetadataAndTryBecomePrimary()})).then((function(){return e.attachVisibilityHandler(),e.attachWindowUnloadHook(),e.scheduleClientMetadataAndPrimaryLeaseRefreshes(),e.simpleDb.runTransaction("readonly-idempotent",[xu.store],(function(e){return da(e)}))})).then((function(t){e.listenSequence=new Pi(t,e.sequenceNumberSyncer)})).then((function(){e._started=!0})).catch((function(t){return e.simpleDb&&e.simpleDb.close(),Promise.reject(t)}))},Sc.prototype.setPrimaryStateListener=function(e){var t=this;return this.primaryStateListener=function(n){return a(t,void 0,void 0,(function(){return s(this,(function(t){return this.started?[2,e(n)]:[2]}))}))},e(this.isPrimary)},Sc.prototype.setDatabaseDeletedListener=function(e){var t=this;this.simpleDb.setVersionChangeListener((function(n){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return null!==n.newVersion?[3,2]:[4,e()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},Sc.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget((function(){return a(t,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})))},Sc.prototype.updateClientMetadataAndTryBecomePrimary=function(){var e=this;return this.simpleDb.runTransaction("readwrite-idempotent",Vu,(function(t){return Cc(t).put(new Lu(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next((function(){if(e.isPrimary)return e.verifyPrimaryLease(t).next((function(t){t||(e.isPrimary=!1,e.queue.enqueueAndForget((function(){return e.primaryStateListener(!1)})))}))})).next((function(){return e.canActAsPrimary(t)})).next((function(n){return e.isPrimary&&!n?e.releasePrimaryLeaseIfHeld(t).next((function(){return!1})):!!n&&e.acquireOrExtendPrimaryLease(t).next((function(){return!0}))}))})).catch((function(t){if(!e.allowTabSynchronization)throw t;return qr(vc,"Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.queue.enqueueAndForget((function(){return e.primaryStateListener(t)})),e.isPrimary=t}))},Sc.prototype.verifyPrimaryLease=function(e){var t=this;return Ic(e).get(pu.key).next((function(e){return Bo.resolve(t.isLocalClient(e))}))},Sc.prototype.removeClientMetadata=function(e){return Cc(e).delete(this.clientId)},Sc.prototype.maybeGarbageCollectMultiClientState=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){switch(t.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(t){var n=Sc.getStore(t,Lu.store);return n.loadAll().next((function(t){var r=e.filterActiveClients(t,18e5),i=t.filter((function(e){return-1===r.indexOf(e)}));return Bo.forEach(i,(function(e){return n.delete(e.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:t.sent().forEach((function(t){e.window.localStorage.removeItem(e.zombiedClientLocalStorageKey(t.clientId))})),t.label=2;case 2:return[2]}}))}))},Sc.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(Hi.ClientMetadataRefresh,4e3,(function(){return e.updateClientMetadataAndTryBecomePrimary().then((function(){return e.maybeGarbageCollectMultiClientState()})).then((function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},Sc.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},Sc.prototype.canActAsPrimary=function(e){var t=this;return Ic(e).get(pu.key).next((function(n){if(null!==n&&t.isWithinAge(n.leaseTimestampMs,5e3)&&!t.isClientZombied(n.ownerId)){if(t.isLocalClient(n)&&t.networkEnabled)return!0;if(!t.isLocalClient(n)){if(!n.allowTabSynchronization)throw new Hr(Qr.FAILED_PRECONDITION,bc);return!1}}return!(!t.networkEnabled||!t.inForeground)||Cc(e).loadAll().next((function(e){return void 0===t.filterActiveClients(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&qr(vc,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e}))},Sc.prototype.shutdown=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){switch(t.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[pu.store,Lu.store],(function(t){return e.releasePrimaryLeaseIfHeld(t).next((function(){return e.removeClientMetadata(t)}))}))];case 1:return t.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},Sc.prototype.filterActiveClients=function(e,t){var n=this;return e.filter((function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)}))},Sc.prototype.getActiveClients=function(){var e=this;return this.simpleDb.runTransaction("readonly-idempotent",[Lu.store],(function(t){return Cc(t).loadAll().next((function(t){return e.filterActiveClients(t,18e5).map((function(e){return e.clientId}))}))}))},Sc.clearPersistence=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return Sc.isAvailable()?(t=e+Sc.MAIN_DATABASE,[4,$o.delete(t)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))},Object.defineProperty(Sc.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),Sc.prototype.getMutationQueue=function(e){return jr(this.started,"Cannot initialize MutationQueue before persistence is started."),ea.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},Sc.prototype.getTargetCache=function(){return jr(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},Sc.prototype.getRemoteDocumentCache=function(){return jr(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},Sc.prototype.getIndexManager=function(){return jr(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},Sc.prototype.runTransaction=function(e,t,n){var r=this;qr(vc,"Starting transaction:",e);var i,o=t.endsWith("idempotent"),a=t.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(a,Vu,(function(o){return i=new wc(o,r.listenSequence.next()),"readwrite-primary"===t||"readwrite-primary-idempotent"===t?r.verifyPrimaryLease(o).next((function(e){return!!e||r.canActAsPrimary(o)})).next((function(t){if(!t)throw Vr("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new Hr(Qr.FAILED_PRECONDITION,Yu);return n(i)})).next((function(e){return r.acquireOrExtendPrimaryLease(o).next((function(){return e}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(i)}))})).then((function(e){return i.raiseOnCommittedEvent(),e}))},Sc.prototype.verifyAllowTabSynchronization=function(e){var t=this;return Ic(e).get(pu.key).next((function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!e.allowTabSynchronization)throw new Hr(Qr.FAILED_PRECONDITION,bc)}))},Sc.prototype.acquireOrExtendPrimaryLease=function(e){var t=new pu(this.clientId,this.allowTabSynchronization,Date.now());return Ic(e).put(pu.key,t)},Sc.isAvailable=function(){return $o.isAvailable()},Sc.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},Sc.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=Ic(e);return n.get(pu.key).next((function(e){return t.isLocalClient(e)?(qr(vc,"Releasing primary lease."),n.delete(pu.key)):Bo.resolve()}))},Sc.prototype.isWithinAge=function(e,t){var n=Date.now();return!(e<n-t||n<e&&(Vr("Detected an update time that is in the future: "+e+" > "+n),1))},Sc.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},Sc.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(jr(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},Sc.prototype.attachWindowUnloadHook=function(){var e=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){e.markClientZombied(),e.queue.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},Sc.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(jr("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},Sc.prototype.isClientZombied=function(e){try{var t=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(e));return qr(vc,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(e){return Vr(vc,"Failed to get zombied client id.",e),!1}},Sc.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){Vr("Failed to set zombie client id.",e)}},Sc.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},Sc.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},Sc.MAIN_DATABASE="main",Sc);function Sc(e,t,n,r,i,o,a,s){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.queue=o,this.sequenceNumberSyncer=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},this.referenceDelegate=new Ac(this,i),this.dbName=t+Sc.MAIN_DATABASE,this.serializer=new Ku(a),this.document=r.document,this.targetCache=new la(this.referenceDelegate,this.serializer),this.indexManager=new $u,this.remoteDocumentCache=new Js(this.serializer,this.indexManager),!r.window||!r.window.localStorage)throw new Hr(Qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}function Ic(e){return e.store(pu.store)}function Cc(e){return e.store(Lu.store)}var Ac=(Dc.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocmentCount(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},Dc.prototype.orphanedDocmentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,(function(e){t++})).next((function(){return t}))},Dc.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},Dc.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){return this.forEachOrphanedDocument(e,(function(e,n){return t(n)}))},Dc.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},Dc.prototype.addReference=function(e,t){return Nc(e,t)},Dc.prototype.removeReference=function(e,t){return Nc(e,t)},Dc.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},Dc.prototype.removeMutationReference=function(e,t){return Nc(e,t)},Dc.prototype.isPinned=function(e,t){return this.inMemoryPins.containsKey(t)?Bo.resolve(!0):function(e,t){var n=!1;return sa(e).iterateSerial((function(r){return na(e,r,t).next((function(e){return e&&(n=!0),Bo.resolve(!e)}))})).next((function(){return n}))}(e,t)},Dc.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(e,(function(a,s){if(s<=t){var u=n.isPinned(e,a).next((function(t){if(!t)return o++,r.getEntry(e,a).next((function(){return r.removeEntry(a),ma(e).delete(function(e){return[0,no(e.path)]}(a))}))}));i.push(u)}})).next((function(){return Bo.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return o}))},Dc.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)},Dc.prototype.updateLimboDocument=function(e,t){return Nc(e,t)},Dc.prototype.forEachOrphanedDocument=function(e,t){var n,r=ma(e),i=Pi.INVALID;return r.iterate({index:ku.documentTargetsIndex},(function(e,r){var o=e[0],a=(e[1],r.path),s=r.sequenceNumber;0===o?(i!==Pi.INVALID&&t(new Gi(oo(n)),i),i=s,n=a):i=Pi.INVALID})).next((function(){i!==Pi.INVALID&&t(new Gi(oo(n)),i)}))},Dc.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},Dc);function Dc(e,t){this.db=e,this.inMemoryPins=null,this.garbageCollector=new mc(this,t)}function Nc(e,t){return ma(e).put(function(e,t){return new ku(0,no(e.path),t)}(t,e.currentSequenceNumber))}var kc=Number,_c=kc.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),xc=kc.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Rc=kc.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function Mc(e){return null==e}function Oc(e){return Rc(e)&&e<=xc&&_c<=e}var Pc,Lc,Fc=(Bc.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();null!==this.collectionGroup&&(e+="|cg:"+this.collectionGroup),e+="|f:";for(var t=0,n=this.filters;t<n.length;t++)e+=n[t].canonicalId(),e+=",";e+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)e+=i[r].canonicalId(),e+=",";Mc(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},Bc.prototype.toString=function(){var e=this.path.canonicalString();return null!==this.collectionGroup&&(e+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(e+=", filters: ["+this.filters.join(", ")+"]"),Mc(this.limit)||(e+=", limit: "+this.limit),0<this.orderBy.length&&(e+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),"Target("+e+")"},Bc.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(var t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return this.collectionGroup===e.collectionGroup&&!!this.path.isEqual(e.path)&&!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)},Bc.prototype.isDocumentQuery=function(){return Gi.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},Bc);function Bc(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}(Lc=Pc=Pc||{}).First="F",Lc.Last="L";var qc=(Vc.atPath=function(e){return new Vc(e)},Object.defineProperty(Vc.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)e.isKeyField()?this.memoizedOrderBy=[pl]:this.memoizedOrderBy=[new hl(e),pl];else{jr(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field.");for(var n=!(this.memoizedOrderBy=[]),r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:sl.ASCENDING;this.memoizedOrderBy.push(a===sl.ASCENDING?pl:dl)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),Vc.prototype.addFilter=function(e){jr(null==this.getInequalityFilterField()||!(e instanceof Wc)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),jr(!this.isDocumentQuery(),"No filtering allowed for document query");var t=this.filters.concat([e]);return new Vc(this.path,this.collectionGroup,this.explicitOrderBy.slice(),t,this.limit,this.limitType,this.startAt,this.endAt)},Vc.prototype.addOrderBy=function(e){jr(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var t=this.explicitOrderBy.concat([e]);return new Vc(this.path,this.collectionGroup,t,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},Vc.prototype.withLimitToFirst=function(e){return new Vc(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,Pc.First,this.startAt,this.endAt)},Vc.prototype.withLimitToLast=function(e){return new Vc(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,Pc.Last,this.startAt,this.endAt)},Vc.prototype.withStartAt=function(e){return new Vc(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,e,this.endAt)},Vc.prototype.withEndAt=function(e){return new Vc(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,e)},Vc.prototype.asCollectionQueryAtPath=function(e){return new Vc(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},Vc.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},Vc.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},Vc.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},Vc.prototype.isEqual=function(e){return this.toTarget().isEqual(e.toTarget())&&this.limitType===e.limitType},Vc.prototype.docComparator=function(e,t){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return jr(n,"orderBy used that doesn't compare on key field"),0},Vc.prototype.matches=function(e){return this.matchesPathAndCollectionGroup(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},Vc.prototype.hasLimitToFirst=function(){return!Mc(this.limit)&&this.limitType===Pc.First},Vc.prototype.hasLimitToLast=function(){return!Mc(this.limit)&&this.limitType===Pc.Last},Vc.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},Vc.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var n=t[e];if(n instanceof Wc&&n.isInequality())return n.field}return null},Vc.prototype.findFilterOperator=function(e){for(var t=0,n=this.filters;t<n.length;t++){var r=n[t];if(r instanceof Wc&&0<=e.indexOf(r.op))return r.op}return null},Vc.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},Vc.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},Vc.prototype.toTarget=function(){if(!this.memoizedTarget)if(this.limitType===Pc.First)this.memoizedTarget=new Fc(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var e=[],t=0,n=this.orderBy;t<n.length;t++){var r=n[t],i=r.dir===sl.DESCENDING?sl.ASCENDING:sl.DESCENDING;e.push(new hl(r.field,i))}var o=this.endAt?new cl(this.endAt.position,!this.endAt.before):null,a=this.startAt?new cl(this.startAt.position,!this.startAt.before):null;this.memoizedTarget=new Fc(this.path,this.collectionGroup,e,this.filters,this.limit,o,a)}return this.memoizedTarget},Vc.prototype.matchesPathAndCollectionGroup=function(e){var t=e.key.path;return null!==this.collectionGroup?e.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(t):Gi.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isImmediateParentOf(t)},Vc.prototype.matchesOrderBy=function(e){for(var t=0,n=this.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&null===e.field(r.field))return!1}return!0},Vc.prototype.matchesFilters=function(e){for(var t=0,n=this.filters;t<n.length;t++)if(!n[t].matches(e))return!1;return!0},Vc.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,e))},Vc.prototype.assertValidBound=function(e){jr(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},Vc);function Vc(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=Pc.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}var $c=(Uc.fromString=function(e){switch(e){case"<":return Uc.LESS_THAN;case"<=":return Uc.LESS_THAN_OR_EQUAL;case"==":return Uc.EQUAL;case">=":return Uc.GREATER_THAN_OR_EQUAL;case">":return Uc.GREATER_THAN;case"array-contains":return Uc.ARRAY_CONTAINS;case"in":return Uc.IN;case"array-contains-any":return Uc.ARRAY_CONTAINS_ANY;default:return Ur("Unknown FieldFilter operator: "+e)}},Uc.prototype.toString=function(){return this.name},Uc.prototype.isEqual=function(e){return this.name===e.name},Uc.LESS_THAN=new Uc("<"),Uc.LESS_THAN_OR_EQUAL=new Uc("<="),Uc.EQUAL=new Uc("=="),Uc.GREATER_THAN=new Uc(">"),Uc.GREATER_THAN_OR_EQUAL=new Uc(">="),Uc.ARRAY_CONTAINS=new Uc("array-contains"),Uc.IN=new Uc("in"),Uc.ARRAY_CONTAINS_ANY=new Uc("array-contains-any"),Uc);function Uc(e){this.name=e}var jc,Wc=(n(zc,jc=function(){}),zc.create=function(e,t,n){if(e.isKeyField())return t===$c.IN?(jr(n instanceof Os,"Comparing on key with IN, but filter value not an ArrayValue"),jr(n.internalValue.every((function(e){return e instanceof Cs})),"Comparing on key with IN, but an array value was not a RefValue"),new Yc(e,n)):(jr(n instanceof Cs,"Comparing on key, but filter value not a RefValue"),jr(t!==$c.ARRAY_CONTAINS&&t!==$c.ARRAY_CONTAINS_ANY,"'"+t.toString()+"' queries don't make sense on document keys."),new Gc(e,t,n));if(n.isEqual(Xa.INSTANCE)){if(t!==$c.EQUAL)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new zc(e,t,n)}if(n.isEqual(ls.NAN)){if(t!==$c.EQUAL)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new zc(e,t,n)}return t===$c.ARRAY_CONTAINS?new Zc(e,n):t===$c.IN?(jr(n instanceof Os,"IN filter has invalid value: "+n.toString()),new nl(e,n)):t===$c.ARRAY_CONTAINS_ANY?(jr(n instanceof Os,"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new ol(e,n)):new zc(e,t,n)},zc.prototype.matches=function(e){var t=e.field(this.field);return null!==t&&this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},zc.prototype.matchesComparison=function(e){switch(this.op){case $c.LESS_THAN:return e<0;case $c.LESS_THAN_OR_EQUAL:return e<=0;case $c.EQUAL:return 0===e;case $c.GREATER_THAN:return 0<e;case $c.GREATER_THAN_OR_EQUAL:return 0<=e;default:return Ur("Unknown FieldFilter operator: "+this.op)}},zc.prototype.isInequality=function(){return 0<=[$c.LESS_THAN,$c.LESS_THAN_OR_EQUAL,$c.GREATER_THAN,$c.GREATER_THAN_OR_EQUAL].indexOf(this.op)},zc.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},zc.prototype.isEqual=function(e){return e instanceof zc&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},zc.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},zc);function zc(e,t,n){var r=jc.call(this)||this;return r.field=e,r.op=t,r.value=n,r}var Kc,Gc=(n(Qc,Kc=Wc),Qc.prototype.matches=function(e){var t=this.value,n=Gi.comparator(e.key,t.key);return this.matchesComparison(n)},Qc);function Qc(){return null!==Kc&&Kc.apply(this,arguments)||this}var Hc,Yc=(n(Xc,Hc=Wc),Xc.prototype.matches=function(e){return this.value.internalValue.some((function(t){return e.key.isEqual(t.key)}))},Xc);function Xc(e,t){var n=Hc.call(this,e,$c.IN,t)||this;return n.value=t,n}var Jc,Zc=(n(el,Jc=Wc),el.prototype.matches=function(e){var t=e.field(this.field);return t instanceof Os&&t.contains(this.value)},el);function el(e,t){return Jc.call(this,e,$c.ARRAY_CONTAINS,t)||this}var tl,nl=(n(rl,tl=Wc),rl.prototype.matches=function(e){var t=this.value,n=e.field(this.field);return null!==n&&t.contains(n)},rl);function rl(e,t){var n=tl.call(this,e,$c.IN,t)||this;return n.value=t,n}var il,ol=(n(al,il=Wc),al.prototype.matches=function(e){var t=this,n=e.field(this.field);return n instanceof Os&&n.internalValue.some((function(e){return t.value.contains(e)}))},al);function al(e,t){var n=il.call(this,e,$c.ARRAY_CONTAINS_ANY,t)||this;return n.value=t,n}var sl=(ul.prototype.toString=function(){return this.name},ul.ASCENDING=new ul("asc"),ul.DESCENDING=new ul("desc"),ul);function ul(e){this.name=e}var cl=(ll.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,n=this.position;t<n.length;t++)e+=n[t].toString();return e},ll.prototype.sortsBeforeDocument=function(e,t){jr(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=e[r],o=this.position[r];if(i.field.isKeyField())jr(o instanceof Cs,"Bound has a non-key value where the key path is being used."),n=Gi.comparator(o.key,t.key);else{var a=t.field(i.field);jr(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===sl.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},ll.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++){var n=this.position[t],r=e.position[t];if(!n.isEqual(r))return!1}return!0},ll);function ll(e,t){this.position=e,this.before=t}var hl=(fl.prototype.compare=function(e,t){var n=this.isKeyOrderBy?qs.compareByKey(e,t):qs.compareByField(this.field,e,t);switch(this.dir){case sl.ASCENDING:return n;case sl.DESCENDING:return-1*n;default:return Ur("Unknown direction: "+this.dir)}},fl.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},fl.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},fl.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},fl);function fl(e,t){this.field=e,void 0===t&&(t=sl.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}var pl=new hl(zi.keyField(),sl.ASCENDING),dl=new hl(zi.keyField(),sl.DESCENDING),ml=(gl.prototype.setLocalDocumentsView=function(e){this.localDocumentsView=e},gl.prototype.getDocumentsMatchingQuery=function(e,t,n,r){var i=this;return jr(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),t.matchesAllDocuments()?this.executeFullCollectionScan(e,t):n.isEqual(uo.MIN)?this.executeFullCollectionScan(e,t):this.localDocumentsView.getDocuments(e,r).next((function(o){var a=i.applyQuery(t,o);return(t.hasLimitToFirst()||t.hasLimitToLast())&&i.needsRefill(t.limitType,a,r,n)?i.executeFullCollectionScan(e,t):(Fr()<=Dr.DEBUG&&qr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),t.toString()),i.localDocumentsView.getDocumentsMatchingQuery(e,t,n).next((function(e){return a.forEach((function(t){e=e.insert(t.key,t)})),e})))}))},gl.prototype.applyQuery=function(e,t){var n=new bo((function(t,n){return e.docComparator(t,n)}));return t.forEach((function(t,r){r instanceof qs&&e.matches(r)&&(n=n.add(r))})),n},gl.prototype.needsRefill=function(e,t,n,r){if(n.size!==t.size)return!0;var i=e===Pc.First?t.last():t.first();return!!i&&(i.hasPendingWrites||0<i.version.compareTo(r))},gl.prototype.executeFullCollectionScan=function(e,t){return Fr()<=Dr.DEBUG&&qr("IndexFreeQueryEngine","Using full collection scan to execute query: %s",t.toString()),this.localDocumentsView.getDocumentsMatchingQuery(e,t,uo.MIN)},gl);function gl(){}var yl=(vl.prototype.checkEmpty=function(e){return Bo.resolve(0===this.mutationQueue.length)},vl.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");jr(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return jr(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,Bo.resolve()},vl.prototype.getLastStreamToken=function(e){return Bo.resolve(this.lastStreamToken)},vl.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,Bo.resolve()},vl.prototype.addMutationBatch=function(e,t,n,r){jr(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&jr(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Oo(i,t,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new tc(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}return Bo.resolve(o)},vl.prototype.lookupMutationBatch=function(e,t){return Bo.resolve(this.findMutationBatch(t))},vl.prototype.lookupMutationKeys=function(e,t){var n=this.findMutationBatch(t);return jr(null!=n,"Failed to find local mutation batch."),Bo.resolve(n.keys())},vl.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=t+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Bo.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},vl.prototype.getHighestUnacknowledgedBatchId=function(){return Bo.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},vl.prototype.getAllMutationBatches=function(e){return Bo.resolve(this.mutationQueue.slice())},vl.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new tc(t,0),i=new tc(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],(function(e){jr(t.isEqual(e.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(e.targetOrBatchId);jr(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),Bo.resolve(o)},vl.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new bo(Si);return t.forEach((function(e){var t=new tc(e,0),i=new tc(e,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([t,i],(function(t){jr(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),r=r.add(t.targetOrBatchId)}))})),Bo.resolve(this.findMutationBatches(r))},vl.prototype.getAllMutationBatchesAffectingQuery=function(e,t){jr(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,r=n.length+1,i=n;Gi.isDocumentKey(i)||(i=i.child(""));var o=new tc(new Gi(i),0),a=new bo(Si);return this.batchesByDocumentKey.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.targetOrBatchId)),!0)}),o),Bo.resolve(this.findMutationBatches(a))},vl.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.findMutationBatch(e);null!==r&&n.push(r)})),n},vl.prototype.removeMutationBatch=function(e,t){var n=this;jr(0===this.indexOfExistingBatchId(t.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Bo.forEach(t.mutations,(function(i){var o=new tc(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(e,i.key)})).next((function(){n.batchesByDocumentKey=r}))},vl.prototype.removeCachedMutationKeys=function(e){},vl.prototype.containsKey=function(e,t){var n=new tc(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Bo.resolve(t.isEqual(r&&r.key))},vl.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&jr(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Bo.resolve()},vl.prototype.indexOfExistingBatchId=function(e,t){var n=this.indexOfBatchId(e);return jr(0<=n&&n<this.mutationQueue.length,"Batches must exist to be "+t),n},vl.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},vl.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var n=this.mutationQueue[t];return jr(n.batchId===e,"If found batch must match"),n},vl);function vl(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=Kr(),this.batchesByDocumentKey=new bo(tc.compareByKey)}var bl,wl=(Tl.prototype.addEntry=function(e,t,n){jr(!n.isEqual(uo.MIN),"Cannot add a document with a read time of zero");var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(t);return this.docs=this.docs.insert(r,{maybeDocument:t,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())},Tl.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},Tl.prototype.getEntry=function(e,t){var n=this.docs.get(t);return Bo.resolve(n?n.maybeDocument:null)},Tl.prototype.getEntries=function(e,t){var n=this,r=Co();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.maybeDocument:null)})),Bo.resolve(r)},Tl.prototype.getDocumentsMatchingQuery=function(e,t,n){jr(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Do(),i=new Gi(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,l=u.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||c instanceof qs&&t.matches(c)&&(r=r.insert(c.key,c))}return Bo.resolve(r)},Tl.prototype.forEachDocumentKey=function(e,t){return Bo.forEach(this.docs,(function(e){return t(e)}))},Tl.prototype.getNewDocumentChanges=function(e,t){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},Tl.prototype.getLastReadTime=function(e){return Bo.resolve(uo.MIN)},Tl.prototype.newChangeBuffer=function(e){return new Tl.RemoteDocumentChangeBuffer(this)},Tl.prototype.getSize=function(e){return Bo.resolve(this.size)},Tl.RemoteDocumentChangeBuffer=(n(El,bl=Hs),El.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i?n.push(t.documentCache.addEntry(e,i,t.readTime)):t.documentCache.removeEntry(r)})),Bo.waitFor(n)},El.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},El.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},El),Tl);function Tl(e,t){this.indexManager=e,this.sizer=t,this.docs=new lo(Gi.comparator),this.size=0}function El(e){var t=bl.call(this)||this;return t.documentCache=e,t}var Sl=(Il.prototype.forEachTarget=function(e,t){return this.targets.forEach((function(e,n){return t(n)})),Bo.resolve()},Il.prototype.getLastRemoteSnapshotVersion=function(e){return Bo.resolve(this.lastRemoteSnapshotVersion)},Il.prototype.getHighestSequenceNumber=function(e){return Bo.resolve(this.highestSequenceNumber)},Il.prototype.allocateTargetId=function(e){var t=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=t,Bo.resolve(t)},Il.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),Bo.resolve()},Il.prototype.saveTargetData=function(e){this.targets.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},Il.prototype.addTargetData=function(e,t){return jr(!this.targets.has(t.target),"Adding a target that already exists"),this.saveTargetData(t),this.targetCount+=1,Bo.resolve()},Il.prototype.updateTargetData=function(e,t){return jr(this.targets.has(t.target),"Updating a non-existent target"),this.saveTargetData(t),Bo.resolve()},Il.prototype.removeTargetData=function(e,t){return jr(0<this.targetCount,"Removing a target from an empty cache"),jr(this.targets.has(t.target),"Removing a non-existent target from the cache"),this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,Bo.resolve()},Il.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.targets.forEach((function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),Bo.waitFor(o).next((function(){return i}))},Il.prototype.getTargetCount=function(e){return Bo.resolve(this.targetCount)},Il.prototype.getTargetData=function(e,t){var n=this.targets.get(t)||null;return Bo.resolve(n)},Il.prototype.getTargetDataForTarget=function(e,t){return Ur("Not yet implemented.")},Il.prototype.addMatchingKeys=function(e,t,n){this.references.addReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.addReference(e,t))})),Bo.waitFor(i)},Il.prototype.removeMatchingKeys=function(e,t,n){this.references.removeReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.removeReference(e,t))})),Bo.waitFor(i)},Il.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),Bo.resolve()},Il.prototype.getMatchingKeysForTargetId=function(e,t){var n=this.references.referencesForId(t);return Bo.resolve(n)},Il.prototype.containsKey=function(e,t){return Bo.resolve(this.references.containsKey(t))},Il);function Il(e){this.persistence=e,this.targets=new Gs((function(e){return e.canonicalId()})),this.lastRemoteSnapshotVersion=uo.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Zu,this.targetCount=0,this.targetIdGenerator=ua.forTargetCache()}var Cl=(Al.createLruPersistence=function(e,t){return new Al(e,(function(e){return new Rl(e,t)}))},Al.createEagerPersistence=function(e){return new Al(e,(function(e){return new _l(e)}))},Al.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(Al.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),Al.prototype.getActiveClients=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,[this.clientId]]}))}))},Al.prototype.setPrimaryStateListener=function(e){return e(!0)},Al.prototype.setDatabaseDeletedListener=function(){},Al.prototype.setNetworkEnabled=function(e){},Al.prototype.getIndexManager=function(){return this.indexManager},Al.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new yl(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},Al.prototype.getTargetCache=function(){return this.targetCache},Al.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},Al.prototype.runTransaction=function(e,t,n){var r=this;qr("MemoryPersistence","Starting transaction:",e);var i=new Nl(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next((function(e){return r.referenceDelegate.onTransactionCommitted(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))},Al.prototype.mutationQueuesContainKey=function(e,t){return Bo.or(function(e){var t=[];return ti(e,(function(e,n){return t.push(n)})),t}(this.mutationQueues).map((function(n){return function(){return n.containsKey(e,t)}})))},Al);function Al(e,t){var n=this;this.clientId=e,this.mutationQueues={},this.listenSequence=new Pi(0),this._started=!1,this._started=!0,this.referenceDelegate=t(this),this.targetCache=new Sl(this),this.indexManager=new ou,this.remoteDocumentCache=new wl(this.indexManager,(function(e){return n.referenceDelegate.documentSize(e)}))}var Dl,Nl=(n(kl,Dl=Xu),kl);function kl(e){var t=Dl.call(this)||this;return t.currentSequenceNumber=e,t}var _l=(Object.defineProperty(xl.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw Ur("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),xl.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},xl.prototype.addReference=function(e,t){return this.orphanedDocuments.delete(t),Bo.resolve()},xl.prototype.removeReference=function(e,t){return this.orphanedDocuments.add(t),Bo.resolve()},xl.prototype.removeMutationReference=function(e,t){return this.orphanedDocuments.add(t),Bo.resolve()},xl.prototype.removeTarget=function(e,t){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.orphanedDocuments.add(e)}))})).next((function(){return r.removeTargetData(e,t)}))},xl.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},xl.prototype.onTransactionCommitted=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Bo.forEach(this.orphanedDocuments,(function(r){return t.isReferenced(e,r).next((function(e){e||n.removeEntry(r)}))})).next((function(){return t._orphanedDocuments=null,n.apply(e)}))},xl.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next((function(e){e?n.orphanedDocuments.delete(t):n.orphanedDocuments.add(t)}))},xl.prototype.documentSize=function(e){return 0},xl.prototype.isReferenced=function(e,t){var n=this;return Bo.or([function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)},function(){return Bo.resolve(n.inMemoryPins.containsKey(t))}])},xl);function xl(e){this.persistence=e,this.inMemoryPins=null,this._orphanedDocuments=null}var Rl=(Ml.prototype.onTransactionStarted=function(){},Ml.prototype.onTransactionCommitted=function(e){return Bo.resolve()},Ml.prototype.forEachTarget=function(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)},Ml.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},Ml.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,(function(e){t++})).next((function(){return t}))},Ml.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){var n=this;return Bo.forEach(this.orphanedSequenceNumbers,(function(r,i){return n.isPinned(e,r,i).next((function(e){return e?Bo.resolve():t(i)}))}))},Ml.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},Ml.prototype.removeTargets=function(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)},Ml.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(e,(function(i){return n.isPinned(e,i,t).next((function(e){e||(r++,o.removeEntry(i))}))})).next((function(){return o.apply(e)})).next((function(){return r}))},Ml.prototype.removeMutationReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Bo.resolve()},Ml.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)},Ml.prototype.addReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Bo.resolve()},Ml.prototype.removeReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Bo.resolve()},Ml.prototype.updateLimboDocument=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Bo.resolve()},Ml.prototype.documentSize=function(e){var t=e.key.toString().length;return e instanceof qs&&(t+=e.data().approximateByteSize()),t},Ml.prototype.isPinned=function(e,t,n){var r=this;return Bo.or([function(){return r.persistence.mutationQueuesContainKey(e,t)},function(){return Bo.resolve(r.inMemoryPins.containsKey(t))},function(){return r.persistence.getTargetCache().containsKey(e,t)},function(){var e=r.orphanedSequenceNumbers.get(t);return Bo.resolve(void 0!==e&&n<e)}])},Ml.prototype.getCacheSize=function(e){return this.persistence.getRemoteDocumentCache().getSize(e)},Ml);function Ml(e,t){this.persistence=e,this.inMemoryPins=null,this.orphanedSequenceNumbers=new Gs((function(e){return no(e.path)})),this.garbageCollector=new mc(this,t)}var Ol=(Pl.prototype.reset=function(){this.currentBaseMs=0},Pl.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},Pl.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);0<this.currentBaseMs&&qr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,(function(){return t.lastAttemptTime=Date.now(),e()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},Pl.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},Pl.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},Pl);function Pl(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}var Ll,Fl,Bl="PersistentStream";(Fl=Ll=Ll||{})[Fl.Initial=0]="Initial",Fl[Fl.Starting=1]="Starting",Fl[Fl.Open=2]="Open",Fl[Fl.Error=3]="Error",Fl[Fl.Backoff=4]="Backoff";var ql=(Vl.prototype.isStarted=function(){return this.state===Ll.Starting||this.state===Ll.Open||this.state===Ll.Backoff},Vl.prototype.isOpen=function(){return this.state===Ll.Open},Vl.prototype.start=function(){this.state!==Ll.Error?(jr(this.state===Ll.Initial,"Already started"),this.auth()):this.performBackoff()},Vl.prototype.stop=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(Ll.Initial)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},Vl.prototype.inhibitBackoff=function(){jr(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Ll.Initial,this.backoff.reset()},Vl.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,(function(){return e.handleIdleCloseTimer()})))},Vl.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},Vl.prototype.handleIdleCloseTimer=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return this.isOpen()?[2,this.close(Ll.Initial)]:[2]}))}))},Vl.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},Vl.prototype.close=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return jr(this.isStarted(),"Only started streams should be closed."),jr(e===Ll.Error||Mc(t),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,e!==Ll.Error?this.backoff.reset():t&&t.code===Qr.RESOURCE_EXHAUSTED?(Vr(t.toString()),Vr("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===Qr.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.onClose(t)];case 1:return n.sent(),[2]}}))}))},Vl.prototype.tearDown=function(){},Vl.prototype.auth=function(){var e=this;jr(this.state===Ll.Initial,"Must be in initial state to auth"),this.state=Ll.Starting;var t=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(t){e.closeCount===n&&e.startStream(t)}),(function(n){t((function(){var t=new Hr(Qr.UNKNOWN,"Fetching auth token failed: "+n.message);return e.handleStreamClose(t)}))}))},Vl.prototype.startStream=function(e){var t=this;jr(this.state===Ll.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen((function(){n((function(){return jr(t.state===Ll.Starting,"Expected stream to be in state Starting, but was "+t.state),t.state=Ll.Open,t.listener.onOpen()}))})),this.stream.onClose((function(e){n((function(){return t.handleStreamClose(e)}))})),this.stream.onMessage((function(e){n((function(){return t.onMessage(e)}))}))},Vl.prototype.performBackoff=function(){var e=this;jr(this.state===Ll.Error,"Should only perform backoff when in Error state"),this.state=Ll.Backoff,this.backoff.backoffAndRun((function(){return a(e,void 0,void 0,(function(){return s(this,(function(e){return jr(this.state===Ll.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Ll.Initial,this.start(),jr(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},Vl.prototype.handleStreamClose=function(e){return jr(this.isStarted(),"Can't handle server close on non-started stream"),qr(Bl,"close with error: "+e),this.stream=null,this.close(Ll.Error,e)},Vl.prototype.getCloseGuardedDispatcher=function(e){var t=this;return function(n){t.queue.enqueueAndForget((function(){return t.closeCount===e?n():(qr(Bl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},Vl);function Vl(e,t,n,r,i,o){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Ll.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Ol(e,t)}var $l,Ul=(n(jl,$l=ql),jl.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},jl.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),n=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,n)},jl.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var n=this.serializer.toListenRequestLabels(e);n&&(t.labels=n),this.sendRequest(t)},jl.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},jl);function jl(e,t,n,r,i){var o=$l.call(this,e,Hi.ListenStreamConnectionBackoff,Hi.ListenStreamIdle,t,n,i)||this;return o.serializer=r,o}var Wl,zl=(n(Kl,Wl=ql),Object.defineProperty(Kl.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),Kl.prototype.start=function(){this.handshakeComplete_=!1,Wl.prototype.start.call(this)},Kl.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},Kl.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},Kl.prototype.onMessage=function(e){if(jr(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults,e.commitTime),n=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(n,t)}return jr(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},Kl.prototype.writeHandshake=function(){jr(this.isOpen(),"Writing handshake requires an opened stream"),jr(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},Kl.prototype.writeMutations=function(e){var t=this;jr(this.isOpen(),"Writing mutations requires an opened stream"),jr(this.handshakeComplete_,"Handshake must be complete before writing mutations"),jr(0<this.lastStreamToken.length,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:e.map((function(e){return t.serializer.toMutation(e)}))};this.sendRequest(n)},Kl);function Kl(e,t,n,r,i){var o=Wl.call(this,e,Hi.WriteStreamConnectionBackoff,Hi.WriteStreamIdle,t,n,i)||this;return o.serializer=r,o.handshakeComplete_=!1,o.lastStreamToken=Kr(),o}var Gl=(Ql.prototype.newPersistentWriteStream=function(e){return new zl(this.queue,this.connection,this.credentials,this.serializer,e)},Ql.prototype.newPersistentWatchStream=function(e){return new Ul(this.queue,this.connection,this.credentials,this.serializer,e)},Ql.prototype.commit=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,writes:e.map((function(e){return t.serializer.toMutation(e)}))};return this.invokeRPC("Commit",n).then((function(e){return t.serializer.fromWriteResults(e.writeResults,e.commitTime)}))},Ql.prototype.lookup=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,documents:e.map((function(e){return t.serializer.toName(e)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=Io();n.forEach((function(e){var n=t.serializer.fromMaybeDocument(e);r=r.insert(n.key,n)}));var i=[];return e.forEach((function(e){var t=r.get(e);jr(!!t,"Missing entity in write response for "+e),i.push(t)})),i}))},Ql.prototype.invokeRPC=function(e,t){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(e,t,r)})).catch((function(e){throw e.code===Qr.UNAUTHENTICATED&&n.credentials.invalidateToken(),e}))},Ql.prototype.invokeStreamingRPC=function(e,t){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(e,t,r)})).catch((function(e){throw e.code===Qr.UNAUTHENTICATED&&n.credentials.invalidateToken(),e}))},Ql);function Ql(e,t,n,r){this.queue=e,this.connection=t,this.credentials=n,this.serializer=r}var Hl,Yl,Xl,Jl,Zl=(eh.prototype.lookup=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return s(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Hr(Qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(e)];case 1:return(t=r.sent()).forEach((function(e){e instanceof Us||e instanceof qs?n.recordVersion(e):Ur("Document in a transaction was a "+e.constructor.name)})),[2,t]}}))}))},eh.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e)},eh.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e)},eh.prototype.delete=function(e){this.write([new Fa(e,this.precondition(e))]),this.writtenDocs.add(e)},eh.prototype.commit=function(){return a(this,void 0,void 0,(function(){var e,t=this;return s(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach((function(t){e=e.remove(t.key)})),e.forEach((function(e,n){t.mutations.push(new Wa(e,t.precondition(e)))})),[4,this.datastore.commit(this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},eh.prototype.recordVersion=function(e){var t;if(e instanceof qs)t=e.version;else{if(!(e instanceof Us))throw Ur("Document in a transaction was a "+e.constructor.name);t=uo.forDeletedDoc()}var n=this.readVersions.get(e.key);if(null!==n){if(!t.isEqual(n))throw new Hr(Qr.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},eh.prototype.precondition=function(e){var t=this.readVersions.get(e);return!this.writtenDocs.has(e)&&t?Sa.updateTime(t):Sa.NONE},eh.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(this.writtenDocs.has(e)||!t)return Sa.exists(!0);if(t.isEqual(uo.forDeletedDoc()))throw new Hr(Qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Sa.updateTime(t)},eh.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},eh.prototype.ensureCommitNotCalled=function(){jr(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},eh);function eh(e){this.datastore=e,this.readVersions=ko(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}(Yl=Hl=Hl||{})[Yl.Unknown=0]="Unknown",Yl[Yl.Online=1]="Online",Yl[Yl.Offline=2]="Offline",(Jl=Xl=Xl||{})[Jl.RemoteStore=0]="RemoteStore",Jl[Jl.SharedClientState=1]="SharedClientState";var th,nh,rh=(ih.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Hl.Unknown),jr(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(Hi.OnlineStateTimeout,1e4,(function(){return e.onlineStateTimer=null,jr(e.state===Hl.Unknown,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast(Hl.Offline),Promise.resolve()})))},ih.prototype.handleWatchStreamFailure=function(e){this.state===Hl.Online?(this.setAndBroadcast(Hl.Unknown),jr(0===this.watchStreamFailures,"watchStreamFailures must be 0"),jr(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,1<=this.watchStreamFailures&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast(Hl.Offline)))},ih.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===Hl.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},ih.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},ih.prototype.logClientOfflineWarningIfNecessary=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(Vr(t),this.shouldWarnClientIsOffline=!1):qr("OnlineStateTracker",t)},ih.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},ih);function ih(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=Hl.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}function oh(e){switch(e){case Qr.OK:return Ur("Treated status OK as error");case Qr.CANCELLED:case Qr.UNKNOWN:case Qr.DEADLINE_EXCEEDED:case Qr.RESOURCE_EXHAUSTED:case Qr.INTERNAL:case Qr.UNAVAILABLE:case Qr.UNAUTHENTICATED:return!1;case Qr.INVALID_ARGUMENT:case Qr.NOT_FOUND:case Qr.ALREADY_EXISTS:case Qr.PERMISSION_DENIED:case Qr.FAILED_PRECONDITION:case Qr.ABORTED:case Qr.OUT_OF_RANGE:case Qr.UNIMPLEMENTED:case Qr.DATA_LOSS:return!0;default:return Ur("Unknown status code: "+e)}}function ah(e){if(void 0===e)return Vr("GRPC error has no .code"),Qr.UNKNOWN;switch(e){case th.OK:return Qr.OK;case th.CANCELLED:return Qr.CANCELLED;case th.UNKNOWN:return Qr.UNKNOWN;case th.DEADLINE_EXCEEDED:return Qr.DEADLINE_EXCEEDED;case th.RESOURCE_EXHAUSTED:return Qr.RESOURCE_EXHAUSTED;case th.INTERNAL:return Qr.INTERNAL;case th.UNAVAILABLE:return Qr.UNAVAILABLE;case th.UNAUTHENTICATED:return Qr.UNAUTHENTICATED;case th.INVALID_ARGUMENT:return Qr.INVALID_ARGUMENT;case th.NOT_FOUND:return Qr.NOT_FOUND;case th.ALREADY_EXISTS:return Qr.ALREADY_EXISTS;case th.PERMISSION_DENIED:return Qr.PERMISSION_DENIED;case th.FAILED_PRECONDITION:return Qr.FAILED_PRECONDITION;case th.ABORTED:return Qr.ABORTED;case th.OUT_OF_RANGE:return Qr.OUT_OF_RANGE;case th.UNIMPLEMENTED:return Qr.UNIMPLEMENTED;case th.DATA_LOSS:return Qr.DATA_LOSS;default:return Ur("Unknown status code: "+e)}}(nh=th=th||{})[nh.OK=0]="OK",nh[nh.CANCELLED=1]="CANCELLED",nh[nh.UNKNOWN=2]="UNKNOWN",nh[nh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nh[nh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nh[nh.NOT_FOUND=5]="NOT_FOUND",nh[nh.ALREADY_EXISTS=6]="ALREADY_EXISTS",nh[nh.PERMISSION_DENIED=7]="PERMISSION_DENIED",nh[nh.UNAUTHENTICATED=16]="UNAUTHENTICATED",nh[nh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nh[nh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nh[nh.ABORTED=10]="ABORTED",nh[nh.OUT_OF_RANGE=11]="OUT_OF_RANGE",nh[nh.UNIMPLEMENTED=12]="UNIMPLEMENTED",nh[nh.INTERNAL=13]="INTERNAL",nh[nh.UNAVAILABLE=14]="UNAVAILABLE",nh[nh.DATA_LOSS=15]="DATA_LOSS";var sh,uh,ch,lh,hh=(fh.emptySet=function(e){return new fh(e.comparator)},fh.prototype.has=function(e){return null!=this.keyedMap.get(e)},fh.prototype.get=function(e){return this.keyedMap.get(e)},fh.prototype.first=function(){return this.sortedSet.minKey()},fh.prototype.last=function(){return this.sortedSet.maxKey()},fh.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},fh.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(fh.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),fh.prototype.forEach=function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))},fh.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},fh.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},fh.prototype.isEqual=function(e){if(!(e instanceof fh))return!1;if(this.size!==e.size)return!1;for(var t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},fh.prototype.toString=function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},fh.prototype.copy=function(e,t){var n=new fh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n},fh);function fh(e){this.comparator=e?function(t,n){return e(t,n)||Gi.comparator(t.key,n.key)}:function(e,t){return Gi.comparator(e.key,t.key)},this.keyedMap=Do(),this.sortedSet=new lo(this.comparator)}(uh=sh=sh||{})[uh.Added=0]="Added",uh[uh.Removed=1]="Removed",uh[uh.Modified=2]="Modified",uh[uh.Metadata=3]="Metadata",(lh=ch=ch||{})[lh.Local=0]="Local",lh[lh.Synced=1]="Synced";var ph=(dh.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);n?e.type!==sh.Added&&n.type===sh.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===sh.Metadata&&n.type!==sh.Removed?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===sh.Modified&&n.type===sh.Modified?this.changeMap=this.changeMap.insert(t,{type:sh.Modified,doc:e.doc}):e.type===sh.Modified&&n.type===sh.Added?this.changeMap=this.changeMap.insert(t,{type:sh.Added,doc:e.doc}):e.type===sh.Removed&&n.type===sh.Added?this.changeMap=this.changeMap.remove(t):e.type===sh.Removed&&n.type===sh.Modified?this.changeMap=this.changeMap.insert(t,{type:sh.Removed,doc:n.doc}):e.type===sh.Added&&n.type===sh.Removed?this.changeMap=this.changeMap.insert(t,{type:sh.Modified,doc:e.doc}):Ur("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(t,e)},dh.prototype.getChanges=function(){var e=[];return this.changeMap.inorderTraversal((function(t,n){e.push(n)})),e},dh);function dh(){this.changeMap=new lo(Gi.comparator)}var mh=(gh.fromInitialDocuments=function(e,t,n,r){var i=[];return t.forEach((function(e){i.push({type:sh.Added,doc:e})})),new gh(e,t,hh.emptySet(t),i,n,r,!0,!1)},Object.defineProperty(gh.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),gh.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&this.query.isEqual(e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},gh);function gh(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}var yh=(vh.createSynthesizedRemoteEventForCurrentChange=function(e,t){var n,r=((n={})[e]=bh.createSynthesizedTargetChangeForCurrentChange(e,t),n);return new vh(uo.MIN,r,Mo(),Io(),xo())},vh);function vh(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}var bh=(wh.createSynthesizedTargetChangeForCurrentChange=function(e,t){return new wh(Kr(),t,xo(),xo(),xo())},wh);function wh(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}var Th,Eh,Sh=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},Ih=function(e,t){this.targetId=e,this.existenceFilter=t};(Eh=Th=Th||{})[Eh.NoChange=0]="NoChange",Eh[Eh.Added=1]="Added",Eh[Eh.Removed=2]="Removed",Eh[Eh.Current=3]="Current",Eh[Eh.Reset=4]="Reset";var Ch=function(e,t,n,r){void 0===n&&(n=Kr()),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Ah=(Object.defineProperty(Dh.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),Dh.prototype.updateResumeToken=function(e){0<e.length&&(this._hasPendingChanges=!0,this._resumeToken=e)},Dh.prototype.toTargetChange=function(){var e=xo(),t=xo(),n=xo();return this.documentChanges.forEach((function(r,i){switch(i){case sh.Added:e=e.add(r);break;case sh.Modified:t=t.add(r);break;case sh.Removed:n=n.add(r);break;default:Ur("Encountered invalid change type: "+i)}})),new bh(this._resumeToken,this._current,e,t,n)},Dh.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=xh()},Dh.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},Dh.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},Dh.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},Dh.prototype.recordTargetResponse=function(){this.pendingResponses-=1},Dh.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},Dh);function Dh(){this.pendingResponses=0,this.documentChanges=xh(),this._resumeToken=Kr(),this._current=!1,this._hasPendingChanges=!0}var Nh=(kh.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++){var r=n[t];e.newDoc instanceof qs?this.addDocumentToTarget(r,e.newDoc):e.newDoc instanceof Us&&this.removeDocumentFromTarget(r,e.key,e.newDoc)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)r=o[i],this.removeDocumentFromTarget(r,e.key,e.newDoc)},kh.prototype.handleTargetChange=function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.ensureTargetState(n);switch(e.state){case Th.NoChange:t.isActiveTarget(n)&&r.updateResumeToken(e.resumeToken);break;case Th.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case Th.Removed:r.recordTargetResponse(),r.isPending||t.removeTarget(n),jr(!e.cause,"WatchChangeAggregator does not handle errored targets");break;case Th.Current:t.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case Th.Reset:t.isActiveTarget(n)&&(t.resetTarget(n),r.updateResumeToken(e.resumeToken));break;default:Ur("Unknown target watch change state: "+e.state)}}))},kh.prototype.forEachTarget=function(e,t){0<e.targetIds.length?e.targetIds.forEach(t):ei(this.targetStates,t)},kh.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new Gi(i.path);this.removeDocumentFromTarget(t,o,new Us(o,uo.forDeletedDoc()))}else jr(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t))}},kh.prototype.createRemoteEvent=function(e){var t=this,n={};ei(this.targetStates,(function(r,i){var o=t.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new Gi(o.target.path);null!==t.pendingDocumentUpdates.get(a)||t.targetContainsDocument(r,a)||t.removeDocumentFromTarget(r,a,new Us(a,e))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}}));var r=xo();this.pendingDocumentTargetMapping.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.targetDataForActiveTarget(e);return!n||n.purpose===Bu.LimboResolution||(i=!1)})),i&&(r=r.add(e))}));var i=new yh(e,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Io(),this.pendingDocumentTargetMapping=_h(),this.pendingTargetResets=new bo(Si),i},kh.prototype.addDocumentToTarget=function(e,t){if(this.isActiveTarget(e)){var n=this.targetContainsDocument(e,t.key)?sh.Modified:sh.Added;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}},kh.prototype.removeDocumentFromTarget=function(e,t,n){if(this.isActiveTarget(e)){var r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,sh.Removed):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}},kh.prototype.removeTarget=function(e){delete this.targetStates[e]},kh.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},kh.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},kh.prototype.ensureTargetState=function(e){return this.targetStates[e]||(this.targetStates[e]=new Ah),this.targetStates[e]},kh.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new bo(Si),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},kh.prototype.isActiveTarget=function(e){var t=null!==this.targetDataForActiveTarget(e);return t||qr("WatchChangeAggregator","Detected inactive target",e),t},kh.prototype.targetDataForActiveTarget=function(e){var t=this.targetStates[e];return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)},kh.prototype.resetTarget=function(e){var t=this;jr(!this.targetStates[e].isPending,"Should only reset active targets"),this.targetStates[e]=new Ah,this.metadataProvider.getRemoteKeysForTarget(e).forEach((function(n){t.removeDocumentFromTarget(e,n,null)}))},kh.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},kh);function kh(e){this.metadataProvider=e,this.targetStates={},this.pendingDocumentUpdates=Io(),this.pendingDocumentTargetMapping=_h(),this.pendingTargetResets=new bo(Si)}function _h(){return new lo(Gi.comparator)}function xh(){return new lo(Gi.comparator)}var Rh="RemoteStore",Mh=(Oh.prototype.start=function(){return this.enableNetwork()},Oh.prototype.enableNetwork=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(e=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Hl.Unknown),[4,this.fillWritePipeline()];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},Oh.prototype.disableNetwork=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(Hl.Offline),[2]}}))}))},Oh.prototype.disableNetworkInternal=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.writeStream.stop()];case 1:return e.sent(),[4,this.watchStream.stop()];case 2:return e.sent(),0<this.writePipeline.length&&(qr(Rh,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},Oh.prototype.shutdown=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return qr(Rh,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(Hl.Unknown),[2]}}))}))},Oh.prototype.listen=function(e){Jr(this.listenTargets,e.targetId)||(this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(e))},Oh.prototype.unlisten=function(e){jr(Jr(this.listenTargets,e),"unlisten called on target no currently watched: "+e),delete this.listenTargets[e],this.watchStream.isOpen()&&this.sendUnwatchRequest(e),ni(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Hl.Unknown))},Oh.prototype.getTargetDataForTarget=function(e){return this.listenTargets[e]||null},Oh.prototype.getRemoteKeysForTarget=function(e){return this.syncEngine.getRemoteKeysForTarget(e)},Oh.prototype.sendWatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},Oh.prototype.sendUnwatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},Oh.prototype.startWatchStream=function(){jr(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Nh(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},Oh.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!ni(this.listenTargets)},Oh.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},Oh.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},Oh.prototype.onWatchStreamOpen=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return ei(this.listenTargets,(function(t,n){e.sendWatchRequest(n)})),[2]}))}))},Oh.prototype.onWatchStreamClose=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return void 0===e&&jr(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(e),this.startWatchStream()):this.onlineStateTracker.set(Hl.Unknown),[2]}))}))},Oh.prototype.onWatchStreamChange=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Hl.Online),e instanceof Ch&&e.state===Th.Removed&&e.cause?[2,this.handleTargetError(e)]:(e instanceof Sh?this.watchChangeAggregator.handleDocumentChange(e):e instanceof Ih?this.watchChangeAggregator.handleExistenceFilter(e):(jr(e instanceof Ch,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(e)),t.isEqual(uo.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),0<=t.compareTo(n)?[4,this.raiseWatchSnapshot(t)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},Oh.prototype.raiseWatchSnapshot=function(e){var t=this;jr(!e.isEqual(uo.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(e);return ei(n.targetChanges,(function(n,r){if(0<r.resumeToken.length){var i=t.listenTargets[n];i&&(t.listenTargets[n]=i.withResumeToken(r.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.listenTargets[e];if(n){t.listenTargets[e]=n.withResumeToken(Kr(),n.snapshotVersion),t.sendUnwatchRequest(e);var r=new Wu(n.target,e,Bu.ExistenceFilterMismatch,n.sequenceNumber);t.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},Oh.prototype.handleTargetError=function(e){var t=this;jr(!!e.cause,"Handling target error without a cause");var n=e.cause,r=Promise.resolve();return e.targetIds.forEach((function(e){r=r.then((function(){return a(t,void 0,void 0,(function(){return s(this,(function(t){return Jr(this.listenTargets,e)?(delete this.listenTargets[e],this.watchChangeAggregator.removeTarget(e),[2,this.syncEngine.rejectListen(e,n)]):[2]}))}))}))})),r},Oh.prototype.fillWritePipeline=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(e=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(e)]):[3,4];case 1:return null!==(t=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(t),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},Oh.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},Oh.prototype.outstandingWrites=function(){return this.writePipeline.length},Oh.prototype.addToWritePipeline=function(e){jr(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(e),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},Oh.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},Oh.prototype.startWriteStream=function(){jr(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},Oh.prototype.onWriteStreamOpen=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return this.writeStream.writeHandshake(),[2]}))}))},Oh.prototype.onWriteHandshakeComplete=function(){var e=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var t=0,n=e.writePipeline;t<n.length;t++){var r=n[t];e.writeStream.writeMutations(r.mutations)}})).catch(ac)},Oh.prototype.onMutationResult=function(e,t){var n=this;jr(0<this.writePipeline.length,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Lo.from(r,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then((function(){return n.fillWritePipeline()}))},Oh.prototype.onWriteStreamClose=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return void 0===e&&jr(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),e&&0<this.writePipeline.length?[2,(this.writeStream.handshakeComplete?this.handleWriteError(e):this.handleHandshakeError(e)).then((function(){t.shouldStartWriteStream()&&t.startWriteStream()}))]:[2]}))}))},Oh.prototype.handleHandshakeError=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return oh(e.code)?(qr(Rh,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=Kr(),[2,this.localStore.setLastStreamToken(Kr()).catch(ac)]):[2]}))}))},Oh.prototype.handleWriteError=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return s(this,(function(r){return function(e){return oh(e)&&e!==Qr.ABORTED}(e.code)?(t=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,e).then((function(){return n.fillWritePipeline()}))]):[2]}))}))},Oh.prototype.createTransaction=function(){return new Zl(this.datastore)},Oh.prototype.restartNetwork=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(Hl.Unknown),[4,this.enableNetwork()];case 2:return e.sent(),[2]}}))}))},Oh.prototype.handleCredentialChange=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.canUseNetwork()?(qr(Rh,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},Oh.prototype.applyPrimaryState=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.disableNetworkInternal()];case 3:t.sent(),this.onlineStateTracker.set(Hl.Unknown),t.label=4;case 4:return[2]}}))}))},Oh);function Oh(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback((function(e){n.enqueueAndForget((function(){return a(o,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.canUseNetwork()?(qr(Rh,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new rh(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}var Ph=(Object.defineProperty(Lh.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(Lh.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),Lh.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},Lh.prototype._compareTo=function(e){return Si(this._lat,e._lat)||Si(this._long,e._long)},Lh);function Lh(e,t){if(ii("GeoPoint",arguments,2),si("GeoPoint","number",1,e),si("GeoPoint","number",2,t),!isFinite(e)||e<-90||90<e)throw new Hr(Qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new Hr(Qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}var Fh=(Bh.prototype.applyToLocalView=function(e,t){return new bs(t,e)},Bh.prototype.applyToRemoteDocument=function(e,t){return t},Bh.prototype.computeBaseValue=function(e){return null},Bh.prototype.isEqual=function(e){return e instanceof Bh},Bh.instance=new Bh,Bh);function Bh(){}var qh=(Vh.prototype.applyToLocalView=function(e,t){return this.apply(e)},Vh.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},Vh.prototype.apply=function(e){for(var t=zh(e),n=function(e){t.find((function(t){return t.isEqual(e)}))||t.push(e)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new Os(t)},Vh.prototype.computeBaseValue=function(e){return null},Vh.prototype.isEqual=function(e){return e instanceof Vh&&Ii(e.elements,this.elements)},Vh);function Vh(e){this.elements=e}var $h=(Uh.prototype.applyToLocalView=function(e,t){return this.apply(e)},Uh.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},Uh.prototype.apply=function(e){for(var t=zh(e),n=function(e){t=t.filter((function(t){return!t.isEqual(e)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new Os(t)},Uh.prototype.computeBaseValue=function(e){return null},Uh.prototype.isEqual=function(e){return e instanceof Uh&&Ii(e.elements,this.elements)},Uh);function Uh(e){this.elements=e}var jh=(Wh.prototype.applyToLocalView=function(e,t){var n=this.computeBaseValue(e);if(n instanceof ss&&this.operand instanceof ss){var r=n.internalValue+this.operand.internalValue;return new ss(r)}return r=n.internalValue+this.operand.internalValue,new ls(r)},Wh.prototype.applyToRemoteDocument=function(e,t){return jr(null!==t,"Didn't receive transformResult for NUMERIC_ADD transform"),t},Wh.prototype.computeBaseValue=function(e){return e instanceof rs?e:new ss(0)},Wh.prototype.isEqual=function(e){return e instanceof Wh&&this.operand.isEqual(e.operand)},Wh);function Wh(e){this.operand=e}function zh(e){return e instanceof Os?e.internalValue.slice():[]}var Kh=(Gh.prototype.isEqual=function(e){return e&&e.count===this.count},Gh);function Gh(e){this.count=e}var Qh,Hh,Yh=((Qh={})[sl.ASCENDING.name]="ASCENDING",Qh[sl.DESCENDING.name]="DESCENDING",Qh),Xh=((Hh={})[$c.LESS_THAN.name]="LESS_THAN",Hh[$c.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",Hh[$c.GREATER_THAN.name]="GREATER_THAN",Hh[$c.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",Hh[$c.EQUAL.name]="EQUAL",Hh[$c.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",Hh[$c.IN.name]="IN",Hh[$c.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",Hh),Jh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zh(e,t){jr(!Mc(e),t+" is missing")}function ef(e){return"number"==typeof e?e:"string"==typeof e?Number(e):Ur("can't parse "+e)}var tf=(nf.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},nf.prototype.unsafeCastProtoByteString=function(e){return e},nf.prototype.fromRpcStatus=function(e){var t=void 0===e.code?Qr.UNKNOWN:ah(e.code);return new Hr(t,e.message||"")},nf.prototype.toInt32Value=function(e){return this.options.useProto3Json||Mc(e)?e:{value:e}},nf.prototype.fromInt32Value=function(e){var t;return Mc(t="object"==typeof e?e.value:e)?null:t},nf.prototype.toTimestamp=function(e){return this.options.useProto3Json?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}},nf.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);jr(!!e,"Cannot deserialize null or undefined timestamp.");var t=ef(e.seconds||"0"),n=e.nanos||0;return new ao(t,n)},nf.prototype.fromIso8601String=function(e){var t=0,n=Jh.exec(e);if(jr(!!n,"invalid timestamp: "+e),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e),o=Math.floor(i.getTime()/1e3);return new ao(o,t)},nf.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},nf.prototype.fromBlob=function(e){return"string"==typeof e?(jr(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Ni.fromBase64String(e)):(jr(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Ni.fromUint8Array(e))},nf.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},nf.prototype.fromVersion=function(e){return jr(!!e,"Trying to deserialize version that isn't set"),uo.fromTimestamp(this.fromTimestamp(e))},nf.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},nf.prototype.fromResourceName=function(e){var t=$i.fromString(e);return jr(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},nf.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},nf.prototype.fromName=function(e){var t=this.fromResourceName(e);return jr(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),jr(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new Gi(this.extractLocalPathFromResourceName(t))},nf.prototype.toQueryPath=function(e){return this.toResourceName(this.databaseId,e)},nf.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?$i.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(nf.prototype,"encodedDatabaseId",{get:function(){return new $i(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),nf.prototype.fullyQualifiedPrefixPath=function(e){return new $i(["projects",e.projectId,"databases",e.database])},nf.prototype.extractLocalPathFromResourceName=function(e){return jr(4<e.length&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},nf.prototype.isValidResourceName=function(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)},nf.prototype.toValue=function(e){if(e instanceof Xa)return{nullValue:"NULL_VALUE"};if(e instanceof es)return{booleanValue:e.value()};if(e instanceof ss)return{integerValue:""+e.value()};if(e instanceof ls){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof ps?{stringValue:e.value()}:e instanceof xs?{mapValue:this.toMapValue(e)}:e instanceof Os?{arrayValue:this.toArrayValue(e)}:e instanceof gs?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof Ns?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof Es?{bytesValue:this.toBytes(e.value())}:e instanceof Cs?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:Ur("Unknown FieldValue "+JSON.stringify(e))},nf.prototype.fromValue=function(e){var t=this;if("nullValue"in e)return Xa.INSTANCE;if("booleanValue"in e)return es.of(e.booleanValue);if("integerValue"in e)return new ss(ef(e.integerValue));if("doubleValue"in e){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return ls.NAN;if("Infinity"===e.doubleValue)return ls.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return ls.NEGATIVE_INFINITY}return new ls(e.doubleValue)}if("stringValue"in e)return new ps(e.stringValue);if("mapValue"in e)return this.fromFields(e.mapValue.fields||{});if("arrayValue"in e){Zh(e.arrayValue,"arrayValue");var n=e.arrayValue.values||[];return new Os(n.map((function(e){return t.fromValue(e)})))}if("timestampValue"in e)return Zh(e.timestampValue,"timestampValue"),new gs(this.fromTimestamp(e.timestampValue));if("geoPointValue"in e){Zh(e.geoPointValue,"geoPointValue");var r=e.geoPointValue.latitude||0,i=e.geoPointValue.longitude||0;return new Ns(new Ph(r,i))}if("bytesValue"in e){Zh(e.bytesValue,"bytesValue");var o=this.fromBlob(e.bytesValue);return new Es(o)}if("referenceValue"in e){Zh(e.referenceValue,"referenceValue");var a=this.fromResourceName(e.referenceValue),s=new Mi(a.get(1),a.get(3)),u=new Gi(this.extractLocalPathFromResourceName(a));return new Cs(s,u)}return Ur("Unknown Value proto "+JSON.stringify(e))},nf.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},nf.prototype.toDocument=function(e){return jr(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toTimestamp(e.version.toTimestamp())}},nf.prototype.fromDocument=function(e,t){var n=this,r=this.fromName(e.name),i=this.fromVersion(e.updateTime);return new qs(r,i,{hasCommittedMutations:!!t},void 0,e,(function(e){return n.fromValue(e)}))},nf.prototype.toFields=function(e){var t=this,n={};return e.forEach((function(e,r){n[e]=t.toValue(r)})),n},nf.prototype.fromFields=function(e){var t=this,n=e,r=xs.EMPTY;return ti(n,(function(e,n){r=r.set(new zi([e]),t.fromValue(n))})),r},nf.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},nf.prototype.toArrayValue=function(e){var t=this,n=[];return e.forEach((function(e){n.push(t.toValue(e))})),{values:n}},nf.prototype.fromFound=function(e){var t=this;jr(!!e.found,"Tried to deserialize a found document from a missing document."),Zh(e.found.name,"doc.found.name"),Zh(e.found.updateTime,"doc.found.updateTime");var n=this.fromName(e.found.name),r=this.fromVersion(e.found.updateTime);return new qs(n,r,{},void 0,e.found,(function(e){return t.fromValue(e)}))},nf.prototype.fromMissing=function(e){jr(!!e.missing,"Tried to deserialize a missing document from a found document."),jr(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),n=this.fromVersion(e.readTime);return new Us(t,n)},nf.prototype.fromMaybeDocument=function(e){return"found"in e?this.fromFound(e):"missing"in e?this.fromMissing(e):Ur("invalid batch get response: "+JSON.stringify(e))},nf.prototype.toWatchTargetChangeState=function(e){switch(e){case Th.Added:return"ADD";case Th.Current:return"CURRENT";case Th.NoChange:return"NO_CHANGE";case Th.Removed:return"REMOVE";case Th.Reset:return"RESET";default:return Ur("Unknown WatchTargetChangeState: "+e)}},nf.prototype.toTestWatchChange=function(e){if(e instanceof Ih)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof Sh){if(e.newDoc instanceof qs){var t=e.newDoc;return{documentChange:{document:{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}}}if(e.newDoc instanceof Us)return t=e.newDoc,{documentDelete:{document:this.toName(t.key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}};if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof Ch){var n=void 0;return e.cause&&(n={code:function(e){if(void 0===e)return th.OK;switch(e){case Qr.OK:return th.OK;case Qr.CANCELLED:return th.CANCELLED;case Qr.UNKNOWN:return th.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return th.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return th.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return th.INTERNAL;case Qr.UNAVAILABLE:return th.UNAVAILABLE;case Qr.UNAUTHENTICATED:return th.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return th.INVALID_ARGUMENT;case Qr.NOT_FOUND:return th.NOT_FOUND;case Qr.ALREADY_EXISTS:return th.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return th.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return th.FAILED_PRECONDITION;case Qr.ABORTED:return th.ABORTED;case Qr.OUT_OF_RANGE:return th.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return th.UNIMPLEMENTED;case Qr.DATA_LOSS:return th.DATA_LOSS;default:return Ur("Unknown status code: "+e)}}(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:n}}}return Ur("Unrecognized watch change: "+JSON.stringify(e))},nf.prototype.fromWatchChange=function(e){var t,n=this;if("targetChange"in e){Zh(e.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new Ch(r,i,o,s||null)}else if("documentChange"in e){Zh(e.documentChange,"documentChange");var u=e.documentChange;Zh(u.document,"documentChange.name"),Zh(u.document.name,"documentChange.document.name"),Zh(u.document.updateTime,"documentChange.document.updateTime");var c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=new qs(c,l,{},void 0,u.document,(function(e){return n.fromValue(e)})),f=u.targetIds||[],p=u.removedTargetIds||[];t=new Sh(f,p,h.key,h)}else if("documentDelete"in e){Zh(e.documentDelete,"documentDelete");var d=e.documentDelete;Zh(d.document,"documentDelete.document"),c=this.fromName(d.document),l=d.readTime?this.fromVersion(d.readTime):uo.forDeletedDoc(),h=new Us(c,l),p=d.removedTargetIds||[],t=new Sh([],p,h.key,h)}else if("documentRemove"in e){Zh(e.documentRemove,"documentRemove");var m=e.documentRemove;Zh(m.document,"documentRemove"),c=this.fromName(m.document),p=m.removedTargetIds||[],t=new Sh([],p,c,null)}else{if(!("filter"in e))return Ur("Unknown change type "+JSON.stringify(e));Zh(e.filter,"filter");var g=e.filter;Zh(g.targetId,"filter.targetId");var y=g.count||0,v=new Kh(y),b=g.targetId;t=new Ih(b,v)}return t},nf.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?Th.NoChange:"ADD"===e?Th.Added:"REMOVE"===e?Th.Removed:"CURRENT"===e?Th.Current:"RESET"===e?Th.Reset:Ur("Got unexpected TargetChange.state: "+e)},nf.prototype.versionFromListenResponse=function(e){if(!("targetChange"in e))return uo.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?uo.MIN:t.readTime?this.fromVersion(t.readTime):uo.MIN},nf.prototype.toMutation=function(e){var t,n=this;if(e instanceof Na)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof Fa)t={delete:this.toName(e.key)};else if(e instanceof xa)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else if(e instanceof Oa)t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map((function(e){return n.toFieldTransform(e)}))}};else{if(!(e instanceof Wa))return Ur("Unknown mutation type "+e.type);t={verify:this.toName(e.key)}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},nf.prototype.fromMutation=function(e){var t=this,n=e.currentDocument?this.fromPrecondition(e.currentDocument):Sa.NONE;if(e.update){Zh(e.update.name,"name");var r=this.fromName(e.update.name),i=this.fromFields(e.update.fields||{});if(e.updateMask){var o=this.fromDocumentMask(e.updateMask);return new xa(r,i,o,n)}return new Na(r,i,n)}if(e.delete)return r=this.fromName(e.delete),new Fa(r,n);if(e.transform){r=this.fromName(e.transform.document);var a=e.transform.fieldTransforms.map((function(e){return t.fromFieldTransform(e)}));return jr(!0===n.exists,'Transforms only support precondition "exists == true"'),new Oa(r,a)}return e.verify?(r=this.fromName(e.verify),new Wa(r,n)):Ur("unknown mutation proto: "+JSON.stringify(e))},nf.prototype.toPrecondition=function(e){return jr(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ur("Unknown precondition")},nf.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?Sa.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?Sa.exists(e.exists):Sa.NONE},nf.prototype.fromWriteResult=function(e,t){var n=this,r=e.updateTime?this.fromVersion(e.updateTime):this.fromVersion(t);r.isEqual(uo.MIN)&&(r=this.fromVersion(t));var i=null;return e.transformResults&&0<e.transformResults.length&&(i=e.transformResults.map((function(e){return n.fromValue(e)}))),new Ea(r,i)},nf.prototype.fromWriteResults=function(e,t){var n=this;return e&&0<e.length?(jr(void 0!==t,"Received a write result without a commit time"),e.map((function(e){return n.fromWriteResult(e,t)}))):[]},nf.prototype.toFieldTransform=function(e){var t=this,n=e.transform;if(n instanceof Fh)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof qh)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(e){return t.toValue(e)}))}};if(n instanceof $h)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(e){return t.toValue(e)}))}};if(n instanceof jh)return{fieldPath:e.field.canonicalString(),increment:this.toValue(n.operand)};throw Ur("Unknown transform: "+e.transform)},nf.prototype.fromFieldTransform=function(e){var t=this,n=null;if("setToServerValue"in e)jr("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),n=Fh.instance;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new qh(r.map((function(e){return t.fromValue(e)})))}else if("removeAllFromArray"in e)r=e.removeAllFromArray.values||[],n=new $h(r.map((function(e){return t.fromValue(e)})));else if("increment"in e){var i=this.fromValue(e.increment);jr(i instanceof rs,"NUMERIC_ADD transform requires a NumberValue"),n=new jh(i)}else Ur("Unknown transform proto: "+JSON.stringify(e));var o=zi.fromServerFormat(e.fieldPath);return new va(o,n)},nf.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},nf.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;jr(1===t,"DocumentsTarget contained other than 1 document: "+t);var n=e.documents[0];return qc.atPath(this.fromQueryPath(n)).toTarget()},nf.prototype.toQueryTarget=function(e){var t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(jr(n.length%2==0,"Collection Group queries should be within a document path or root."),t.parent=this.toQueryPath(n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(jr(n.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(e.filters);r&&(t.structuredQuery.where=r);var i=this.toOrder(e.orderBy);i&&(t.structuredQuery.orderBy=i);var o=this.toInt32Value(e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},nf.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){jr(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new qc(t,i,s,a,u,Pc.First,c,l).toTarget()},nf.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},nf.prototype.toLabel=function(e){switch(e){case Bu.Listen:return null;case Bu.ExistenceFilterMismatch:return"existence-filter-mismatch";case Bu.LimboResolution:return"limbo-document";default:return Ur("Unrecognized query purpose: "+e)}},nf.prototype.toTarget=function(e){var t,n=e.target;return(t=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=e.targetId,0<e.resumeToken.length&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},nf.prototype.toFilter=function(e){var t=this;if(0!==e.length){var n=e.map((function(e){return e instanceof Wc?t.toUnaryOrFieldFilter(e):Ur("Unrecognized filter: "+JSON.stringify(e))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},nf.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromFieldFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t.fromFilter(e)})).reduce((function(e,t){return e.concat(t)})):Ur("Unknown filter: "+JSON.stringify(e)):[]},nf.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map((function(e){return t.toPropertyOrder(e)}))},nf.prototype.fromOrder=function(e){var t=this;return e.map((function(e){return t.fromPropertyOrder(e)}))},nf.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map((function(e){return t.toValue(e)}))}},nf.prototype.fromCursor=function(e){var t=this,n=!!e.before,r=e.values.map((function(e){return t.fromValue(e)}));return new cl(r,n)},nf.prototype.toDirection=function(e){return Yh[e.name]},nf.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return sl.ASCENDING;case"DESCENDING":return sl.DESCENDING;default:return}},nf.prototype.toOperatorName=function(e){return Xh[e.name]},nf.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return $c.EQUAL;case"GREATER_THAN":return $c.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return $c.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return $c.LESS_THAN;case"LESS_THAN_OR_EQUAL":return $c.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return $c.ARRAY_CONTAINS;case"IN":return $c.IN;case"ARRAY_CONTAINS_ANY":return $c.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Ur("Unspecified operator");default:return Ur("Unknown operator")}},nf.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},nf.prototype.fromFieldPathReference=function(e){return zi.fromServerFormat(e.fieldPath)},nf.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},nf.prototype.fromPropertyOrder=function(e){return new hl(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},nf.prototype.fromFieldFilter=function(e){return Wc.create(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},nf.prototype.toUnaryOrFieldFilter=function(e){if(e.op===$c.EQUAL){if(e.value.isEqual(ls.NAN))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}};if(e.value.isEqual(Xa.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}},nf.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return Wc.create(t,$c.EQUAL,ls.NAN);case"IS_NULL":var n=this.fromFieldPathReference(e.unaryFilter.field);return Wc.create(n,$c.EQUAL,Xa.INSTANCE);case"OPERATOR_UNSPECIFIED":return Ur("Unspecified filter");default:return Ur("Unknown filter")}},nf.prototype.toDocumentMask=function(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}},nf.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map((function(e){return zi.fromServerFormat(e)}));return ga.fromArray(t)},nf);function nf(e,t){this.databaseId=e,this.options=t}var rf=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},of=(af.prototype.listen=function(e){var t=e.query,n=!1,r=this.queries.get(t);return r||(n=!0,r=new rf,this.queries.set(t,r)),r.listeners.push(e),jr(!e.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),!r.viewSnap||e.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent(),n?this.syncEngine.listen(t).then((function(e){return r.targetId=e})):Promise.resolve(r.targetId)},af.prototype.unlisten=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i;return s(this,(function(o){return t=e.query,n=!1,(r=this.queries.get(t))&&0<=(i=r.listeners.indexOf(e))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]}))}))},af.prototype.onWatchChange=function(e){for(var t=!1,n=0,r=e;n<r.length;n++){var i=r[n],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++)u[s].onViewSnapshot(i)&&(t=!0);a.viewSnap=i}}t&&this.raiseSnapshotsInSyncEvent()},af.prototype.onWatchError=function(e,t){var n=this.queries.get(e);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(t);this.queries.delete(e)},af.prototype.onOnlineStateChange=function(e){this.onlineState=e;var t=!1;this.queries.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].applyOnlineStateChange(e)&&(t=!0)})),t&&this.raiseSnapshotsInSyncEvent()},af.prototype.addSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.add(e),e.next()},af.prototype.removeSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.delete(e)},af.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(e){e.next()}))},af);function af(e){this.syncEngine=e,this.queries=new Gs((function(e){return e.canonicalId()})),this.onlineState=Hl.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}var sf=(uf.prototype.onViewSnapshot=function(e){if(jr(0<e.docChanges.length||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];i.type!==sh.Metadata&&t.push(i)}e=new mh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),o=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),o=!0),this.snap=e,o},uf.prototype.onError=function(e){this.queryObserver.error(e)},uf.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},uf.prototype.shouldRaiseInitialEvent=function(e,t){if(jr(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache)return!0;var n=t!==Hl.Offline;return this.options.waitForSyncWhenOnline&&n?(jr(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===Hl.Offline},uf.prototype.shouldRaiseEvent=function(e){if(0<e.docChanges.length)return!0;var t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},uf.prototype.raiseInitialEvent=function(e){jr(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=mh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},uf);function uf(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=Hl.Unknown,this.options=n||{}}var cf=(lf.fromSnapshot=function(e,t){for(var n=xo(),r=xo(),i=0,o=t.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case sh.Added:n=n.add(a.doc.key);break;case sh.Removed:r=r.add(a.doc.key)}}return new lf(e,t.fromCache,n,r)},lf);function lf(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}var hf=function(e){this.key=e},ff=function(e){this.key=e},pf=(Object.defineProperty(df.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),df.prototype.computeDocChanges=function(e,t){var n=this,r=t?t.changeSet:new ph,i=t?t.documentSet:this.documentSet,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=t instanceof qs?t:null;h&&(jr(e.isEqual(h.key),"Mismatching keys found in document changes: "+e+" != "+h.key),h=n.query.matches(h)?h:null);var f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data().isEqual(h.data())?f!==p&&(r.track({type:sh.Metadata,doc:h}),d=!0):n.shouldWaitForSyncedDocument(l,h)||(r.track({type:sh.Modified,doc:h}),d=!0,(u&&0<n.query.docComparator(h,u)||c&&n.query.docComparator(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:sh.Added,doc:h}),d=!0):l&&!h&&(r.track({type:sh.Removed,doc:l}),d=!0,(u||c)&&(s=!0)),d&&(o=h?(a=a.add(h),p?o.add(e):o.delete(e)):(a=a.delete(e),o.delete(e)))})),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var l=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:sh.Removed,doc:l})}return jr(!s||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},df.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},df.prototype.applyChanges=function(e,t,n){var r=this;jr(!e.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var o=e.changeSet.getChanges();o.sort((function(e,t){return function(e,t){function n(e){switch(e){case sh.Added:return 1;case sh.Modified:case sh.Metadata:return 2;case sh.Removed:return 0;default:return Ur("Unknown ChangeType: "+e)}}return n(e)-n(t)}(e.type,t.type)||r.query.docComparator(e.doc,t.doc)})),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?ch.Synced:ch.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new mh(this.query,e.documentSet,i,o,e.mutatedKeys,s===ch.Local,u,!1),limboChanges:a}:{limboChanges:a}},df.prototype.applyOnlineStateChange=function(e){return this.current&&e===Hl.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new ph,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},df.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},df.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t._syncedDocuments=t._syncedDocuments.add(e)})),e.modifiedDocuments.forEach((function(e){return jr(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")})),e.removedDocuments.forEach((function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)})),this.current=e.current)},df.prototype.updateLimboDocuments=function(){var e=this;if(!this.current)return[];var t=this.limboDocuments;this.limboDocuments=xo(),this.documentSet.forEach((function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))}));var n=[];return t.forEach((function(t){e.limboDocuments.has(t)||n.push(new ff(t))})),this.limboDocuments.forEach((function(e){t.has(e)||n.push(new hf(e))})),n},df.prototype.synchronizeWithPersistedState=function(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=xo();var t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)},df.prototype.computeInitialSnapshot=function(){return mh.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===ch.Local)},df);function df(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=xo(),this.mutatedKeys=xo(),this.documentSet=new hh(e.docComparator.bind(e))}var mf=(gf.prototype.run=function(){this.runWithBackOff()},gf.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun((function(){return a(e,void 0,void 0,(function(){var e,t,n=this;return s(this,(function(r){return e=this.remoteStore.createTransaction(),(t=this.tryRunUpdateFunction(e))&&t.then((function(t){n.asyncQueue.enqueueAndForget((function(){return e.commit().then((function(){n.deferred.resolve(t)})).catch((function(e){n.handleTransactionError(e)}))}))})).catch((function(e){n.handleTransactionError(e)})),[2]}))}))}))},gf.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!Mc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},gf.prototype.handleTransactionError=function(e){var t=this;0<this.retries&&this.isRetryableTransactionError(e)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return t.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(e)},gf.prototype.isRetryableTransactionError=function(e){if("FirebaseError"!==e.name)return!1;var t=e.code;return"aborted"===t||"failed-precondition"===t||!oh(t)},gf);function gf(e,t,n,r){this.asyncQueue=e,this.remoteStore=t,this.updateFunction=n,this.deferred=r,this.retries=5,this.backoff=new Ol(this.asyncQueue,Hi.RetryTransaction)}var yf="SyncEngine",vf=function(e,t,n){this.query=e,this.targetId=t,this.view=n},bf=function(e){this.key=e,this.receivedDocument=!1},wf=(Object.defineProperty(Tf.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Tf.prototype.subscribe=function(e){jr(null!==e,"SyncEngine listener cannot be null"),jr(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=e},Tf.prototype.listen=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o;return s(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(e))?(t=r.targetId,this.sharedClientState.addLocalQueryTarget(t),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(e.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),t=i.targetId,[4,this.initializeViewAndComputeSnapshot(e,t,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,t]}}))}))},Tf.prototype.initializeViewAndComputeSnapshot=function(e,t,n){return a(this,void 0,void 0,(function(){var r,i,o,a,u,c;return s(this,(function(s){switch(s.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return r=s.sent(),i=new pf(e,r.remoteKeys),o=i.computeDocChanges(r.documents),a=bh.createSynthesizedTargetChangeForCurrentChange(t,n&&this.onlineState!==Hl.Offline),jr(0===(u=i.applyChanges(o,!0===this.isPrimary,a)).limboChanges.length,"View returned limbo docs before target ack from the server."),jr(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new vf(e,t,i),this.queryViewsByQuery.set(e,c),this.queriesByTarget[t]||(this.queriesByTarget[t]=[]),this.queriesByTarget[t].push(e),[2,u.snapshot]}}))}))},Tf.prototype.synchronizeViewAndComputeSnapshot=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(e.query,!0)];case 1:return t=r.sent(),n=e.view.synchronizeWithPersistedState(t),this.isPrimary&&this.updateTrackedLimbos(e.targetId,n.limboChanges),[2,n]}}))}))},Tf.prototype.unlisten=function(e){return a(this,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),jr(!!(t=this.queryViewsByQuery.get(e)),"Trying to unlisten on query not found:"+e),1<(n=this.queriesByTarget[t.targetId]).length?(this.queriesByTarget[t.targetId]=n.filter((function(t){return!t.isEqual(e)})),this.queryViewsByQuery.delete(e),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.sharedClientState.isActiveQueryTarget(t.targetId)?[3,2]:[4,this.localStore.releaseTarget(t.targetId,!1).then((function(){r.sharedClientState.clearQueryState(t.targetId),r.remoteStore.unlisten(t.targetId),r.removeAndCleanupTarget(t.targetId)})).catch(ac)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(t.targetId),[4,this.localStore.releaseTarget(t.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},Tf.prototype.write=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(e)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,t),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},Tf.prototype.runTransaction=function(e,t,n){new mf(e,this.remoteStore,t,n).run()},Tf.prototype.applyRemoteEvent=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return s(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(e)];case 2:return t=r.sent(),ti(e.targetChanges,(function(e,t){var r=n.limboResolutionsByTarget[Number(e)];r&&(jr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),0<t.addedDocuments.size?r.receivedDocument=!0:0<t.modifiedDocuments.size?jr(r.receivedDocument,"Received change for limbo target document without add."):0<t.removedDocuments.size&&(jr(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(t,e)];case 3:return r.sent(),[3,6];case 4:return[4,ac(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Tf.prototype.applyOnlineStateChange=function(e,t){if(this.isPrimary&&t===Xl.RemoteStore||!this.isPrimary&&t===Xl.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(t,r){var i=r.view.applyOnlineStateChange(e);jr(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.syncEngineListener.onOnlineStateChange(e),this.syncEngineListener.onWatchChange(n),this.onlineState=e,this.isPrimary&&this.sharedClientState.setOnlineState(e)}},Tf.prototype.rejectListen=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u=this;return s(this,(function(s){switch(s.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(e,"rejected",t),n=this.limboResolutionsByTarget[e],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[e],i=(i=new lo(Gi.comparator)).insert(r,new Us(r,uo.forDeletedDoc())),o=xo().add(r),a=new yh(uo.MIN,{},new bo(Si),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return[4,this.localStore.releaseTarget(e,!1).then((function(){return u.removeAndCleanupTarget(e,t)})).catch(ac)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))},Tf.prototype.applyBatchState=function(e,t,n){return a(this,void 0,void 0,(function(){var r;return s(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(e)];case 1:return null===(r=i.sent())?(qr(yf,"Cannot apply mutation batch with id: "+e),[2]):"pending"!==t?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===t||"rejected"===t?(this.processUserCallback(e,n||null),this.localStore.removeCachedMutationBatchMetadata(e)):Ur("Unknown batchState: "+t),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}}))}))},Tf.prototype.applySuccessfulWrite=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),t=e.batch.batchId,this.processUserCallback(t,null),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,ac(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Tf.prototype.rejectFailedWrite=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"rejected",t),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,ac(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Tf.prototype.registerPendingWritesCallback=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||qr(yf,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(t=r.sent())?e.resolve():((n=this.pendingWritesCallbacks.get(t)||[]).push(e),this.pendingWritesCallbacks.set(t,n)),[2]}}))}))},Tf.prototype.triggerPendingWritesCallbacks=function(e){(this.pendingWritesCallbacks.get(e)||[]).forEach((function(e){e.resolve()})),this.pendingWritesCallbacks.delete(e)},Tf.prototype.rejectOutstandingPendingWritesCallbacks=function(e){this.pendingWritesCallbacks.forEach((function(t){t.forEach((function(t){t.reject(new Hr(Qr.CANCELLED,e))}))})),this.pendingWritesCallbacks.clear()},Tf.prototype.addMutationCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n=(n=n||new lo(Si)).insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=n},Tf.prototype.processUserCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(e);r&&(jr(e===n.minKey(),"Mutation callbacks processed out-of-order?"),t?r.reject(t):r.resolve(),n=n.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},Tf.prototype.removeAndCleanupTarget=function(e,t){var n=this;void 0===t&&(t=null),this.sharedClientState.removeLocalQueryTarget(e),jr(this.queriesByTarget[e]&&0!==this.queriesByTarget[e].length,"There are no queries mapped to target id "+e);for(var r=0,i=this.queriesByTarget[e];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),t&&this.syncEngineListener.onWatchError(o,t)}if(delete this.queriesByTarget[e],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(e);this.limboDocumentRefs.removeReferencesForId(e),a.forEach((function(e){n.limboDocumentRefs.containsKey(e)||n.removeLimboTarget(e)}))}},Tf.prototype.removeLimboTarget=function(e){var t=this.limboTargetsByKey.get(e);null!==t&&(this.remoteStore.unlisten(t),this.limboTargetsByKey=this.limboTargetsByKey.remove(e),delete this.limboResolutionsByTarget[t])},Tf.prototype.updateTrackedLimbos=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];i instanceof hf?(this.limboDocumentRefs.addReference(i.key,e),this.trackLimboChange(i)):i instanceof ff?(qr(yf,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,e),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):Ur("Unknown limbo change: "+JSON.stringify(i))}},Tf.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){qr(yf,"New document in limbo: "+t);var n=this.limboTargetIdGenerator.next(),r=qc.atPath(t.path);this.limboResolutionsByTarget[n]=new bf(t),this.remoteStore.listen(new Wu(r.toTarget(),n,Bu.LimboResolution,Pi.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,n)}},Tf.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},Tf.prototype.emitNewSnapsAndNotifyLocalStore=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,o=this;return s(this,(function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach((function(a,s){i.push(Promise.resolve().then((function(){var t=s.view.computeDocChanges(e);return t.needsRefill?o.localStore.executeQuery(s.query,!1).then((function(e){var n=e.documents;return s.view.computeDocChanges(n,t)})):t})).then((function(e){var i=t&&t.targetChanges[s.targetId],a=s.view.applyChanges(e,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=cf.fromSnapshot(s.targetId,a.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}}))}))},Tf.prototype.assertSubscribed=function(e){jr(null!==this.syncEngineListener,"Trying to call "+e+" before calling subscribe().")},Tf.prototype.handleCredentialChange=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=!this.currentUser.isEqual(e),this.currentUser=e,t?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(e)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},Tf.prototype.applyPrimaryState=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,a,u,c=this;return s(this,(function(s){switch(s.label){case 0:return!0!==e||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return s.sent(),t=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t.toArray())];case 2:for(n=s.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==e||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],u=Promise.resolve(),ei(this.queriesByTarget,(function(e,t){c.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then((function(){return c.removeAndCleanupTarget(e),c.localStore.releaseTarget(e,!0)})),c.remoteStore.unlisten(e)})),[4,u]);case 4:return s.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return s.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:s.sent(),s.label=7;case 7:return[2]}}))}))},Tf.prototype.resetLimboDocuments=function(){var e=this;ei(this.limboResolutionsByTarget,(function(t){e.remoteStore.unlisten(t)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new lo(Gi.comparator)},Tf.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,a,u,c,l,h,f,p,d;return s(this,(function(s){switch(s.label){case 0:t=[],n=[],r=0,i=e,s.label=1;case 1:return r<i.length?(o=i[r],a=void 0,(u=this.queriesByTarget[o])&&0!==u.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return s.sent(),[4,this.localStore.allocateTarget(u[0].toTarget())];case 3:a=s.sent(),c=0,l=u,s.label=4;case 4:return c<l.length?(h=l[c],jr(!!(f=this.queryViewsByQuery.get(h)),"No query view found for "+h),[4,this.synchronizeViewAndComputeSnapshot(f)]):[3,7];case 5:(p=s.sent()).snapshot&&n.push(p.snapshot),s.label=6;case 6:return c++,[3,4];case 7:return[3,12];case 8:return jr(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return jr(!!(d=s.sent()),"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(d)];case 10:return a=s.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(d),o,!1)];case 11:s.sent(),s.label=12;case 12:t.push(a),s.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,t]}}))}))},Tf.prototype.synthesizeTargetToQuery=function(e){return new qc(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,Pc.First,e.startAt,e.endAt)},Tf.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},Tf.prototype.applyTargetState=function(e,t,n){return a(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return qr(yf,"Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[e])return[3,7];switch(t){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=yh.createSynthesizedRemoteEventForCurrentChange(e,"current"===t),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(e,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(e,n),[3,7];case 6:Ur("Unexpected target state: "+t),o.label=7;case 7:return[2]}}))}))},Tf.prototype.applyActiveTargetsChange=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u,c,l,h,f=this;return s(this,(function(p){switch(p.label){case 0:if(!this.isPrimary)return[2];n=0,r=e,p.label=1;case 1:return n<r.length?(h=r[n],jr(!this.queriesByTarget[h],"Trying to add an already active target"),[4,this.localStore.getTarget(h)]):[3,6];case 2:return jr(!!(i=p.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=p.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:p.sent(),this.remoteStore.listen(o),p.label=5;case 5:return n++,[3,1];case 6:a=function(e){return s(this,(function(t){switch(t.label){case 0:return u.queriesByTarget[e]?[4,u.localStore.releaseTarget(e,!1).then((function(){f.remoteStore.unlisten(e),f.removeAndCleanupTarget(e)})).catch(ac)]:[2,"continue"];case 1:return t.sent(),[2]}}))},u=this,c=0,l=t,p.label=7;case 7:return c<l.length?(h=l[c],[5,a(h)]):[3,10];case 8:p.sent(),p.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},Tf.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},Tf.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},Tf.prototype.getRemoteKeysForTarget=function(e){var t=this.limboResolutionsByTarget[e];if(t&&t.receivedDocument)return xo().add(t.key);var n=xo(),r=this.queriesByTarget[e];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);jr(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},Tf);function Tf(e,t,n,r){this.localStore=e,this.remoteStore=t,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Gs((function(e){return e.canonicalId()})),this.queriesByTarget={},this.limboTargetsByKey=new lo(Gi.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Zu,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=ua.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Hl.Unknown}var Ef=(Sf.prototype.isAuthenticated=function(){return null!=this.uid},Sf.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Sf.prototype.isEqual=function(e){return e.uid===this.uid},Sf.UNAUTHENTICATED=new Sf(null),Sf.GOOGLE_CREDENTIALS=new Sf("google-credentials-uid"),Sf.FIRST_PARTY=new Sf("first-party-uid"),Sf);function Sf(e){this.uid=e}var If="firestore_clients";function Cf(e,t){return jr(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),If+"_"+e+"_"+t}var Af="firestore_mutations";function Df(e,t,n){var r=Af+"_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}var Nf="firestore_targets";function kf(e,t){return Nf+"_"+e+"_"+t}var _f="SharedClientState",xf=(Rf.fromWebStorageEntry=function(e,t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Hr(r.error.code,r.error.message)),i?new Rf(e,t,r.state,o):(Vr(_f,"Failed to parse mutation state for ID '"+t+"': "+n),null)},Rf.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},Rf);function Rf(e,t,n,r){this.user=e,this.batchId=t,this.state=n,jr(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}var Mf=(Of.fromWebStorageEntry=function(e,t){var n=JSON.parse(t),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Hr(n.error.code,n.error.message)),r?new Of(e,n.state,i):(Vr(_f,"Failed to parse target state for ID '"+e+"': "+t),null)},Of.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},Of);function Of(e,t,n){this.targetId=e,this.state=t,jr(void 0!==(this.error=n)==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}var Pf=(Lf.fromWebStorageEntry=function(e,t){for(var n=JSON.parse(t),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Mo(),o=0;r&&o<n.activeTargetIds.length;++o)r=Oc(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Lf(e,i):(Vr(_f,"Failed to parse client data for instance '"+e+"': "+t),null)},Lf);function Lf(e,t){this.clientId=e,this.activeTargetIds=t}var Ff=(Bf.fromWebStorageEntry=function(e){var t=JSON.parse(e);return"object"==typeof t&&t.onlineState in Hl&&"string"==typeof t.clientId?new Bf(t.clientId,Hl[t.onlineState]):(Vr(_f,"Failed to parse online state: "+e),null)},Bf);function Bf(e,t){this.clientId=e,this.onlineState=t}var qf=(Vf.prototype.addQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},Vf.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},Vf.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},Vf);function Vf(){this.activeTargetIds=Mo()}var $f=(Uf.isAvailable=function(e){return!(!e.window||null==e.window.localStorage)},Uf.prototype.start=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,u,c,l,h,f=this;return s(this,(function(s){switch(s.label){case 0:return jr(!this.started,"WebStorageSharedClientState already started"),jr(null!==this.syncEngine,"syncEngine property must be set before calling start()"),jr(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(e=s.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.localClientId&&(i=this.getItem(Cf(this.persistenceKey,r)))&&(o=Pf.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(u),c=0,l=this.earlyEvents;c<l.length;c++)h=l[c],this.handleWebStorageEvent(h);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},Uf.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},Uf.prototype.getAllActiveQueryTargets=function(){var e=Mo();return ti(this.activeClients,(function(t,n){e=e.unionWith(n.activeTargetIds)})),e},Uf.prototype.isActiveQueryTarget=function(e){for(var t in this.activeClients)if(this.activeClients.hasOwnProperty(t)&&this.activeClients[t].activeTargetIds.has(e))return!0;return!1},Uf.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},Uf.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},Uf.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(kf(this.persistenceKey,e));if(n){var r=Mf.fromWebStorageEntry(e,n);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t},Uf.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},Uf.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},Uf.prototype.clearQueryState=function(e){this.removeItem(kf(this.persistenceKey,e))},Uf.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},Uf.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach((function(e){r.removeMutationState(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))},Uf.prototype.setOnlineState=function(e){this.persistOnlineState(e)},Uf.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},Uf.prototype.getItem=function(e){var t=this.storage.getItem(e);return qr(_f,"READ",e,t),t},Uf.prototype.setItem=function(e,t){qr(_f,"SET",e,t),this.storage.setItem(e,t)},Uf.prototype.removeItem=function(e){qr(_f,"REMOVE",e),this.storage.removeItem(e)},Uf.prototype.handleWebStorageEvent=function(e){var t=this;if(e.storageArea===this.storage){if(qr(_f,"EVENT",e.key,e.newValue),e.key===this.localClientStorageKey)return void Vr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return a(t,void 0,void 0,(function(){var t,n,r,i,o,a;return s(this,(function(s){if(!this.started)return this.earlyEvents.push(e),[2];if(null===e.key)return[2];if(this.clientStateKeyRe.test(e.key)){if(null==e.newValue)return n=this.fromWebStorageClientStateKey(e.key),[2,this.handleClientStateEvent(n,null)];if(t=this.fromWebStorageClientState(e.key,e.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(e.key)){if(null!==e.newValue&&(r=this.fromWebStorageMutationMetadata(e.key,e.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(e.key)){if(null!==e.newValue&&(i=this.fromWebStorageQueryTargetMetadata(e.key,e.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(e.key===this.onlineStateKey){if(null!==e.newValue&&(o=this.fromWebStorageOnlineState(e.newValue)))return[2,this.handleOnlineStateEvent(o)]}else e.key===this.sequenceNumberKey&&(jr(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(e){var t=Pi.INVALID;if(null!=e)try{var n=JSON.parse(e);jr("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(e){Vr(_f,"Failed to read sequence number from WebStorage",e)}return t}(e.newValue))!==Pi.INVALID&&this.sequenceNumberHandler(a));return[2]}))}))}))}},Object.defineProperty(Uf.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),Uf.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},Uf.prototype.persistMutationState=function(e,t,n){var r=new xf(this.currentUser,e,t,n),i=Df(this.persistenceKey,this.currentUser,e);this.setItem(i,r.toWebStorageJSON())},Uf.prototype.removeMutationState=function(e){var t=Df(this.persistenceKey,this.currentUser,e);this.removeItem(t)},Uf.prototype.persistOnlineState=function(e){var t={clientId:this.localClientId,onlineState:Hl[e]};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))},Uf.prototype.persistQueryTargetState=function(e,t,n){var r=kf(this.persistenceKey,e),i=new Mf(e,t,n);this.setItem(r,i.toWebStorageJSON())},Uf.prototype.fromWebStorageClientStateKey=function(e){var t=this.clientStateKeyRe.exec(e);return t?t[1]:null},Uf.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return jr(null!==n,"Cannot parse client state key '"+e+"'"),Pf.fromWebStorageEntry(n,t)},Uf.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);jr(null!==n,"Cannot parse mutation batch key '"+e+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return xf.fromWebStorageEntry(new Ef(i),r,t)},Uf.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);jr(null!==n,"Cannot parse query target key '"+e+"'");var r=Number(n[1]);return Mf.fromWebStorageEntry(r,t)},Uf.prototype.fromWebStorageOnlineState=function(e){return Ff.fromWebStorageEntry(e)},Uf.prototype.handleMutationBatchEvent=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return e.user.uid!==this.currentUser.uid?(qr(_f,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.syncEngine.applyBatchState(e.batchId,e.state,e.error)]}))}))},Uf.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},Uf.prototype.handleClientStateEvent=function(e,t){var n=this,r=this.getAllActiveQueryTargets();t?this.activeClients[e]=t:delete this.activeClients[e];var i=this.getAllActiveQueryTargets(),o=[],u=[];return i.forEach((function(e){return a(n,void 0,void 0,(function(){return s(this,(function(t){return r.has(e)||o.push(e),[2]}))}))})),r.forEach((function(e){return a(n,void 0,void 0,(function(){return s(this,(function(t){return i.has(e)||u.push(e),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(o,u)},Uf.prototype.handleOnlineStateEvent=function(e){this.activeClients[e.clientId]&&this.onlineStateHandler(e.onlineState)},Uf);function Uf(e,t,n,r,i){if(this.queue=e,this.platform=t,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!Uf.isAvailable(this.platform))throw new Hr(Qr.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.localClientStorageKey=Cf(this.persistenceKey,this.localClientId),this.sequenceNumberKey=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.activeClients[this.localClientId]=new qf,this.clientStateKeyRe=new RegExp("^"+If+"_"+o+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Af+"_"+o+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Nf+"_"+o+"_(\\d+)$"),this.onlineStateKey=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.platform.window.addEventListener("storage",this.storageListener)}var jf=(Wf.prototype.addPendingMutation=function(e){},Wf.prototype.updateMutationState=function(e,t,n){},Wf.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},Wf.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},Wf.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},Wf.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},Wf.prototype.clearQueryState=function(e){delete this.queryState[e]},Wf.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},Wf.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},Wf.prototype.start=function(){return this.localState=new qf,Promise.resolve()},Wf.prototype.handleUserChange=function(e,t,n){},Wf.prototype.setOnlineState=function(e){},Wf.prototype.shutdown=function(){},Wf.prototype.writeSequenceNumber=function(e){},Wf);function Wf(){this.localState=new qf,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}var zf="FirestoreClient",Kf=(Gf.prototype.lruParams=function(){return hc.withCacheSize(this.cacheSizeBytes)},Gf);function Gf(e,t){this.cacheSizeBytes=e,this.synchronizeTabs=t}var Qf=function(){},Hf=(Yf.prototype.start=function(e){var t=this;this.verifyNotTerminated();var n=new Xi,r=new Xi,i=!1;return this.credentials.setChangeListener((function(o){i?t.asyncQueue.enqueueAndForget((function(){return t.handleCredentialChange(o)})):(i=!0,t.initializePersistence(e,r,o).then((function(e){return t.initializeRest(o,e)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},Yf.prototype.enableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.syncEngine.enableNetwork()}))},Yf.prototype.initializePersistence=function(e,t,n){var r=this;return e instanceof Kf?this.startIndexedDbPersistence(n,e).then((function(e){return t.resolve(),e})).catch((function(e){if(t.reject(e),!r.canFallback(e))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.startMemoryPersistence()})):(t.resolve(),this.startMemoryPersistence())},Yf.prototype.canFallback=function(e){return e instanceof Hr?e.code===Qr.FAILED_PRECONDITION||e.code===Qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code},Yf.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Hr(Qr.FAILED_PRECONDITION,"The client has already been terminated.")},Yf.prototype.startIndexedDbPersistence=function(e,t){var n=this,r=Ec.buildStoragePrefix(this.databaseInfo),i=new tf(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return a(n,void 0,void 0,(function(){var n,o;return s(this,(function(a){switch(a.label){case 0:if(t.synchronizeTabs&&!$f.isAvailable(this.platform))throw new Hr(Qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=t.lruParams(),this.sharedClientState=t.synchronizeTabs?new $f(this.asyncQueue,this.platform,r,this.clientId,e):new jf,[4,Ec.createIndexedDbPersistence({allowTabSynchronization:t.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),[2,(this.persistence=o).referenceDelegate.garbageCollector]}}))}))}))},Yf.prototype.startMemoryPersistence=function(){return this.persistence=Cl.createEagerPersistence(this.clientId),this.sharedClientState=new jf,Promise.resolve(null)},Yf.prototype.initializeRest=function(e,t){var n=this;return qr(zf,"Initializing. user=",e.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return a(n,void 0,void 0,(function(){var n,i,o,u,c,l,h=this;return s(this,(function(f){switch(f.label){case 0:return n=new ml,this.localStore=new ic(this.persistence,n,e),[4,this.localStore.start()];case 1:return f.sent(),t&&(this.lruScheduler=new pc(t,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),u=new Gl(this.asyncQueue,r,this.credentials,o),c=function(e){return h.syncEngine.applyOnlineStateChange(e,Xl.RemoteStore)},l=function(e){return h.syncEngine.applyOnlineStateChange(e,Xl.SharedClientState)},this.remoteStore=new Mh(this.localStore,u,this.asyncQueue,c,i),this.syncEngine=new wf(this.localStore,this.remoteStore,this.sharedClientState,e),this.sharedClientState.onlineStateHandler=l,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new of(this.syncEngine),[4,this.sharedClientState.start()];case 2:return f.sent(),[4,this.remoteStore.start()];case 3:return f.sent(),[4,this.persistence.setPrimaryStateListener((function(e){return a(h,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.syncEngine.applyPrimaryState(e)];case 1:return t.sent(),this.lruScheduler&&(e&&!this.lruScheduler.started?this.lruScheduler.start():e||this.lruScheduler.stop()),[2]}}))}))}))];case 4:return f.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return a(h,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.terminate()];case 1:return e.sent(),[2]}}))}))}))];case 5:return f.sent(),[2]}}))}))}))},Yf.prototype.handleCredentialChange=function(e){return this.asyncQueue.verifyOperationInProgress(),qr(zf,"Credential Changed. Current user: "+e.uid),this.syncEngine.handleCredentialChange(e)},Yf.prototype.disableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.syncEngine.disableNetwork()}))},Yf.prototype.terminate=function(){var e=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return a(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown()];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},Yf.prototype.waitForPendingWrites=function(){var e=this;this.verifyNotTerminated();var t=new Xi;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.registerPendingWritesCallback(t)})),t.promise},Yf.prototype.listen=function(e,t,n){var r=this;this.verifyNotTerminated();var i=new sf(e,t,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(i)})),i},Yf.prototype.unlisten=function(e){var t=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return t.eventMgr.unlisten(e)}))},Yf.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.localStore.readDocument(e)})).then((function(e){if(e instanceof qs)return e;if(e instanceof Us)return null;throw new Hr(Qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},Yf.prototype.getDocumentsFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return a(t,void 0,void 0,(function(){var t,n,r;return s(this,(function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return t=i.sent(),n=new pf(e,t.remoteKeys),r=n.computeDocChanges(t.documents),[2,n.applyChanges(r,!1).snapshot]}}))}))}))},Yf.prototype.write=function(e){var t=this;this.verifyNotTerminated();var n=new Xi;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.write(e,n)})),n.promise},Yf.prototype.databaseId=function(){return this.databaseInfo.databaseId},Yf.prototype.addSnapshotsInSyncListener=function(e){var t=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return t.eventMgr.addSnapshotsInSyncListener(e),Promise.resolve()}))},Yf.prototype.removeSnapshotsInSyncListener=function(e){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(e)},Object.defineProperty(Yf.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),Yf.prototype.transaction=function(e){var t=this;this.verifyNotTerminated();var n=new Xi;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.runTransaction(t.asyncQueue,e,n),Promise.resolve()})),n.promise},Yf);function Yf(e,t,n,r){this.platform=e,this.databaseInfo=t,this.credentials=n,this.asyncQueue=r,this.clientId=Ti.newId()}var Xf=(Jf.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},Jf.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},Jf.prototype.mute=function(){this.muted=!0},Jf.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)},Jf);function Jf(e){this.observer=e,this.muted=!1}var Zf=(ep.documentId=function(){return ep._DOCUMENT_ID},ep.prototype.isEqual=function(e){if(!(e instanceof ep))throw yi("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},ep._DOCUMENT_ID=new ep(zi.keyField().canonicalString()),ep);function ep(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!function(e,t,n,r){if(!(t instanceof Array)||t.length<1)throw new Hr(Qr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+wi(1,"element")+".")}(0,e);for(var n=0;n<e.length;++n)if(si("FieldPath","string",n,e[n]),0===e[n].length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zi(e)}var tp=new RegExp("[~\\*/\\[\\]]"),np=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},rp=(ip.prototype.getToken=function(){return Promise.resolve(null)},ip.prototype.invalidateToken=function(){},ip.prototype.setChangeListener=function(e){jr(!this.changeListener,"Can only call setChangeListener() once."),(this.changeListener=e)(Ef.UNAUTHENTICATED)},ip.prototype.removeChangeListener=function(){jr(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},ip);function ip(){this.changeListener=null}var op=(ap.prototype.getToken=function(){var e=this;jr(null!=this.tokenListener,"getToken cannot be called after listener removed.");var t=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(e.tokenCounter!==t)throw new Hr(Qr.ABORTED,"getToken aborted due to token change.");return n?(jr("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new np(n.accessToken,e.currentUser)):null})):Promise.resolve(null)},ap.prototype.invalidateToken=function(){this.forceRefresh=!0},ap.prototype.setChangeListener=function(e){jr(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,this.receivedInitialUser&&e(this.currentUser)},ap.prototype.removeChangeListener=function(){jr(null!=this.tokenListener,"removeChangeListener() called twice"),jr(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},ap.prototype.getUser=function(){var e=this.auth&&this.auth.getUid();return jr(null===e||"string"==typeof e,"Received invalid UID: "+e),new Ef(e)},ap);function ap(e){var t=this;this.tokenListener=null,this.currentUser=Ef.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.receivedInitialUser=!0,t.changeListener&&t.changeListener(t.currentUser)},this.tokenCounter=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),e.get().then((function(e){t.auth=e,t.tokenListener&&t.auth.addAuthTokenListener(t.tokenListener)}),(function(){})))}var sp=(Object.defineProperty(up.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!0,configurable:!0}),up);function up(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=Ef.FIRST_PARTY}var cp=(lp.prototype.getToken=function(){return Promise.resolve(new sp(this.gapi,this.sessionIndex))},lp.prototype.setChangeListener=function(e){e(Ef.FIRST_PARTY)},lp.prototype.removeChangeListener=function(){},lp.prototype.invalidateToken=function(){},lp);function lp(e,t){this.gapi=e,this.sessionIndex=t}function hp(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}var fp=(pp.delete=function(){return ri("FieldValue.delete",arguments),mp.instance},pp.serverTimestamp=function(){return ri("FieldValue.serverTimestamp",arguments),vp.instance},pp.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return oi("FieldValue.arrayUnion",arguments,1),new Tp(e)},pp.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return oi("FieldValue.arrayRemove",arguments,1),new Ip(e)},pp.increment=function(e){return si("FieldValue.increment","number",1,e),ii("FieldValue.increment",arguments,1),new Dp(e)},pp.prototype.isEqual=function(e){return this===e},pp);function pp(e){this._methodName=e}var dp,mp=(n(gp,dp=fp),gp.instance=new gp,gp);function gp(){return dp.call(this,"FieldValue.delete")||this}var yp,vp=(n(bp,yp=fp),bp.instance=new bp,bp);function bp(){return yp.call(this,"FieldValue.serverTimestamp")||this}var wp,Tp=(n(Ep,wp=fp),Ep);function Ep(e){var t=wp.call(this,"FieldValue.arrayUnion")||this;return t._elements=e,t}var Sp,Ip=(n(Cp,Sp=fp),Cp);function Cp(e){var t=Sp.call(this,"FieldValue.arrayRemove")||this;return t._elements=e,t}var Ap,Dp=(n(Np,Ap=fp),Np);function Np(e){var t=Ap.call(this,"FieldValue.increment")||this;return t._operand=e,t}var kp=Xr(fp,"Use FieldValue.<field>() instead."),_p=/^__.*__$/,xp=(Rp.prototype.toMutations=function(e,t){var n=[];return null!==this.fieldMask?n.push(new xa(e,this.data,this.fieldMask,t)):n.push(new Na(e,this.data,t)),0<this.fieldTransforms.length&&n.push(new Oa(e,this.fieldTransforms)),n},Rp);function Rp(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}var Mp,Op,Pp=(Lp.prototype.toMutations=function(e,t){var n=[new xa(e,this.data,this.fieldMask,t)];return 0<this.fieldTransforms.length&&n.push(new Oa(e,this.fieldTransforms)),n},Lp);function Lp(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}function Fp(e){switch(e){case Mp.Set:case Mp.MergeSet:case Mp.Update:return!0;case Mp.Argument:case Mp.ArrayArgument:return!1;default:throw Ur("Unexpected case for UserDataSource: "+e)}}(Op=Mp=Mp||{})[Op.Set=0]="Set",Op[Op.Update=1]="Update",Op[Op.MergeSet=2]="MergeSet",Op[Op.Argument=3]="Argument",Op[Op.ArrayArgument=4]="ArrayArgument";var Bp=(qp.prototype.childContextForField=function(e){var t=null==this.path?null:this.path.child(e),n=new qp(this.dataSource,this.methodName,t,!1,this.fieldTransforms,this.fieldMask);return n.validatePathSegment(e),n},qp.prototype.childContextForFieldPath=function(e){var t=null==this.path?null:this.path.child(e),n=new qp(this.dataSource,this.methodName,t,!1,this.fieldTransforms,this.fieldMask);return n.validatePath(),n},qp.prototype.childContextForArray=function(e){return new qp(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},qp.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new Hr(Qr.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},qp.prototype.contains=function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))},qp.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},qp.prototype.validatePathSegment=function(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(Fp(this.dataSource)&&_p.test(e))throw this.createError('Document fields cannot begin and end with "__"')},qp);function qp(e,t,n,r,i,o){this.dataSource=e,this.methodName=t,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}var Vp=function(e,t){this.databaseId=e,this.key=t},$p=(Up.prototype.parseSetData=function(e,t){var n=new Bp(Mp.Set,e,zi.EMPTY_PATH);Wp("Data must be an object, but it was:",n,t);var r=this.parseData(t,n);return new xp(r,null,n.fieldTransforms)},Up.prototype.parseMergeData=function(e,t,n){var r=new Bp(Mp.MergeSet,e,zi.EMPTY_PATH);Wp("Data must be an object, but it was:",r,t);var i,o,a=this.parseData(t,r);if(n){for(var s=new bo(zi.comparator),u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof Zf)h=l._internalPath;else{if("string"!=typeof l)throw Ur("Expected stringOrFieldPath to be a string or a FieldPath");h=Kp(e,l)}if(!r.contains(h))throw new Hr(Qr.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}i=ga.fromSet(s),o=r.fieldTransforms.filter((function(e){return i.covers(e.field)}))}else i=ga.fromArray(r.fieldMask),o=r.fieldTransforms;return new xp(a,i,o)},Up.prototype.parseUpdateData=function(e,t){var n=this,r=new Bp(Mp.Update,e,zi.EMPTY_PATH);Wp("Data must be an object, but it was:",r,t);var i=new bo(zi.comparator),o=xs.EMPTY;ti(t,(function(t,a){var s=Kp(e,t),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof mp)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}}));var a=ga.fromSet(i);return new Pp(o,a,r.fieldTransforms)},Up.prototype.parseUpdateVarargs=function(e,t,n,r){var i=new Bp(Mp.Update,e,zi.EMPTY_PATH),o=[zp(e,t)],a=[n];if(r.length%2!=0)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(zp(e,r[s])),a.push(r[s+1]);var u=new bo(zi.comparator),c=xs.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof mp)u=u.add(l);else{var p=this.parseData(f,h);null!=p&&(u=u.add(l),c=c.set(l,p))}}var d=ga.fromSet(u);return new Pp(c,d,i.fieldTransforms)},Up.prototype.parseQueryValue=function(e,t,n){void 0===n&&(n=!1);var r=new Bp(n?Mp.ArrayArgument:Mp.Argument,e,zi.EMPTY_PATH),i=this.parseData(t,r);return jr(null!=i,"Parsed data should not be null."),jr(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},Up.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(e){var n=Gp(e);throw t.createError(n)}},Up.prototype.parseData=function(e,t){if(jp(e=this.runPreConverter(e,t)))return Wp("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof fp)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement&&t.dataSource!==Mp.ArrayArgument)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},Up.prototype.parseObject=function(e,t){var n=this,r=new lo(Si);return ni(e)?t.path&&0<t.path.length&&t.fieldMask.push(t.path):ti(e,(function(e,i){var o=n.parseData(i,t.childContextForField(e));null!=o&&(r=r.insert(e,o))})),new xs(r)},Up.prototype.parseArray=function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=o[i],s=this.parseData(a,t.childContextForArray(r));null==s&&(s=Xa.INSTANCE),n.push(s),r++}return new Os(n)},Up.prototype.parseSentinelFieldValue=function(e,t){if(!Fp(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");if(e instanceof mp){if(t.dataSource!==Mp.MergeSet)throw t.dataSource===Mp.Update?(jr(0<t.path.length,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof vp)t.fieldTransforms.push(new va(t.path,Fh.instance));else if(e instanceof Tp){var n=this.parseArrayTransformElements(e._methodName,e._elements),r=new qh(n);t.fieldTransforms.push(new va(t.path,r))}else if(e instanceof Ip){n=this.parseArrayTransformElements(e._methodName,e._elements);var i=new $h(n);t.fieldTransforms.push(new va(t.path,i))}else if(e instanceof Dp){var o=this.parseQueryValue("FieldValue.increment",e._operand),a=new jh(o);t.fieldTransforms.push(new va(t.path,a))}else Ur("Unknown FieldValue type: "+e)},Up.prototype.parseScalarValue=function(e,t){if(null===e)return Xa.INSTANCE;if("number"==typeof e)return Oc(e)?new ss(e):new ls(e);if("boolean"==typeof e)return es.of(e);if("string"==typeof e)return new ps(e);if(e instanceof Date)return new gs(ao.fromDate(e));if(e instanceof ao)return new gs(new ao(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof Ph)return new Ns(e);if(e instanceof Ni)return new Es(e);if(e instanceof Vp)return new Cs(e.databaseId,e.key);throw t.createError("Unsupported field value: "+di(e))},Up.prototype.parseArrayTransformElements=function(e,t){var n=this;return t.map((function(t,r){var i=new Bp(Mp.Argument,e,zi.EMPTY_PATH);return n.parseData(t,i.childContextForArray(r))}))},Up);function Up(e){this.preConverter=e}function jp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ao||e instanceof Ph||e instanceof Ni||e instanceof Vp||e instanceof fp)}function Wp(e,t,n){if(!jp(n)||!pi(n)){var r=di(n);throw"an object"===r?t.createError(e+" a custom object"):t.createError(e+" "+r)}}function zp(e,t){if(t instanceof Zf)return t._internalPath;if("string"==typeof t)return Kp(e,t);throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Kp(e,t){try{return function(e){if(0<=e.search(tp))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Zf.bind.apply(Zf,u([void 0],e.split("."))))}catch(t){throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(t)._internalPath}catch(t){var n=Gp(t);throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function Gp(e){return e instanceof Error?e.message:e.toString()}var Qp=hc.COLLECTION_DISABLED,Hp=(Yp.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.forceLongPolling===e.forceLongPolling},Yp);function Yp(e){if(void 0===e.host){if(void 0!==e.ssl)throw new Hr(Qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ci("settings","non-empty string","host",e.host),this.host=e.host,li("settings","boolean","ssl",e.ssl),this.ssl=Zr(e.ssl,!0);if(gi("settings",e,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),li("settings","object","credentials",e.credentials),this.credentials=e.credentials,li("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),!0===e.timestampsInSnapshots?Vr("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===e.timestampsInSnapshots&&Vr("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Zr(e.timestampsInSnapshots,!0),li("settings","number","cacheSizeBytes",e.cacheSizeBytes),void 0===e.cacheSizeBytes)this.cacheSizeBytes=hc.DEFAULT_CACHE_SIZE_BYTES;else{if(e.cacheSizeBytes!==Qp&&e.cacheSizeBytes<hc.MINIMUM_CACHE_SIZE_BYTES)throw new Hr(Qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+hc.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=e.cacheSizeBytes}li("settings","boolean","experimentalForceLongPolling",e.experimentalForceLongPolling),this.forceLongPolling=void 0!==e.experimentalForceLongPolling&&e.experimentalForceLongPolling}var Xp=(Jp.prototype.settings=function(e){if(ii("Firestore.settings",arguments,1),si("Firestore.settings","object",1,e),Jr(e,"persistence"))throw new Hr(Qr.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new Hp(e);if(this._firestoreClient&&!this._settings.isEqual(t))throw new Hr(Qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this._settings=t).credentials&&(this._credentials=function(e){if(!e)return new rp;switch(e.type){case"gapi":var t=e.client;return jr(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new cp(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new Hr(Qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Jp.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},Jp.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},Jp.prototype.enablePersistence=function(e){if(this._firestoreClient)throw new Hr(Qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var t=!1;return e&&(void 0!==e.experimentalTabSynchronization&&Vr("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),t=Zr(void 0!==e.synchronizeTabs?e.synchronizeTabs:e.experimentalTabSynchronization,!1)),this.configureClient(new Kf(this._settings.cacheSizeBytes,t))},Jp.prototype.clearPersistence=function(){var e=this,t=Ec.buildStoragePrefix(this.makeDatabaseInfo()),n=new Xi;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return a(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new Hr(Qr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Ec.clearPersistence(t)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise},Jp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Jp.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),Jp.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},Jp.prototype.onSnapshotsInSync=function(e){if(this.ensureClientConfigured(),hp(e))return this.onSnapshotsInSyncInternal(e);si("Firestore.onSnapshotsInSync","function",1,e);var t={next:e};return this.onSnapshotsInSyncInternal(t)},Jp.prototype.onSnapshotsInSyncInternal=function(e){var t=this,n=new Xf({next:function(){e.next&&e.next()},error:function(e){throw Ur("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),t._firestoreClient.removeSnapshotsInSyncListener(n)}},Jp.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Qf),this._firestoreClient},Jp.prototype.makeDatabaseInfo=function(){return new xi(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},Jp.prototype.configureClient=function(e){jr(!!this._settings.host,"FirestoreSettings.host is not set"),jr(!this._firestoreClient,"configureClient() called multiple times");var t=this.makeDatabaseInfo();return this._firestoreClient=new Hf(Wr.getPlatform(),t,this._credentials,this._queue),this._firestoreClient.start(e)},Jp.prototype.createDataConverter=function(e){return new $p((function(t){if(t instanceof rd){var n=e,r=t.firestore._databaseId;if(!r.isEqual(n))throw new Hr(Qr.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Vp(e,t._key)}return t}))},Jp.databaseIdFromApp=function(e){var t=e.options;if(!Jr(t,"projectId"))throw new Hr(Qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=t.projectId;if(!n||"string"!=typeof n)throw new Hr(Qr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Mi(n)},Object.defineProperty(Jp.prototype,"app",{get:function(){if(!this._firebaseApp)throw new Hr(Qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),Jp.prototype.collection=function(e){return ii("Firestore.collection",arguments,1),si("Firestore.collection","non-empty string",1,e),this.ensureClientConfigured(),new yd($i.fromString(e),this)},Jp.prototype.doc=function(e){return ii("Firestore.doc",arguments,1),si("Firestore.doc","non-empty string",1,e),this.ensureClientConfigured(),rd.forPath($i.fromString(e),this)},Jp.prototype.collectionGroup=function(e){if(ii("Firestore.collectionGroup",arguments,1),si("Firestore.collectionGroup","non-empty string",1,e),0<=e.indexOf("/"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new fd(new qc($i.EMPTY_PATH,e),this)},Jp.prototype.runTransaction=function(e){var t=this;return ii("Firestore.runTransaction",arguments,1),si("Firestore.runTransaction","function",1,e),this.ensureClientConfigured().transaction((function(n){return e(new Zp(t,n))}))},Jp.prototype.batch=function(){return this.ensureClientConfigured(),new td(this)},Object.defineProperty(Jp,"logLevel",{get:function(){switch(Fr()){case Dr.DEBUG:return"debug";case Dr.ERROR:return"error";case Dr.SILENT:return"silent";default:return Ur("Unknown log level: "+Fr())}},enumerable:!0,configurable:!0}),Jp.setLogLevel=function(e){switch(ii("Firestore.setLogLevel",arguments,1),si("Firestore.setLogLevel","non-empty string",1,e),e){case"debug":Br(Dr.DEBUG);break;case"error":Br(Dr.ERROR);break;case"silent":Br(Dr.SILENT);break;default:throw new Hr(Qr.INVALID_ARGUMENT,"Invalid log level: "+e)}},Jp.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},Jp);function Jp(e,t){var n=this;if(this._firebaseApp=null,this._queue=new eo,this.INTERNAL={delete:function(){return a(n,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return e.sent(),[2]}}))}))}},"object"==typeof e.options){var r=e;this._firebaseApp=r,this._databaseId=Jp.databaseIdFromApp(r),this._persistenceKey=r.name,this._credentials=new op(t)}else{var i=e;if(!i.projectId)throw new Hr(Qr.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new Mi(i.projectId,i.database),this._persistenceKey="[DEFAULT]",this._credentials=new rp}this._settings=new Hp({}),this._dataConverter=this.createDataConverter(this._databaseId)}var Zp=(ed.prototype.get=function(e){var t=this;ii("Transaction.get",arguments,1);var n=Ed("Transaction.get",e,this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Ur("Mismatch in docs returned from document lookup.");var r=e[0];if(r instanceof Us)return new sd(t._firestore,n._key,null,!1,!1,n._converter);if(r instanceof qs)return new sd(t._firestore,n._key,r,!1,!1,n._converter);throw Ur("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},ed.prototype.set=function(e,t,n){ai("Transaction.set",arguments,2,3);var r=Ed("Transaction.set",e,this._firestore);n=bd("Transaction.set",n);var i=Sd(r._converter,t,"Transaction.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._transaction.set(r._key,s),this},ed.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return i="string"==typeof t||t instanceof Zf?(oi("Transaction.update",arguments,3),r=Ed("Transaction.update",e,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,n,o)):(ii("Transaction.update",arguments,2),r=Ed("Transaction.update",e,this._firestore),this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(r._key,i),this},ed.prototype.delete=function(e){ii("Transaction.delete",arguments,1);var t=Ed("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},ed);function ed(e,t){this._firestore=e,this._transaction=t}var td=(nd.prototype.set=function(e,t,n){ai("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Ed("WriteBatch.set",e,this._firestore);n=bd("WriteBatch.set",n);var i=Sd(r._converter,t,"WriteBatch.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._mutations=this._mutations.concat(s.toMutations(r._key,Sa.NONE)),this},nd.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),i="string"==typeof t||t instanceof Zf?(oi("WriteBatch.update",arguments,3),r=Ed("WriteBatch.update",e,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,n,o)):(ii("WriteBatch.update",arguments,2),r=Ed("WriteBatch.update",e,this._firestore),this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(i.toMutations(r._key,Sa.exists(!0))),this},nd.prototype.delete=function(e){ii("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=Ed("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new Fa(t._key,Sa.NONE)),this},nd.prototype.commit=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},nd.prototype.verifyNotCommitted=function(){if(this._committed)throw new Hr(Qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},nd);function nd(e){this._firestore=e,this._mutations=[],this._committed=!1}var rd=(id.forPath=function(e,t,n){if(e.length%2!=0)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new id(new Gi(e),t,n)},Object.defineProperty(id.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(id.prototype,"parent",{get:function(){return new yd(this._key.path.popLast(),this.firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(id.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),id.prototype.collection=function(e){if(ii("DocumentReference.collection",arguments,1),si("DocumentReference.collection","non-empty string",1,e),!e)throw new Hr(Qr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=$i.fromString(e);return new yd(this._key.path.child(t),this.firestore)},id.prototype.isEqual=function(e){if(!(e instanceof id))throw yi("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)&&this._converter===e._converter},id.prototype.set=function(e,t){ai("DocumentReference.set",arguments,1,2),t=bd("DocumentReference.set",t);var n=Sd(this._converter,e,"DocumentReference.set"),r=n[0],i=n[1],o=t.merge||t.mergeFields?this.firestore._dataConverter.parseMergeData(i,r,t.mergeFields):this.firestore._dataConverter.parseSetData(i,r);return this._firestoreClient.write(o.toMutations(this._key,Sa.NONE))},id.prototype.update=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof e||e instanceof Zf?(oi("DocumentReference.update",arguments,2),this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,r)):(ii("DocumentReference.update",arguments,1),this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(n.toMutations(this._key,Sa.exists(!0)))},id.prototype.delete=function(){return ii("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Fa(this._key,Sa.NONE)])},id.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];ai("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||hp(e[i])||(gi("DocumentReference.onSnapshot",r=e[i],["includeMetadataChanges"]),li("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=hp(e[i])?e[i]:(si("DocumentReference.onSnapshot","function",i,e[i]),ui("DocumentReference.onSnapshot","function",i+1,e[i+1]),ui("DocumentReference.onSnapshot","function",i+2,e[i+2]),{next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(o,n)},id.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new Xf({next:function(e){if(t.next){jr(e.docs.size<=1,"Too many documents returned on a document query");var r=e.docs.get(n._key);t.next(new sd(n.firestore,n._key,r,e.fromCache,e.hasPendingWrites,n._converter))}},error:r}),o=this._firestoreClient.listen(qc.atPath(this._key.path),i,e);return function(){i.mute(),n._firestoreClient.unlisten(o)}},id.prototype.get=function(e){var t=this;return ai("DocumentReference.get",arguments,0,1),Td("DocumentReference.get",e),new Promise((function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentFromLocalCache(t._key).then((function(e){n(new sd(t.firestore,t._key,e,!0,e instanceof qs&&e.hasLocalMutations,t._converter))}),r):t.getViaSnapshotListener(n,r,e)}))},id.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?t(new Hr(Qr.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?t(new Hr(Qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(i)},error:t})},id.prototype.withConverter=function(e){return new id(this._key,this.firestore,e)},id);function id(e,t,n){this._key=e,this.firestore=t,this._converter=n,this._firestoreClient=this.firestore.ensureClientConfigured()}var od=(ad.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},ad);function ad(e,t){this.hasPendingWrites=e,this.fromCache=t}var sd=(ud.prototype.data=function(e){if(ai("DocumentSnapshot.data",arguments,0,1),e=wd("DocumentSnapshot.data",e),this._document){if(this._converter){var t=new ld(this._firestore,this._key,this._document,this._fromCache,this._hasPendingWrites);return this._converter.fromFirestore(t,e)}return this.toJSObject(this._document.data(),Ka.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},ud.prototype.get=function(e,t){if(ai("DocumentSnapshot.get",arguments,1,2),t=wd("DocumentSnapshot.get",t),this._document){var n=this._document.data().field(zp("DocumentSnapshot.get",e));if(null!==n)return this.toJSValue(n,Ka.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(ud.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(ud.prototype,"ref",{get:function(){return new rd(this._key,this._firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(ud.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(ud.prototype,"metadata",{get:function(){return new od(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),ud.prototype.isEqual=function(e){if(!(e instanceof ud))throw yi("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))&&this._converter===e._converter},ud.prototype.toJSObject=function(e,t){var n=this,r={};return e.forEach((function(e,i){r[e]=n.toJSValue(i,t)})),r},ud.prototype.toJSValue=function(e,t){if(e instanceof xs)return this.toJSObject(e,t);if(e instanceof Os)return this.toJSArray(e,t);if(e instanceof Cs){var n=e.value(t),r=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(r)||Vr("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new rd(n,this._firestore,this._converter)}return e.value(t)},ud.prototype.toJSArray=function(e,t){var n=this;return e.internalValue.map((function(e){return n.toJSValue(e,t)}))},ud);function ud(e,t,n,r,i,o){this._firestore=e,this._key=t,this._document=n,this._fromCache=r,this._hasPendingWrites=i,this._converter=o}var cd,ld=(n(hd,cd=sd),hd.prototype.data=function(e){var t=cd.prototype.data.call(this,e);return jr(void 0!==t,"Document in a QueryDocumentSnapshot should exist"),t},hd);function hd(){return null!==cd&&cd.apply(this,arguments)||this}var fd=(pd.prototype.where=function(e,t,n){var r;ii("Query.where",arguments,3),mi("Query.where",3,n),function(e,t,n,r){if(!t.some((function(e){return e===r})))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid value "+di(r)+" provided to function Query.where() for its "+bi(2)+" argument. Acceptable values: "+t.join(", "))}(0,["<","<=","==",">=",">","array-contains","in","array-contains-any"],0,t);var i=zp("Query.where",e),o=$c.fromString(t);if(i.isKeyField()){if(o===$c.ARRAY_CONTAINS||o===$c.ARRAY_CONTAINS_ANY)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===$c.IN){this.validateDisjunctiveFilterElements(n,o);for(var a=[],s=0,u=n;s<u.length;s++){var c=u[s];a.push(this.parseDocumentIdValue(c))}r=new Os(a)}else r=this.parseDocumentIdValue(n)}else o!==$c.IN&&o!==$c.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(n,o),r=this.firestore._dataConverter.parseQueryValue("Query.where",n,o===$c.IN);var l=Wc.create(i,o,r);return this.validateNewFilter(l),new pd(this._query.addFilter(l),this.firestore,this._converter)},pd.prototype.orderBy=function(e,t){var n;if(ai("Query.orderBy",arguments,1,2),ui("Query.orderBy","non-empty string",2,t),void 0===t||"asc"===t)n=sl.ASCENDING;else{if("desc"!==t)throw new Hr(Qr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+t+"', expected 'asc' or 'desc'.");n=sl.DESCENDING}if(null!==this._query.startAt)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=zp("Query.orderBy",e),i=new hl(r,n);return this.validateNewOrderBy(i),new pd(this._query.addOrderBy(i),this.firestore,this._converter)},pd.prototype.limit=function(e){return ii("Query.limit",arguments,1),si("Query.limit","number",1,e),vi("Query.limit",1,e),new pd(this._query.withLimitToFirst(e),this.firestore,this._converter)},pd.prototype.limitToLast=function(e){return ii("Query.limitToLast",arguments,1),si("Query.limitToLast","number",1,e),vi("Query.limitToLast",1,e),new pd(this._query.withLimitToLast(e),this.firestore,this._converter)},pd.prototype.startAt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];oi("Query.startAt",arguments,1);var r=this.boundFromDocOrFields("Query.startAt",e,t,!0);return new pd(this._query.withStartAt(r),this.firestore,this._converter)},pd.prototype.startAfter=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];oi("Query.startAfter",arguments,1);var r=this.boundFromDocOrFields("Query.startAfter",e,t,!1);return new pd(this._query.withStartAt(r),this.firestore,this._converter)},pd.prototype.endBefore=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];oi("Query.endBefore",arguments,1);var r=this.boundFromDocOrFields("Query.endBefore",e,t,!0);return new pd(this._query.withEndAt(r),this.firestore,this._converter)},pd.prototype.endAt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];oi("Query.endAt",arguments,1);var r=this.boundFromDocOrFields("Query.endAt",e,t,!1);return new pd(this._query.withEndAt(r),this.firestore,this._converter)},pd.prototype.isEqual=function(e){if(!(e instanceof pd))throw yi("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},pd.prototype.withConverter=function(e){return new pd(this._query,this.firestore,e)},pd.prototype.boundFromDocOrFields=function(e,t,n,r){if(mi(e,1,t),t instanceof sd){if(0<n.length)throw new Hr(Qr.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var i=t;if(!i.exists)throw new Hr(Qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,i._document,r)}var o=[t].concat(n);return this.boundFromFields(e,o,r)},pd.prototype.boundFromDocument=function(e,t,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Cs(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(s instanceof bs)throw new Hr(Qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new cl(r,n)},pd.prototype.boundFromFields=function(e,t,n){var r=this._query.explicitOrderBy;if(t.length>r.length)throw new Hr(Qr.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<t.length;o++){var a=t[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+e+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child($i.fromString(a));if(!Gi.isDocumentKey(s))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+e+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new Gi(s);i.push(new Cs(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(e,a);i.push(c)}}return new cl(i,n)},pd.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];ai("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof e[i]||hp(e[i])||(gi("Query.onSnapshot",r=e[i],["includeMetadataChanges"]),li("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=hp(e[i])?e[i]:(si("Query.onSnapshot","function",i,e[i]),ui("Query.onSnapshot","function",i+1,e[i+1]),ui("Query.onSnapshot","function",i+2,e[i+2]),{next:e[i],error:e[i+1],complete:e[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},pd.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new Xf({next:function(e){t.next&&t.next(new dd(n.firestore,n._query,e,n._converter))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,e);return function(){i.mute(),o.unlisten(a)}},pd.prototype.validateHasExplicitOrderByForLimitToLast=function(e){if(e.hasLimitToLast()&&0===e.explicitOrderBy.length)throw new Hr(Qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},pd.prototype.get=function(e){var t=this;return ai("Query.get",arguments,0,1),Td("Query.get",e),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise((function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentsFromLocalCache(t._query).then((function(e){n(new dd(t.firestore,t._query,e,t._converter))}),r):t.getViaSnapshotListener(n,r,e)}))},pd.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?t(new Hr(Qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(i)},error:t})},pd.prototype.parseDocumentIdValue=function(e){if("string"==typeof e){if(""===e)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==e.indexOf("/"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+e+"' contains a '/' character.");var t=this._query.path.child($i.fromString(e));if(!Gi.isDocumentKey(t))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return new Cs(this.firestore._databaseId,new Gi(t))}if(e instanceof rd){var n=e;return new Cs(this.firestore._databaseId,n._key)}throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+di(e)+".")},pd.prototype.validateDisjunctiveFilterElements=function(e,t){if(!Array.isArray(e)||0===e.length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(10<e.length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=e.indexOf(null))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'null' in the value array.");if(0<e.filter((function(e){return Number.isNaN(e)})).length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'NaN' in the value array.")},pd.prototype.validateNewFilter=function(e){if(e instanceof Wc){var t=[$c.ARRAY_CONTAINS,$c.ARRAY_CONTAINS_ANY],n=[$c.IN,$c.ARRAY_CONTAINS_ANY],r=0<=t.indexOf(e.op),i=0<=n.indexOf(e.op);if(e.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(e.field))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+e.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(e.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(t)),null!=s)throw s===e.op?new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},pd.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},pd.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},pd);function pd(e,t,n){this._query=e,this.firestore=t,this._converter=n}var dd=(Object.defineProperty(md.prototype,"docs",{get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e},enumerable:!0,configurable:!0}),Object.defineProperty(md.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(md.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),md.prototype.forEach=function(e,t){var n=this;ai("QuerySnapshot.forEach",arguments,1,2),si("QuerySnapshot.forEach","function",1,e),this._snapshot.docs.forEach((function(r){e.call(t,n.convertToDocumentImpl(r))}))},Object.defineProperty(md.prototype,"query",{get:function(){return new fd(this._originalQuery,this._firestore,this._converter)},enumerable:!0,configurable:!0}),md.prototype.docChanges=function(e){e&&(gi("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),li("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this._snapshot.excludesMetadataChanges)throw new Hr(Qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t,n,r){if(n.oldDocs.isEmpty()){var i,o=0;return n.docChanges.map((function(t){var a=new ld(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key),r);return jr(t.type===sh.Added,"Invalid event type for first snapshot"),jr(!i||n.query.docComparator(i,t.doc)<0,"Got added events in wrong order"),i=t.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}}))}var a=n.oldDocs;return n.docChanges.filter((function(e){return t||e.type!==sh.Metadata})).map((function(t){var i=new ld(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key),r),o=-1,s=-1;return t.type!==sh.Added&&(jr(0<=(o=a.indexOf(t.doc.key)),"Index for document not found"),a=a.delete(t.doc.key)),t.type!==sh.Removed&&(s=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case sh.Added:return"added";case sh.Modified:case sh.Metadata:return"modified";case sh.Removed:return"removed";default:return Ur("Unknown change type: "+e)}}(t.type),doc:i,oldIndex:o,newIndex:s}}))}(this._firestore,t,this._snapshot,this._converter),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},md.prototype.isEqual=function(e){if(!(e instanceof md))throw yi("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)&&this._converter===e._converter},md.prototype.convertToDocumentImpl=function(e){return new ld(this._firestore,e.key,e,this.metadata.fromCache,this._snapshot.mutatedKeys.has(e.key),this._converter)},md);function md(e,t,n,r){this._firestore=e,this._originalQuery=t,this._snapshot=n,this._converter=r,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new od(n.hasPendingWrites,n.fromCache)}u(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(e){try{Object.defineProperty(dd.prototype.docChanges,e,{get:function(){return function(){throw new Hr(Qr.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(e){}}));var gd,yd=(n(vd,gd=fd),Object.defineProperty(vd.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(vd.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new rd(new Gi(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(vd.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),vd.prototype.doc=function(e){if(ai("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=Ti.newId()),si("CollectionReference.doc","non-empty string",1,e),""===e)throw new Hr(Qr.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=$i.fromString(e);return rd.forPath(this._query.path.child(t),this.firestore,this._converter)},vd.prototype.add=function(e){ii("CollectionReference.add",arguments,1),si("CollectionReference.add","object",1,this._converter?this._converter.toFirestore(e):e);var t=this.doc();return t.set(e).then((function(){return t}))},vd.prototype.withConverter=function(e){return new vd(this._path,this.firestore,e)},vd);function vd(e,t,n){var r=gd.call(this,qc.atPath(e),t,n)||this;if((r._path=e).length%2!=1)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}function bd(e,t){if(void 0===t)return{merge:!1};if(gi(e,t,["merge","mergeFields"]),li(e,"boolean","merge",t.merge),function(e,t,n,r,i){void 0!==r&&function(e,t,n,r,i){if(!(r instanceof Array))throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires its "+t+" option to be an array, but it was: "+di(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new Hr(Qr.INVALID_ARGUMENT,"Function "+e+"() requires all "+t+" elements to be "+n+", but the value at index "+o+" was: "+di(r[o]))}(e,t,n,r,i)}(e,"mergeFields","a string or a FieldPath",t.mergeFields,(function(e){return"string"==typeof e||e instanceof Zf})),void 0!==t.mergeFields&&void 0!==t.merge)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function wd(e,t){return void 0===t?{}:(gi(e,t,["serverTimestamps"]),hi(e,0,"serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function Td(e,t){ui(e,"object",1,t),t&&(gi(e,t,["source"]),hi(e,0,"source",t.source,["default","server","cache"]))}function Ed(e,t,n){if(t instanceof rd){if(t.firestore!==n)throw new Hr(Qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw yi(e,"DocumentReference",1,t)}function Sd(e,t,n){var r;return e?(r=e.toFirestore(t),n="toFirestore() in "+n):r=t,[r,n]}var Id=Xr(Xp,"Use firebase.firestore() instead."),Cd=Xr(Zp,"Use firebase.firestore().runTransaction() instead."),Ad=Xr(td,"Use firebase.firestore().batch() instead."),Dd=Xr(rd,"Use firebase.firestore().doc() instead."),Nd=Xr(sd),kd=Xr(ld),_d=Xr(fd),xd=Xr(dd),Rd=Xr(yd,"Use firebase.firestore().collection() instead."),Md={Firestore:Id,GeoPoint:Ph,Timestamp:ao,Blob:_i,Transaction:Cd,WriteBatch:Ad,DocumentReference:Dd,DocumentSnapshot:Nd,Query:_d,QueryDocumentSnapshot:kd,QuerySnapshot:xd,CollectionReference:Rd,FieldPath:Zf,FieldValue:kp,setLogLevel:Xp.setLogLevel,CACHE_SIZE_UNLIMITED:Qp},Od=(Pd.prototype.addCallback=function(e){},Pd.prototype.shutdown=function(){},Pd);function Pd(){}var Ld="ConnectivityMonitor",Fd=(Bd.prototype.addCallback=function(e){this.callbacks.push(e)},Bd.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},Bd.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},Bd.prototype.onNetworkAvailable=function(){qr(Ld,"Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(0)},Bd.prototype.onNetworkUnavailable=function(){qr(Ld,"Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(1)},Bd.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Bd);function Bd(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}var qd=(Vd.prototype.onOpen=function(e){jr(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},Vd.prototype.onClose=function(e){jr(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},Vd.prototype.onMessage=function(e){jr(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},Vd.prototype.close=function(){this.closeFn()},Vd.prototype.send=function(e){this.sendFn(e)},Vd.prototype.callOnOpen=function(){jr(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},Vd.prototype.callOnClose=function(e){jr(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},Vd.prototype.callOnMessage=function(e){jr(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},Vd);function Vd(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}var $d="Connection",Ud={BatchGetDocuments:"batchGet",Commit:"commit"},jd="gl-js/ fire/"+Pr,Wd=(zd.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n]);e["X-Goog-Api-Client"]=jd},zd.prototype.invokeRPC=function(e,t,n){var r=this,i=this.makeUrl(e);return new Promise((function(a,s){var u=new Or;u.listenOnce(Rr.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case xr.NO_ERROR:var t=u.getResponseJson();qr($d,"XHR received:",JSON.stringify(t)),a(t);break;case xr.TIMEOUT:qr($d,'RPC "'+e+'" timed out'),s(new Hr(Qr.DEADLINE_EXCEEDED,"Request time out"));break;case xr.HTTP_ERROR:var n=u.getStatus();if(qr($d,'RPC "'+e+'" failed with status:',n,"response text:",u.getResponseText()),0<n){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=function(e){var t=e.toLowerCase().replace("_","-");return 0<=Object.values(Qr).indexOf(t)?t:Qr.UNKNOWN}(r.status);s(new Hr(i,r.message))}else s(new Hr(Qr.UNKNOWN,"Server responded with status "+u.getStatus()))}else qr($d,'RPC "'+e+'" failed'),s(new Hr(Qr.UNAVAILABLE,"Connection failed."));break;default:Ur('RPC "'+e+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{qr($d,'RPC "'+e+'" completed.')}}));var c=o({},t);delete c.database;var l=JSON.stringify(c);qr($d,"XHR sending: ",i+" "+l);var h={"Content-Type":"text/plain"};r.modifyHeadersForRequest(h,n),u.send(i,"POST",l,h,15)}))},zd.prototype.invokeStreamingRPC=function(e,t,n){return this.invokeRPC(e,t,n)},zd.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=_r(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,t),"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||function(){var e=d();return 0<=e.indexOf("MSIE ")||0<=e.indexOf("Trident/")}()||0<=d().indexOf("MSAppHost/")||function(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");function a(e,t){s.listen(e,(function(e){try{t(e)}catch(e){setTimeout((function(){throw e}),0)}}))}qr($d,"Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),u=!1,c=!1,l=new qd({sendFn:function(e){c?qr($d,"Not sending because WebChannel is closed:",e):(u||(qr($d,"Opening WebChannel transport."),s.open(),u=!0),qr($d,"WebChannel sending:",e),s.send(e))},closeFn:function(){return s.close()}});return a(Mr.EventType.OPEN,(function(){c||qr($d,"WebChannel transport opened.")})),a(Mr.EventType.CLOSE,(function(){c||(c=!0,qr($d,"WebChannel transport closed"),l.callOnClose())})),a(Mr.EventType.ERROR,(function(e){c||(c=!0,qr($d,"WebChannel transport errored:",e),l.callOnClose(new Hr(Qr.UNAVAILABLE,"The operation could not be completed")))})),a(Mr.EventType.MESSAGE,(function(e){var t;if(!c){var n=e.data[0];jr(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){qr($d,"WebChannel received error:",i);var o=i.status,a=function(e){var t=th[e];if(void 0!==t)return ah(t)}(o),u=i.message;void 0===a&&(a=Qr.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,l.callOnClose(new Hr(a,u)),s.close()}else qr($d,"WebChannel received:",n),l.callOnMessage(n)}})),setTimeout((function(){l.callOnOpen()}),0),l},zd.prototype.makeUrl=function(e){var t=Ud[e];return jr(void 0!==t,"Unknown REST mapping for: "+e),this.baseUrl+"/v1/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+t},zd);function zd(e){this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.baseUrl=t+"://"+e.host,this.forceLongPolling=e.forceLongPolling}var Kd,Gd=(Object.defineProperty(Qd.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Qd.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Qd.prototype.loadConnection=function(e){return Promise.resolve(new Wd(e))},Qd.prototype.newConnectivityMonitor=function(){return Fd.isAvailable()?new Fd:new Od},Qd.prototype.newSerializer=function(e){return new tf(e,{useProto3Json:!0})},Qd.prototype.formatJSON=function(e){return JSON.stringify(e)},Qd.prototype.atob=function(e){return atob(e)},Qd.prototype.btoa=function(e){return btoa(e)},Qd);function Qd(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}Wr.setPlatform(new Gd),function(e){e.INTERNAL.registerComponent(new T("firestore",(function(e){var t=e.getProvider("app").getImmediate();return new Xp(t,e.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(function(e){jr(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(Md)))}(Kd=e),Kd.registerVersion("@firebase/firestore","1.10.2")}).apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}(Nr)}));xr.initializeApp({apiKey:"AIzaSyCleD84L5byPj4gRjXsmX4-MJKAtfo1b68",authDomain:"mutex-2020.firebaseapp.com",databaseURL:"https://mutex-2020.firebaseio.com",projectId:"mutex-2020",storageBucket:"mutex-2020.appspot.com",messagingSenderId:"386680048101",appId:"1:386680048101:web:3b667ac39534d533aa870c",measurementId:"G-L46E8MDJB8"});const Rr=xr.firestore();function Mr(t){let n,r,i,o,a,s,u,c,l,h;return{c(){n=S("div"),r=S("div"),i=S("div"),i.innerHTML='<div class="eye svelte-1oead8"></div> \n      <div class="eye right svelte-1oead8"></div> \n      <div class="mouth happy svelte-1oead8"></div>',o=A(),a=S("div"),s=A(),u=S("div"),u.innerHTML='<h1 class="alert svelte-1oead8">Success!</h1> \n      <p class="messageP svelte-1oead8">Your form has been submitted successfully</p>',c=A(),l=S("button"),l.textContent="continue",x(i,"class","face svelte-1oead8"),x(a,"class","shadow scale svelte-1oead8"),x(u,"class","message svelte-1oead8"),x(l,"class","button-box svelte-1oead8"),x(r,"id","success-box"),x(r,"class","svelte-1oead8"),x(n,"class","successContainer svelte-1oead8")},m(e,f){w(e,n,f),b(n,r),b(r,i),b(r,o),b(r,a),b(r,s),b(r,u),b(r,c),b(r,l),h=N(l,"click",t[0])},p:e,i:e,o:e,d(e){e&&T(n),h()}}}function Or(e){const t=Q();return[()=>t("accept")]}class Pr extends _e{constructor(e){super(),ke(this,e,Or,Mr,s,{})}}function Lr(e,t,n){const r=e.slice();return r[40]=t[n],r[41]=t,r[42]=n,r}function Fr(e){let t,n,r,i,o,a,s;const u=new Dn({props:{$$slots:{default:[Br]},$$scope:{ctx:e}}});let c=e[4]&&qr();return{c(){t=S("div"),n=S("fieldset"),r=S("h2"),r.textContent="Company Overview",i=A(),Ce(u.$$.fragment),o=A(),c&&c.c(),x(r,"class","fs-title svelte-1a052dv"),x(n,"class","svelte-1a052dv"),x(t,"class","svelte-1a052dv")},m(e,a){w(e,t,a),b(t,n),b(n,r),b(n,i),Ae(u,n,null),b(n,o),c&&c.m(n,null),s=!0},p(e,t){const r={};1&t[0]|4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),u.$set(r),e[4]?c||(c=qr(),c.c(),c.m(n,null)):c&&(c.d(1),c=null)},i(e){s||(de(u.$$.fragment,e),ne(()=>{a||(a=ye(t,at,{},!0)),a.run(1)}),s=!0)},o(e){me(u.$$.fragment,e),a||(a=ye(t,at,{},!1)),a.run(0),s=!1},d(e){e&&T(t),De(u),c&&c.d(),e&&a&&a.end()}}}function Br(e){let t,n,r,i,o,a,s,u,c,l,h,f,p,d,m,g,y,v,b,E,I,C,D,_,R,M,O;function P(t){e[16].call(null,t)}let L={Name:"Company Name"};void 0!==e[0].companyInfo.companyName&&(L.value=e[0].companyInfo.companyName);const F=new On({props:L});function B(t){e[17].call(null,t)}X.push(()=>Ie(F,"value",P));let q={Name:"Company Headquarters"};void 0!==e[0].companyInfo.CompanyHeadquarters&&(q.value=e[0].companyInfo.CompanyHeadquarters);const V=new On({props:q});X.push(()=>Ie(V,"value",B));const $=new Zn({props:{selected:e[0].companyInfo.date,isAllowed:e[18]}});function U(t){e[19].call(null,t)}$.$on("datechange",e[7]);let j={Name:"Idea Overview"};void 0!==e[0].companyInfo.ideaOverview&&(j.value=e[0].companyInfo.ideaOverview);const W=new rr({props:j});function z(t){e[20].call(null,t)}X.push(()=>Ie(W,"value",U));let K={Name:"What is your technology component"};void 0!==e[0].companyInfo.tecnologyComponent&&(K.value=e[0].companyInfo.tecnologyComponent);const G=new rr({props:K});function Q(t){e[21].call(null,t)}X.push(()=>Ie(G,"value",z));let H={Name:"Target Market "};void 0!==e[0].companyInfo.targetMarket&&(H.value=e[0].companyInfo.targetMarket);const Y=new rr({props:H});function J(t){e[22].call(null,t)}X.push(()=>Ie(Y,"value",Q));let Z={Name:"How will you make money? (Business Model) "};void 0!==e[0].companyInfo.busnessModel&&(Z.value=e[0].companyInfo.busnessModel);const ee=new rr({props:Z});function te(t){e[23].call(null,t)}X.push(()=>Ie(ee,"value",J));let ne={Name:"Main Competitors "};void 0!==e[0].companyInfo.mainCompetitors&&(ne.value=e[0].companyInfo.mainCompetitors);const ie=new rr({props:ne});function oe(t){e[24].call(null,t)}X.push(()=>Ie(ie,"value",te));let ae={Name:"Achievements to Date"};void 0!==e[0].companyInfo.achievementstoDate&&(ae.value=e[0].companyInfo.achievementstoDate);const se=new rr({props:ae});function ue(t){e[25].call(null,t)}X.push(()=>Ie(se,"value",oe));let ce={Name:"How far along are you?",items:["Idea","Prototype","Users","Paying Users"]};void 0!==e[0].companyInfo.howFarAlongAreYou&&(ce.chosenValue=e[0].companyInfo.howFarAlongAreYou);const le=new ur({props:ce});function he(t){e[26].call(null,t)}function fe(t){e[27].call(null,t)}X.push(()=>Ie(le,"chosenValue",ue));let pe={question:"Are you raising money?"};void 0!==e[0].companyInfo.raisingMoney&&(pe.answer=e[0].companyInfo.raisingMoney),void 0!==e[0].companyInfo.moneyRaisedSoFar&&(pe.value=e[0].companyInfo.moneyRaisedSoFar);const ge=new fr({props:pe});function ye(t){e[28].call(null,t)}X.push(()=>Ie(ge,"answer",he)),X.push(()=>Ie(ge,"value",fe));let ve={label:"Please attach any document that may help us know more about\n              your project",Name:"paste link to document here"};void 0!==e[0].companyInfo.attachmentLink&&(ve.value=e[0].companyInfo.attachmentLink);const be=new rr({props:ve});return X.push(()=>Ie(be,"value",ye)),{c(){Ce(F.$$.fragment),n=A(),Ce(V.$$.fragment),i=A(),Ce($.$$.fragment),o=A(),Ce(W.$$.fragment),s=A(),Ce(G.$$.fragment),c=A(),Ce(Y.$$.fragment),h=A(),Ce(ee.$$.fragment),p=A(),Ce(ie.$$.fragment),m=A(),Ce(se.$$.fragment),y=A(),Ce(le.$$.fragment),b=A(),Ce(ge.$$.fragment),C=A(),Ce(be.$$.fragment),_=A(),R=S("input"),x(R,"type","button"),x(R,"name","next"),x(R,"class","next action-button svelte-1a052dv"),R.value="Next"},m(t,r){Ae(F,t,r),w(t,n,r),Ae(V,t,r),w(t,i,r),Ae($,t,r),w(t,o,r),Ae(W,t,r),w(t,s,r),Ae(G,t,r),w(t,c,r),Ae(Y,t,r),w(t,h,r),Ae(ee,t,r),w(t,p,r),Ae(ie,t,r),w(t,m,r),Ae(se,t,r),w(t,y,r),Ae(le,t,r),w(t,b,r),Ae(ge,t,r),w(t,C,r),Ae(be,t,r),w(t,_,r),w(t,R,r),M=!0,O=N(R,"click",k(e[5]))},p(e,n){const i={};!t&&1&n[0]&&(t=!0,i.value=e[0].companyInfo.companyName,re(()=>t=!1)),F.$set(i);const o={};!r&&1&n[0]&&(r=!0,o.value=e[0].companyInfo.CompanyHeadquarters,re(()=>r=!1)),V.$set(o);const s={};1&n[0]&&(s.selected=e[0].companyInfo.date),$.$set(s);const c={};!a&&1&n[0]&&(a=!0,c.value=e[0].companyInfo.ideaOverview,re(()=>a=!1)),W.$set(c);const h={};!u&&1&n[0]&&(u=!0,h.value=e[0].companyInfo.tecnologyComponent,re(()=>u=!1)),G.$set(h);const p={};!l&&1&n[0]&&(l=!0,p.value=e[0].companyInfo.targetMarket,re(()=>l=!1)),Y.$set(p);const m={};!f&&1&n[0]&&(f=!0,m.value=e[0].companyInfo.busnessModel,re(()=>f=!1)),ee.$set(m);const y={};!d&&1&n[0]&&(d=!0,y.value=e[0].companyInfo.mainCompetitors,re(()=>d=!1)),ie.$set(y);const b={};!g&&1&n[0]&&(g=!0,b.value=e[0].companyInfo.achievementstoDate,re(()=>g=!1)),se.$set(b);const w={};!v&&1&n[0]&&(v=!0,w.chosenValue=e[0].companyInfo.howFarAlongAreYou,re(()=>v=!1)),le.$set(w);const T={};!E&&1&n[0]&&(E=!0,T.answer=e[0].companyInfo.raisingMoney,re(()=>E=!1)),!I&&1&n[0]&&(I=!0,T.value=e[0].companyInfo.moneyRaisedSoFar,re(()=>I=!1)),ge.$set(T);const S={};!D&&1&n[0]&&(D=!0,S.value=e[0].companyInfo.attachmentLink,re(()=>D=!1)),be.$set(S)},i(e){M||(de(F.$$.fragment,e),de(V.$$.fragment,e),de($.$$.fragment,e),de(W.$$.fragment,e),de(G.$$.fragment,e),de(Y.$$.fragment,e),de(ee.$$.fragment,e),de(ie.$$.fragment,e),de(se.$$.fragment,e),de(le.$$.fragment,e),de(ge.$$.fragment,e),de(be.$$.fragment,e),M=!0)},o(e){me(F.$$.fragment,e),me(V.$$.fragment,e),me($.$$.fragment,e),me(W.$$.fragment,e),me(G.$$.fragment,e),me(Y.$$.fragment,e),me(ee.$$.fragment,e),me(ie.$$.fragment,e),me(se.$$.fragment,e),me(le.$$.fragment,e),me(ge.$$.fragment,e),me(be.$$.fragment,e),M=!1},d(e){De(F,e),e&&T(n),De(V,e),e&&T(i),De($,e),e&&T(o),De(W,e),e&&T(s),De(G,e),e&&T(c),De(Y,e),e&&T(h),De(ee,e),e&&T(p),De(ie,e),e&&T(m),De(se,e),e&&T(y),De(le,e),e&&T(b),De(ge,e),e&&T(C),De(be,e),e&&T(_),e&&T(R),O()}}}function qr(e){let t;return{c(){t=S("p"),t.textContent="all fields are required",x(t,"class","svelte-1a052dv")},m(e,n){w(e,t,n)},d(e){e&&T(t)}}}function Vr(e){let t,n,r,i,a,s,u,c,l,h,f,p,d,m,g,y,v,E=e[2]>=4?"Maximum number of members Reached":"Add Team Member",I=[],D=new Map,_=e[0].teamMembers.sort(Qr);const M=e=>e[40].index;for(let t=0;t<_.length;t+=1){let n=Lr(e,_,t),r=M(n);D.set(r,I[t]=$r(r,n))}let O=e[4]&&Ur();return{c(){t=S("div"),n=S("fieldset"),r=S("h2"),r.textContent="Team Dynamics",i=A(),a=S("h3"),a.textContent="Fill in your team members details, maximum of four members per team.",s=A(),u=S("button"),c=C(E),l=A();for(let e=0;e<I.length;e+=1)I[e].c();h=A(),f=S("input"),p=A(),d=S("input"),m=A(),O&&O.c(),x(r,"class","fs-title svelte-1a052dv"),x(a,"class","fs-subtitle svelte-1a052dv"),x(u,"class","addMemberBTN svelte-1a052dv"),x(f,"type","button"),x(f,"name","previous"),x(f,"class","previous action-button svelte-1a052dv"),f.value="Previous",x(d,"type","button"),x(d,"name","next"),x(d,"class","next action-button svelte-1a052dv"),d.value="Next",x(n,"class","svelte-1a052dv"),x(t,"class","svelte-1a052dv")},m(o,g){w(o,t,g),b(t,n),b(n,r),b(n,i),b(n,a),b(n,s),b(n,u),b(u,c),b(n,l);for(let e=0;e<I.length;e+=1)I[e].m(n,null);b(n,h),b(n,f),b(n,p),b(n,d),b(n,m),O&&O.m(n,null),y=!0,v=[N(u,"click",k(e[29])),N(f,"click",k(e[6])),N(d,"click",k(e[5]))]},p(e,t){(!y||4&t[0])&&E!==(E=e[2]>=4?"Maximum number of members Reached":"Add Team Member")&&R(c,E);const r=e[0].teamMembers.sort(Qr);fe(),I=Te(I,t,M,1,e,r,D,n,we,$r,h,Lr),pe(),e[4]?O||(O=Ur(),O.c(),O.m(n,null)):O&&(O.d(1),O=null)},i(e){if(!y){for(let e=0;e<_.length;e+=1)de(I[e]);ne(()=>{g||(g=ye(t,at,{},!0)),g.run(1)}),y=!0}},o(e){for(let e=0;e<I.length;e+=1)me(I[e]);g||(g=ye(t,at,{},!1)),g.run(0),y=!1},d(e){e&&T(t);for(let e=0;e<I.length;e+=1)I[e].d();O&&O.d(),e&&g&&g.end(),o(v)}}}function $r(e,t){let n,r,i,o,a,s,u,c,l,h,f,p,d,m,g,y,v,E,I,D,k,_,M,O=t[40].index+"";function L(e){t[30].call(null,e,t[40])}let F={Name:"Name"};void 0!==t[40].name&&(F.value=t[40].name);const B=new On({props:F});function q(e){t[31].call(null,e,t[40])}X.push(()=>Ie(B,"value",L));let V={Name:"Age"};void 0!==t[40].age&&(V.value=t[40].age);const $=new On({props:V});function U(){t[32].call(h,t[40])}function j(e){t[33].call(null,e,t[40])}X.push(()=>Ie($,"value",q));let W={Name:"Current City"};void 0!==t[40].CurrentCity&&(W.value=t[40].CurrentCity);const z=new On({props:W});function K(e){t[34].call(null,e,t[40])}X.push(()=>Ie(z,"value",j));let G={Name:"Role Within Team"};void 0!==t[40].role&&(G.value=t[40].role);const Q=new On({props:G});function H(e){t[35].call(null,e,t[40])}X.push(()=>Ie(Q,"value",K));let Y={Name:"Educational Background"};void 0!==t[40].EducationalBackground&&(Y.value=t[40].EducationalBackground);const J=new On({props:Y});function Z(e){t[36].call(null,e,t[40])}X.push(()=>Ie(J,"value",H));let ee={Name:"Work Experience"};void 0!==t[40].WorkExperience&&(ee.value=t[40].WorkExperience);const te=new rr({props:ee});return X.push(()=>Ie(te,"value",Z)),{key:e,first:null,c(){n=S("div"),r=S("h3"),i=C("Member #"),o=C(O),a=A(),Ce(B.$$.fragment),u=A(),Ce($.$$.fragment),l=A(),h=S("select"),f=S("option"),f.textContent="Gender",p=S("option"),p.textContent="Male",d=S("option"),d.textContent="Female",m=A(),Ce(z.$$.fragment),y=A(),Ce(Q.$$.fragment),E=A(),Ce(J.$$.fragment),D=A(),Ce(te.$$.fragment),x(r,"class","svelte-1a052dv"),f.__value="",f.value=f.__value,x(f,"class","svelte-1a052dv"),p.__value="Male",p.value=p.__value,x(p,"class","svelte-1a052dv"),d.__value="Female",d.value=d.__value,x(d,"class","svelte-1a052dv"),x(h,"class","genderSelect svelte-1a052dv"),void 0===t[40].gender&&ne(U),x(n,"class","TeamMemberContainer svelte-1a052dv"),this.first=n},m(e,s){w(e,n,s),b(n,r),b(r,i),b(r,o),b(n,a),Ae(B,n,null),b(n,u),Ae($,n,null),b(n,l),b(n,h),b(h,f),b(h,p),b(h,d),P(h,t[40].gender),b(n,m),Ae(z,n,null),b(n,y),Ae(Q,n,null),b(n,E),Ae(J,n,null),b(n,D),Ae(te,n,null),_=!0,M=N(h,"change",U)},p(e,n){t=e,(!_||1&n[0])&&O!==(O=t[40].index+"")&&R(o,O);const r={};!s&&1&n[0]&&(s=!0,r.value=t[40].name,re(()=>s=!1)),B.$set(r);const i={};!c&&1&n[0]&&(c=!0,i.value=t[40].age,re(()=>c=!1)),$.$set(i),1&n[0]&&P(h,t[40].gender);const a={};!g&&1&n[0]&&(g=!0,a.value=t[40].CurrentCity,re(()=>g=!1)),z.$set(a);const u={};!v&&1&n[0]&&(v=!0,u.value=t[40].role,re(()=>v=!1)),Q.$set(u);const l={};!I&&1&n[0]&&(I=!0,l.value=t[40].EducationalBackground,re(()=>I=!1)),J.$set(l);const f={};!k&&1&n[0]&&(k=!0,f.value=t[40].WorkExperience,re(()=>k=!1)),te.$set(f)},i(e){_||(de(B.$$.fragment,e),de($.$$.fragment,e),de(z.$$.fragment,e),de(Q.$$.fragment,e),de(J.$$.fragment,e),de(te.$$.fragment,e),_=!0)},o(e){me(B.$$.fragment,e),me($.$$.fragment,e),me(z.$$.fragment,e),me(Q.$$.fragment,e),me(J.$$.fragment,e),me(te.$$.fragment,e),_=!1},d(e){e&&T(n),De(B),De($),De(z),De(Q),De(J),De(te),M()}}}function Ur(e){let t;return{c(){t=S("p"),t.textContent="all fields are required",x(t,"class","svelte-1a052dv")},m(e,n){w(e,t,n)},d(e){e&&T(t)}}}function jr(e){let t,n,r,i,a,s,u,c,l,h,f,p,d,m,g;function y(t){e[37].call(null,t)}let v={Name:"FullName"};void 0!==e[0].ContactInfo.FullName&&(v.value=e[0].ContactInfo.FullName);const E=new On({props:v});function I(t){e[38].call(null,t)}X.push(()=>Ie(E,"value",y));let C={Name:"cellphone"};void 0!==e[0].ContactInfo.cellphone&&(C.value=e[0].ContactInfo.cellphone);const D=new On({props:C});function _(t){e[39].call(null,t)}X.push(()=>Ie(D,"value",I));let R={Name:"Email"};void 0!==e[0].ContactInfo.Email&&(R.value=e[0].ContactInfo.Email);const M=new _n({props:R});X.push(()=>Ie(M,"value",_));let O=e[4]&&Wr();return{c(){t=S("div"),n=S("fieldset"),Ce(E.$$.fragment),i=A(),Ce(D.$$.fragment),s=A(),Ce(M.$$.fragment),c=A(),l=S("input"),h=A(),f=S("input"),p=A(),O&&O.c(),x(l,"type","button"),x(l,"name","previous"),x(l,"class","previous action-button svelte-1a052dv"),l.value="Previous",x(f,"type","submit"),x(f,"name","submit"),x(f,"class","submit action-button svelte-1a052dv"),f.value="Submit",x(n,"class","svelte-1a052dv"),x(t,"class","svelte-1a052dv")},m(r,o){w(r,t,o),b(t,n),Ae(E,n,null),b(n,i),Ae(D,n,null),b(n,s),Ae(M,n,null),b(n,c),b(n,l),b(n,h),b(n,f),b(n,p),O&&O.m(n,null),m=!0,g=[N(l,"click",k(e[6])),N(f,"click",k(e[8]))]},p(e,t){const i={};!r&&1&t[0]&&(r=!0,i.value=e[0].ContactInfo.FullName,re(()=>r=!1)),E.$set(i);const o={};!a&&1&t[0]&&(a=!0,o.value=e[0].ContactInfo.cellphone,re(()=>a=!1)),D.$set(o);const s={};!u&&1&t[0]&&(u=!0,s.value=e[0].ContactInfo.Email,re(()=>u=!1)),M.$set(s),e[4]?O||(O=Wr(),O.c(),O.m(n,null)):O&&(O.d(1),O=null)},i(e){m||(de(E.$$.fragment,e),de(D.$$.fragment,e),de(M.$$.fragment,e),ne(()=>{d||(d=ye(t,at,{},!0)),d.run(1)}),m=!0)},o(e){me(E.$$.fragment,e),me(D.$$.fragment,e),me(M.$$.fragment,e),d||(d=ye(t,at,{},!1)),d.run(0),m=!1},d(e){e&&T(t),De(E),De(D),De(M),O&&O.d(),e&&d&&d.end(),o(g)}}}function Wr(e){let t;return{c(){t=S("p"),t.textContent="all fields are required",x(t,"class","svelte-1a052dv")},m(e,n){w(e,t,n)},d(e){e&&T(t)}}}function zr(e){let t;const n=new lt({props:{$$slots:{default:[Kr]},$$scope:{ctx:e}}});return n.$on("close",e[9]),{c(){Ce(n.$$.fragment)},m(e,r){Ae(n,e,r),t=!0},p(e,t){const r={};4096&t[1]&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){t||(de(n.$$.fragment,e),t=!0)},o(e){me(n.$$.fragment,e),t=!1},d(e){De(n,e)}}}function Kr(t){let n;const r=new Pr({});return r.$on("accept",t[10]),{c(){Ce(r.$$.fragment)},m(e,t){Ae(r,e,t),n=!0},p:e,i(e){n||(de(r.$$.fragment,e),n=!0)},o(e){me(r.$$.fragment,e),n=!1},d(e){De(r,e)}}}function Gr(e){let t,n,r,i,o,a,s,u,c,l,h,f,p,d,m=0===e[1]&&Fr(e),g=1===e[1]&&Vr(e),y=2===e[1]&&jr(e),v=e[3]&&zr(e);return{c(){t=S("section"),n=S("form"),r=S("ul"),i=S("li"),i.textContent="Company Overview",o=A(),a=S("li"),a.textContent="Team Dynamics",s=A(),u=S("li"),u.textContent="Contact Information",c=A(),m&&m.c(),l=A(),g&&g.c(),h=A(),y&&y.c(),f=A(),v&&v.c(),p=D(),x(i,"class","svelte-1a052dv"),L(i,"active",e[1]>=0),x(a,"class","svelte-1a052dv"),L(a,"active",e[1]>=1),x(u,"class","svelte-1a052dv"),L(u,"active",e[1]>=2),x(r,"id","progressbar"),x(r,"class","svelte-1a052dv"),x(n,"id","msform"),x(n,"class","svelte-1a052dv"),x(t,"class","svelte-1a052dv")},m(e,T){w(e,t,T),b(t,n),b(n,r),b(r,i),b(r,o),b(r,a),b(r,s),b(r,u),b(n,c),m&&m.m(n,null),b(n,l),g&&g.m(n,null),b(n,h),y&&y.m(n,null),w(e,f,T),v&&v.m(e,T),w(e,p,T),d=!0},p(e,t){2&t[0]&&L(i,"active",e[1]>=0),2&t[0]&&L(a,"active",e[1]>=1),2&t[0]&&L(u,"active",e[1]>=2),0===e[1]?m?(m.p(e,t),de(m,1)):(m=Fr(e),m.c(),de(m,1),m.m(n,l)):m&&(fe(),me(m,1,1,()=>{m=null}),pe()),1===e[1]?g?(g.p(e,t),de(g,1)):(g=Vr(e),g.c(),de(g,1),g.m(n,h)):g&&(fe(),me(g,1,1,()=>{g=null}),pe()),2===e[1]?y?(y.p(e,t),de(y,1)):(y=jr(e),y.c(),de(y,1),y.m(n,null)):y&&(fe(),me(y,1,1,()=>{y=null}),pe()),e[3]?v?(v.p(e,t),de(v,1)):(v=zr(e),v.c(),de(v,1),v.m(p.parentNode,p)):v&&(fe(),me(v,1,1,()=>{v=null}),pe())},i(e){d||(de(m),de(g),de(y),de(v),d=!0)},o(e){me(m),me(g),me(y),me(v),d=!1},d(e){e&&T(t),m&&m.d(),g&&g.d(),y&&y.d(),e&&T(f),v&&v.d(e),e&&T(p)}}}const Qr=function(e,t){return t.index-e.index};function Hr(e,t,n){K(()=>{document.querySelector("html").style.backgroundColor=" rgb(129, 111, 131)"}),G(()=>{document.querySelector("html").style.backgroundColor=""});let r,i,o={companyInfo:{companyName:"",date:new Date,ideaOverview:"",tecnologyComponent:"",targetMarket:"",busnessModel:"",mainCompetitors:"",achievementsToDate:"",howFarAlongAreYou:"",raisingMoney:"",moneyRaisedSoFar:"0"},teamMembers:[],ContactInfo:{Email:"",cellphone:"",FullName:""}},a=0,s=0,u=document.querySelectorAll("#msform");let c=()=>{let e={0:o.companyInfo,1:o.teamMembers,2:o.ContactInfo},t=Array.isArray(e[a])?Object.assign({},e[a]):e[a];Object.values(t).forEach(e=>{n(4,i=!!(void 0===e|""===e))})};return e.$$.update=()=>{16&e.$$.dirty[0]&&console.log("validationerror"+i)},[o,a,s,r,i,e=>{c(),i||n(1,a=(a+1)%3)},e=>{n(1,a=(a-1)%3)},e=>{console.log(e.detail),n(0,o.companyInfo.date=e.detail,o)},()=>{if(c(),i)return;Rr.collection("applicants").add(o).then((function(){console.log("Document successfully written!"),n(3,r=!0)})).catch((function(e){console.error("Error writing document: ",e)}))},()=>{n(3,r=!r)},e=>{We("/#/")},void 0,void 0,void 0,u,c,function(e){o.companyInfo.companyName=e,n(0,o)},function(e){o.companyInfo.CompanyHeadquarters=e,n(0,o)},e=>{const t=e.getTime();return t+9e7<Date.now()||!(t>Date.now()+3888e6)},function(e){o.companyInfo.ideaOverview=e,n(0,o)},function(e){o.companyInfo.tecnologyComponent=e,n(0,o)},function(e){o.companyInfo.targetMarket=e,n(0,o)},function(e){o.companyInfo.busnessModel=e,n(0,o)},function(e){o.companyInfo.mainCompetitors=e,n(0,o)},function(e){o.companyInfo.achievementstoDate=e,n(0,o)},function(e){o.companyInfo.howFarAlongAreYou=e,n(0,o)},function(e){o.companyInfo.raisingMoney=e,n(0,o)},function(e){o.companyInfo.moneyRaisedSoFar=e,n(0,o)},function(e){o.companyInfo.attachmentLink=e,n(0,o)},()=>{s>=4||(n(2,s+=1),n(0,o.teamMembers=[...o.teamMembers,{index:o.teamMembers.length+1}],o))},function(e,t){t.name=e,n(0,o)},function(e,t){t.age=e,n(0,o)},function(e){e.gender=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(0,o)},function(e,t){t.CurrentCity=e,n(0,o)},function(e,t){t.role=e,n(0,o)},function(e,t){t.EducationalBackground=e,n(0,o)},function(e,t){t.WorkExperience=e,n(0,o)},function(e){o.ContactInfo.FullName=e,n(0,o)},function(e){o.ContactInfo.cellphone=e,n(0,o)},function(e){o.ContactInfo.Email=e,n(0,o)}]}const Yr={"/":Tn,"/competition-registration":class extends _e{constructor(e){super(),ke(this,e,Hr,Gr,s,{},[-1,-1])}},"*":Tn};function Xr(t){let n,r;const i=new bt({}),o=new Ke({props:{routes:Yr}});return{c(){Ce(i.$$.fragment),n=A(),Ce(o.$$.fragment)},m(e,t){Ae(i,e,t),w(e,n,t),Ae(o,e,t),r=!0},p:e,i(e){r||(de(i.$$.fragment,e),de(o.$$.fragment,e),r=!0)},o(e){me(i.$$.fragment,e),me(o.$$.fragment,e),r=!1},d(e){De(i,e),e&&T(n),De(o,e)}}}return new class extends _e{constructor(e){super(),ke(this,e,null,Xr,s,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
